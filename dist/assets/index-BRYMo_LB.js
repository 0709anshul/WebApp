const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-DKFWfxCa.js","assets/react-vendor-qoj9UTyu.js","assets/supabase-b4BsjvMy.js","assets/editor-DRjfniUl.js"])))=>i.map(i=>d[i]);
import{r as W,b as zh,u as Uh,L as Hh,d as Wh,R as ta,g as Vh,c as Pl,B as Gh,e as Yh,f as xr,N as $h}from"./react-vendor-qoj9UTyu.js";import{c as Jh,_ as Jl}from"./supabase-b4BsjvMy.js";import{u as qd,E as zd,S as Ud}from"./editor-DRjfniUl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Hd={exports:{}},No={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kh=W,Xh=Symbol.for("react.element"),Qh=Symbol.for("react.fragment"),Zh=Object.prototype.hasOwnProperty,ef=Kh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tf={key:!0,ref:!0,__self:!0,__source:!0};function Wd(e,t,r){var a,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)Zh.call(t,a)&&!tf.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:Xh,type:e,key:i,ref:o,props:s,_owner:ef.current}}No.Fragment=Qh;No.jsx=Wd;No.jsxs=Wd;Hd.exports=No;var n=Hd.exports,Vd,ad=zh;Vd=ad.createRoot,ad.hydrateRoot;const rf="https://qifhrpbslplnjcdqhdkf.supabase.co",nf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFpZmhycGJzbHBsbmpjZHFoZGtmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUyMDk2NDgsImV4cCI6MjA1MDc4NTY0OH0.wQMiEcxV4QV8zJKA7JD3VQOkyu5jFlG1D9LWL4q-koQ",je=Jh(rf,nf,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1,storage:localStorage,flowType:"implicit"},realtime:{params:{eventsPerSecond:10}},global:{headers:{"X-Client-Info":"leumasware"}}});let oi=null;async function af(){try{const{data:{session:e},error:t}=await je.auth.getSession();if(t)throw t;return oi=e,e}catch(e){return console.error("Failed to get session:",e),oi=null,null}}async function sf(){try{const{data:{session:e},error:t}=await je.auth.refreshSession();return t?(oi=null,sd(),null):(oi=e,e)}catch(e){return console.error("Failed to refresh session:",e),sd(),null}}function sd(){localStorage.removeItem("sb-token"),localStorage.removeItem("sb-refresh-token"),localStorage.removeItem("supabase.auth.token")}function of(e){const{data:{subscription:t}}=je.auth.onAuthStateChange((r,a)=>{oi=a,e(a)});return t}function lf(){const[e,t]=W.useState(null),[r,a]=W.useState(!0);return W.useEffect(()=>{let s=!0;async function i(){try{let c=await af();c||(c=await sf()),s&&t(c)}catch(c){console.error("Auth initialization error:",c)}finally{s&&a(!1)}}i();const o=of(c=>{s&&(t(c),a(!1))});return()=>{s=!1,o.unsubscribe()}},[]),{session:e,loading:r}}async function cf(){try{const{error:e}=await je.from("users").select("id",{head:!0});if(e)return console.warn("Health check failed:",e),!1;const{count:t,error:r}=await je.from("users").select("*",{count:"exact",head:!0});return r?(console.warn("User count check failed:",r),!1):t===0}catch(e){return console.warn("First user check failed:",e),!1}}function df(){const[e,t]=W.useState(!1),[r,a]=W.useState(!0);return W.useEffect(()=>{let s=!0;async function i(){try{const o=await cf();s&&t(o)}catch(o){console.error("First user check failed:",o),s&&t(!1)}finally{s&&a(!1)}}return i(),()=>{s=!1}},[]),{isFirstUser:e,loading:r}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var uf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),$e=(e,t)=>{const r=W.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,...h},g)=>W.createElement("svg",{ref:g,...uf,width:s,height:s,stroke:a,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${hf(e)}`,c].join(" "),...h},[...t.map(([x,y])=>W.createElement(x,y)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=$e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=$e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=$e("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=$e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=$e("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=$e("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=$e("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=$e("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=$e("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=$e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=$e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=$e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=$e("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=$e("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=$e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=$e("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=$e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=$e("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=$e("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nf=$e("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=$e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=$e("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=$e("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=$e("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=$e("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=$e("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=$e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=$e("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=$e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=$e("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=$e("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=$e("Package2",[["path",{d:"M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z",key:"1ront0"}],["path",{d:"m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9",key:"19h2x1"}],["path",{d:"M12 3v6",key:"1holv5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cf=$e("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=$e("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=$e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=$e("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=$e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=$e("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=$e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=$e("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=$e("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=$e("TestTubes",[["path",{d:"M9 2v17.5A2.5 2.5 0 0 1 6.5 22v0A2.5 2.5 0 0 1 4 19.5V2",key:"12z67u"}],["path",{d:"M20 2v17.5a2.5 2.5 0 0 1-2.5 2.5v0a2.5 2.5 0 0 1-2.5-2.5V2",key:"1q2nfy"}],["path",{d:"M3 2h7",key:"7s29d5"}],["path",{d:"M14 2h7",key:"7sicin"}],["path",{d:"M9 16H4",key:"1bfye3"}],["path",{d:"M20 16h-5",key:"ddnjpe"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=$e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=$e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=$e("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=$e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=$e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);async function Rf(e,t){const{data:r,error:a}=await je.auth.signInWithPassword({email:e,password:t});if(a)throw a.message.includes("Invalid login credentials")?new Error("invalid_credentials"):a;return r}function qf(){return n.jsx("div",{className:"fixed inset-0 z-0",style:{backgroundImage:"url(/assets/images/machine-bg.jpg)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:n.jsx("div",{className:"absolute inset-0 bg-indigo-900/90"})})}function zf(){const[e,t]=W.useState(""),[r,a]=W.useState(""),[s,i]=W.useState(null),[o,c]=W.useState(!1),d=async h=>{h.preventDefault(),i(null),c(!0);try{await Rf(e,r)}catch(g){g instanceof Error?g.message.includes("invalid_credentials")?i("Invalid email or password"):i("Failed to sign in. Please try again."):i("An unexpected error occurred")}finally{c(!1)}};return n.jsxs(n.Fragment,{children:[n.jsx(qf,{}),n.jsx("div",{className:"min-h-screen relative z-10 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8 backdrop-blur-sm bg-white/10 p-8 rounded-2xl shadow-2xl",children:[n.jsxs("div",{children:[n.jsx("div",{className:"flex justify-center",children:n.jsx(Sf,{className:"h-12 w-12 text-white"})}),n.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:"Sign in to Leumas"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[s&&n.jsx("div",{className:"rounded-md bg-red-50 p-4",children:n.jsx("div",{className:"text-sm text-red-700",children:s})}),n.jsxs("div",{className:"rounded-md -space-y-px",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:h=>t(h.target.value),className:"appearance-none rounded-t-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm bg-white/80",placeholder:"Email address",disabled:o})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),n.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:h=>a(h.target.value),className:"appearance-none rounded-b-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm bg-white/80",placeholder:"Password",disabled:o})]})]}),n.jsx("div",{children:n.jsxs("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:n.jsx(Af,{className:"h-5 w-5 text-indigo-500 group-hover:text-indigo-400"})}),o?"Signing in...":"Sign in"]})})]})]})})]})}async function Uf(e){const{count:t}=await je.from("users").select("*",{count:"exact",head:!0}),r=t===0,a=r?"admin":e.role,{data:s,error:i}=await je.auth.signUp({email:e.email,password:e.password});if(i)throw i;if(!s.user)throw new Error("Failed to create auth user");try{const{error:o}=await je.from("users").insert({id:s.user.id,email:e.email,full_name:e.full_name,role:a,organization_id:e.organization_id});if(o)throw o;return r&&await je.auth.signInWithPassword({email:e.email,password:e.password}),s.user}catch(o){try{await je.auth.admin.deleteUser(s.user.id)}catch{}throw o}}async function Hf(e){const{error:t}=await je.from("users").delete().eq("id",e);if(t)throw t}function Xd(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{create:async i=>{t(!0),a(null);try{return await Uf(i)}catch(o){throw a(o instanceof Error?o:new Error("Failed to create user")),o}finally{t(!1)}},isLoading:e,error:r}}let Ks=null;function yr(){const[e,t]=W.useState(Ks),[r,a]=W.useState(!Ks),[s,i]=W.useState(null);return W.useEffect(()=>{let o=!0;async function c(){try{if(Ks){t(Ks),a(!1);return}const{data:{user:d}}=await je.auth.getUser();if(!d){t(null);return}const{data:h,error:g}=await je.from("users").select(`
            id,
            full_name,
            role,
            organization_id,
            organization:organizations!inner(
              id,
              name
            )
          `).eq("id",d.id).single();if(g)throw g;if(!o)return;Ks=h,t(h)}catch(d){if(!o)return;i(d instanceof Error?d:new Error("Failed to fetch user"))}finally{o&&a(!1)}}return c(),()=>{o=!1}},[]),{user:e,isLoading:r,error:s}}function Aa(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),{user:o}=yr();return W.useEffect(()=>{async function c(){if(o)try{let d=je.from("organizations").select("*").order("name");o.role==="brand_user"&&(d=d.eq("id",o.organization_id));const{data:h,error:g}=await d;if(g)throw g;t(h)}catch(d){i(d instanceof Error?d:new Error("Error loading organizations"))}finally{a(!1)}}c()},[o]),{data:e,isLoading:r,error:s}}function Wf(){const{create:e,isLoading:t,error:r}=Xd(),{data:a}=Aa(),[s,i]=W.useState({email:"",password:"",full_name:"",role:"admin",organization_id:"",department:"Administration"}),o=async c=>{c.preventDefault();try{await e(s)}catch{}};return n.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[n.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx(Cf,{className:"h-12 w-12 text-indigo-600"})}),n.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Welcome to Leumasware"}),n.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Let's set up your admin account to get started"})]}),n.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:n.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[r&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:r.message}),n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),n.jsx("input",{type:"text",required:!0,value:s.full_name,onChange:c=>i({...s,full_name:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),n.jsx("input",{type:"email",required:!0,value:s.email,onChange:c=>i({...s,email:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),n.jsx("input",{type:"password",required:!0,minLength:6,value:s.password,onChange:c=>i({...s,password:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization"}),n.jsxs("select",{required:!0,value:s.organization_id,onChange:c=>i({...s,organization_id:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"Select Organization"}),a==null?void 0:a.map(c=>n.jsx("option",{value:c.id,children:c.name},c.id))]})]}),n.jsx("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:t?"Creating Account...":"Create Admin Account"})]})]})})]})}function At(){const{user:e}=yr();return W.useMemo(()=>({isAdmin:(e==null?void 0:e.role)==="admin",isManager:(e==null?void 0:e.role)==="manager",isStaff:(e==null?void 0:e.role)==="staff",isBrandUser:(e==null?void 0:e.role)==="brand_user",isLeumasStaff:["admin","manager","staff"].includes((e==null?void 0:e.role)||""),hasRole:t=>t.includes((e==null?void 0:e.role)||"")}),[e==null?void 0:e.role])}function Cl({title:e,items:t,defaultExpanded:r=!0}){const[a,s]=W.useState(r),i=Uh();return n.jsxs("div",{className:"space-y-1",children:[e&&n.jsxs("button",{onClick:()=>s(!a),className:"w-full flex items-center justify-between px-4 py-2 text-sm text-indigo-300 uppercase font-medium hover:text-indigo-200",children:[e,a?n.jsx(mi,{className:"h-4 w-4"}):n.jsx(fi,{className:"h-4 w-4"})]}),a&&n.jsx("div",{className:"space-y-1",children:t.map(o=>n.jsxs(Hh,{to:o.href,className:`flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors ${i.pathname===o.href?"bg-indigo-700":""}`,children:[n.jsx(o.icon,{className:"h-5 w-5"}),o.label]},o.label))})]})}function Vf(){return n.jsx("svg",{width:"24",height:"36",viewBox:"0 0 159.32 251.08",className:"text-white",fill:"currentColor",children:n.jsxs("g",{children:[n.jsx("path",{d:"M66.82,38.34c-1.02.43-1.76.62-2.37,1.01-14.15,9-22.68,21.8-25.48,38.31-.93,5.47-1.12,11.07-2.04,16.55-.48,2.86-1.74,5.6-2.8,8.34-4.16,10.76-8.38,21.5-12.58,32.24-.22.57-.53,1.1-1.15,2.35-1.46-4.89-2.77-9.12-3.99-13.37-4.28-14.92-6.87-30.12-6.8-45.66.07-14.81,2.53-29.17,9.94-42.3,4.32-7.66,10.09-14.03,16.99-19.5,6.01-4.76,12.01-9.45,19.15-12.45,7.88-3.31,16.01-4.93,24.48-3.11,10.51,2.25,19.8,10.49,21.51,24.12,1.22,9.72-.55,18.88-3.83,27.86-8.63,23.62-18.48,46.74-29.43,69.38-10.52,21.75-21.23,43.42-31.48,65.29-4.51,9.63-8.13,19.68-12.06,29.57-1.23,3.08-1.53,6.32-.83,9.62.72,3.38,2.79,4.5,5.72,2.71,3.67-2.23,7.15-4.77,10.71-7.17,4.35-2.93,8.71-5.86,13.29-8.93,5.61,5.09,11.19,10.14,17.23,15.62-8.66,4.34-16.85,8.53-25.13,12.55-7.73,3.76-15.66,7.01-24.1,8.91-12.04,2.71-22.46-5.11-21.75-17.48.49-8.4,2.42-16.8,4.5-25,4.62-18.23,12.11-35.44,19.51-52.68,5.11-11.92,9.98-23.94,14.94-35.92,3.65-8.8,7.63-17.48,10.82-26.45,4.84-13.61,9.17-27.41,13.62-41.15,1.22-3.77,2.13-7.65,3.16-11.48.11-.43.12-.88.23-1.8Z"}),n.jsx("path",{d:"M131.31,196.11c-1.12.55-1.98.92-2.79,1.36-5.99,3.3-11.98,6.6-17.94,9.96-1.4.79-2.49.76-3.91-.13-7.05-4.37-13.94-8.93-20.02-15.16.77-.67,1.44-1.41,2.26-1.94,13.95-9.06,27.91-18.08,41.86-27.13,3.63-2.36,7.36-2.3,11.11-.48,7.27,3.52,10.7,9.73,11.74,17.43,1.49,11.03,2.93,22.07,4.25,33.13.52,4.34.71,8.73.93,13.1.25,4.84.46,9.68.51,14.53.07,6.13-3.9,10.48-10.02,10.29-4.88-.15-9.81-.93-14.59-2.02-8.12-1.84-16.32-3.62-24.13-6.41-6.38-2.28-12.41-5.72-18.3-9.15-13.67-7.98-26.51-17.13-37-29.13-3.22-3.68-5.68-8.03-8.33-12.18-.51-.81-.75-2.29-.36-3.1,3.45-7.06,7.08-14.04,10.79-21.31.6.87,1.05,1.49,1.46,2.14,8.29,12.93,17.49,25.22,29.73,34.62,6.88,5.28,14.68,9.51,22.44,13.48,6.25,3.2,13.1,5.22,19.62,7.93,2.11.87,2.9.08,2.96-1.78.07-2.13-.09-4.28-.28-6.41-.63-7.11-1.31-14.22-2-21.65Z"})]})})}function Gf(){return n.jsx("div",{className:"flex-shrink-0 p-4 border-b border-indigo-700",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Vf,{}),n.jsxs("div",{className:"flex flex-col justify-center",children:[n.jsx("h1",{className:"text-xl font-bold leading-none",children:"Leumasware®"}),n.jsx("p",{className:"text-xs text-indigo-200 leading-none",children:"ISO 9001:2015 Company"})]})]})})}function Yf({isOpen:e,onClose:t}){const[r,a]=W.useState(""),[s,i]=W.useState(""),[o,c]=W.useState(!1),[d,h]=W.useState(null),[g,x]=W.useState(!1),y=async m=>{if(m.preventDefault(),r!==s){h("Passwords do not match");return}c(!0),h(null);try{const{error:v}=await je.auth.updateUser({password:r});if(v)throw v;x(!0),setTimeout(()=>{t(),x(!1),a(""),i("")},2e3)}catch(v){h(v instanceof Error?v.message:"Failed to update password")}finally{c(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full text-gray-900",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Change Password"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),d&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:d}),g&&n.jsx("div",{className:"mb-4 p-2 bg-green-100 text-green-700 rounded",children:"Password updated successfully!"}),n.jsxs("form",{onSubmit:y,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),n.jsx("input",{type:"password",required:!0,minLength:6,value:r,onChange:m=>a(m.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:o})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),n.jsx("input",{type:"password",required:!0,minLength:6,value:s,onChange:m=>i(m.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:o})]}),n.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:o?"Updating...":"Update Password"})]})]})}):null}const $f=[{icon:_f,label:"Dashboard",href:"/"},{icon:So,label:"Production Orders",href:"/orders"},{icon:kf,label:"Production Tasks",href:"/tasks"},{icon:rr,label:"Products",href:"/products"},{icon:Nf,label:"Service Requests",href:"/tickets"}],Jf=[{icon:pf,label:"Inventory Dashboard",href:"/inventory"},{icon:rr,label:"Materials",href:"/inventory/materials"},{icon:Of,label:"Product Formulas",href:"/inventory/formulas"},{icon:Lo,label:"Material Orders",href:"/inventory/orders"},{icon:jo,label:"Movements",href:"/inventory/movements"},{icon:gf,label:"Live Inventory",href:"/inventory/live"}],Kf=[{icon:Bf,label:"Users",href:"/users"},{icon:hi,label:"Customer Brands",href:"/customer-brands"},{icon:Yd,label:"Task Templates",href:"/task-templates"}];function Xf(){const{isAdmin:e,isManager:t}=At(),r=e||t,[a,s]=W.useState(!1);return n.jsxs("div",{className:"w-64 bg-indigo-800 text-white flex flex-col h-screen",children:[n.jsx(Gf,{}),n.jsxs("div",{className:"flex-1 overflow-y-auto py-4 space-y-6",children:[n.jsx(Cl,{items:$f}),n.jsx(Cl,{title:"Inventory",items:Jf}),r&&n.jsx(Cl,{title:"Admin",items:Kf,defaultExpanded:!1})]}),n.jsx("div",{className:"flex-shrink-0 p-4 border-t border-indigo-700",children:n.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-2 px-4 py-2 w-full rounded-lg hover:bg-indigo-700 transition-colors",children:[n.jsx(Lf,{className:"h-5 w-5"}),"Change Password"]})}),n.jsx(Yf,{isOpen:a,onClose:()=>s(!1)})]})}async function Qf(){try{localStorage.removeItem("sb-token"),localStorage.removeItem("sb-refresh-token"),localStorage.removeItem("supabase.auth.token");const{error:e}=await je.auth.signOut();if(e)throw e}catch(e){throw console.error("Sign out error:",e),e}}function Zf(){const[e,t]=W.useState(!1),r=Wh();return{signOut:async()=>{if(!e){t(!0);try{await Qf(),r("/")}catch(s){console.error("Sign out failed:",s),r("/")}finally{t(!1)}}},isLoading:e}}function e0(){const{signOut:e,isLoading:t}=Zf();return n.jsxs("button",{onClick:e,disabled:t,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:[n.jsx(Pf,{className:"h-5 w-5"}),n.jsx("span",{children:t?"Signing out...":"Sign out"})]})}function kr({children:e}){return n.jsxs("div",{className:"flex h-screen bg-gray-100",children:[n.jsx(Xf,{}),n.jsxs("div",{className:"flex-1 flex flex-col",children:[n.jsx("header",{className:"bg-white shadow-sm",children:n.jsx("div",{className:"flex justify-end items-center px-6 py-3",children:n.jsx(e0,{})})}),n.jsx("main",{className:"flex-1 overflow-auto bg-gray-50",children:n.jsx("div",{className:"p-6",children:e})})]})]})}function _r(e){if(!e)return"Not set";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return console.error("Error formatting date:",t),"Invalid date"}}function t0(){const[e,t]=W.useState(!1),[r,a]=W.useState(null),{isAdmin:s,isManager:i}=At();return{togglePriority:async(c,d)=>{if(!s&&!i){const h=new Error("Insufficient permissions");throw a(h),h}t(!0),a(null);try{const{error:h}=await je.from("production_orders").update({is_priority:!d}).eq("id",c);if(h)throw h}catch(h){const g=h instanceof Error?h:new Error("Failed to update priority");throw a(g),g}finally{t(!1)}},isLoading:e,error:r,canToggle:s||i}}function r0({orderId:e,isPriority:t}){const{togglePriority:r,isLoading:a,canToggle:s}=t0(),[i,o]=W.useState(t),c=async()=>{if(!s||a)return;o(!i);try{await r(e,t)}catch(h){o(t),console.error("Error toggling priority:",h)}};return ta.useEffect(()=>{o(t)},[t]),n.jsxs("button",{onClick:c,disabled:!s||a,className:`
        inline-flex items-center gap-2 px-3 py-1 rounded-full transition-colors
        ${s?"cursor-pointer":"cursor-not-allowed opacity-50"}
        ${i?"bg-indigo-100 text-indigo-700 hover:bg-indigo-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
        ${a?"animate-pulse":""}
      `,title:s?void 0:"Only admins and managers can change priority",children:[n.jsxs("span",{className:"relative flex h-2 w-2",children:[n.jsx("span",{className:`
          animate-ping absolute inline-flex h-full w-full rounded-full opacity-75
          ${i?"bg-indigo-500":"bg-gray-500"}
        `}),n.jsx("span",{className:`
          relative inline-flex rounded-full h-2 w-2
          ${i?"bg-indigo-500":"bg-gray-500"}
        `})]}),n.jsx("span",{className:"text-sm font-medium",children:a?"Updating...":i?"Priority":"Normal"})]})}const n0={pending:0,pending_from_client:20,in_progress:60,completed:100};function Qd(e){return n0[e]||0}function Ao(e){if(!(e!=null&&e.length))return 0;const t=e.reduce((r,a)=>r+Qd(a.status),0);return Math.round(t/e.length)}function Kl({status:e,progress:t}){const r=t??(e?Qd(e):0);return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-32 h-2 bg-gray-100 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${r}%`}})}),n.jsxs("span",{className:"text-sm text-gray-500",children:[r,"%"]})]})}function a0({tasks:e}){const[t,r]=W.useState(!1),a=Ao(e);return n.jsxs("div",{className:"mt-4",children:[n.jsxs("button",{onClick:()=>r(!t),className:"w-full flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("span",{className:"text-sm font-medium",children:["Tasks (",e.length,")"]}),n.jsx(Kl,{progress:a})]}),t?n.jsx(mi,{className:"h-5 w-5 text-gray-400"}):n.jsx(fi,{className:"h-5 w-5 text-gray-400"})]}),t&&n.jsx("div",{className:"mt-2 space-y-2",children:e.map(s=>{var i;return n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:s.details}),n.jsxs("div",{className:"mt-1 space-y-1 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ra,{className:"h-4 w-4"}),n.jsx("span",{children:((i=s.owner)==null?void 0:i.full_name)||"Unassigned"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),n.jsxs("span",{children:["Due: ",_r(s.due_date)]})]})]})]}),n.jsx(Kl,{status:s.status})]},s.id)})})]})}function Zd({content:e,onChange:t,disabled:r}){const a=qd({extensions:[Ud],content:e,editable:!r,onUpdate:({editor:s})=>{t(s.getHTML())},editorProps:{attributes:{class:"prose max-w-none min-h-[200px] focus:outline-none p-4"}}});return W.useEffect(()=>{a&&e!==a.getHTML()&&a.commands.setContent(e)},[e,a]),W.useEffect(()=>{a&&a.setEditable(!r)},[r,a]),a?n.jsxs("div",{className:"border rounded-md overflow-hidden bg-white",children:[n.jsxs("div",{className:"bg-gray-50 border-b p-2 flex gap-2",children:[n.jsx("button",{type:"button",onClick:()=>a.chain().focus().toggleBold().run(),disabled:r||!a.can().chain().focus().toggleBold().run(),className:`p-2 rounded transition-colors ${a.isActive("bold")?"bg-gray-200":"hover:bg-gray-100"} ${r?"opacity-50 cursor-not-allowed":""}`,children:n.jsx(Gd,{className:"h-5 w-5"})}),n.jsx("button",{type:"button",onClick:()=>a.chain().focus().toggleItalic().run(),disabled:r||!a.can().chain().focus().toggleItalic().run(),className:`p-2 rounded transition-colors ${a.isActive("italic")?"bg-gray-200":"hover:bg-gray-100"} ${r?"opacity-50 cursor-not-allowed":""}`,children:n.jsx($d,{className:"h-5 w-5"})}),n.jsx("button",{type:"button",onClick:()=>a.chain().focus().toggleBulletList().run(),disabled:r||!a.can().chain().focus().toggleBulletList().run(),className:`p-2 rounded transition-colors ${a.isActive("bulletList")?"bg-gray-200":"hover:bg-gray-100"} ${r?"opacity-50 cursor-not-allowed":""}`,children:n.jsx(Jd,{className:"h-5 w-5"})})]}),n.jsx(zd,{editor:a})]}):null}function s0(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{updateOrder:async(i,o)=>{var c;if(!i)throw new Error("Order ID is required");t(!0),a(null);try{const{error:d}=await je.from("production_orders").update({details:((c=o.details)==null?void 0:c.trim())||null,attachments:o.attachments||[]}).eq("id",i).select().single();if(d)throw d}catch(d){const h=d instanceof Error?d:new Error("Failed to update order");throw a(h),h}finally{t(!1)}},isLoading:e,error:r}}const id={"image/jpeg":"jpg","image/png":"png","image/gif":"gif","application/pdf":"pdf","video/mp4":"mp4","video/quicktime":"mov"};async function i0(e,t="task-attachments"){if(!id[e.type])throw new Error("File type not supported");const r=id[e.type],a=`${Math.random().toString(36).slice(2)}_${Date.now()}.${r}`,{error:s,data:i}=await je.storage.from(t).upload(a,e);if(s)throw s;const{data:{publicUrl:o}}=je.storage.from(t).getPublicUrl(a);return{path:o,name:e.name,type:e.type,size:e.size}}async function o0(e,t="task-attachments"){const r=e.split("/").pop();if(!r)throw new Error("Invalid file path");const{error:a}=await je.storage.from(t).remove([r]);if(a)throw a}function Po({files:e,onChange:t,disabled:r}){const a=async i=>{const o=i.target.files;if(o!=null&&o.length)try{const c=await Promise.all(Array.from(o).map(d=>i0(d)));t([...e,...c])}catch(c){console.error("Error uploading files:",c)}},s=async i=>{try{await o0(e[i].path),t(e.filter((o,c)=>c!==i))}catch(o){console.error("Error removing file:",o)}};return n.jsxs("div",{className:"space-y-4",children:[e.length>0&&n.jsx("div",{className:"space-y-2",children:e.map((i,o)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("a",{href:i.path,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:text-indigo-800",children:i.name}),n.jsxs("span",{className:"text-xs text-gray-500",children:["(",Math.round(i.size/1024),"KB)"]})]}),n.jsx("button",{type:"button",onClick:()=>s(o),disabled:r,className:"text-red-600 hover:text-red-800 disabled:opacity-50",children:n.jsx(ys,{className:"h-4 w-4"})})]},i.path))}),n.jsxs("label",{className:"block",children:[n.jsx("span",{className:"sr-only",children:"Choose files"}),n.jsx("div",{className:"flex items-center justify-center px-4 py-3 border-2 border-gray-300 border-dashed rounded-md hover:border-indigo-500 cursor-pointer",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx("input",{type:"file",multiple:!0,onChange:a,disabled:r,accept:".jpg,.jpeg,.png,.gif,.pdf,.mp4,.mov",className:"sr-only"}),n.jsx(Ef,{className:"h-4 w-4 text-gray-400"}),n.jsx("span",{children:"Attach files"})]})}),n.jsx("p",{className:"mt-1 text-xs text-gray-500 text-center",children:"Images, PDFs, and videos up to 50MB"})]})]})}function l0({order:e,isOpen:t,onClose:r,onUpdate:a}){const[s,i]=W.useState(e.details||""),[o,c]=W.useState(e.attachments||[]),{updateOrder:d,isLoading:h,error:g}=s0(),x=async y=>{y.preventDefault();try{await d(e.id,{details:s,attachments:o}),a==null||a(),r()}catch{}};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Order Details"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),g&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:g.message}),n.jsxs("form",{onSubmit:x,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Details"}),n.jsx(Zd,{content:s,onChange:i,disabled:h})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),n.jsx(Po,{files:o,onChange:c,disabled:h})]}),n.jsxs("div",{className:"flex justify-end gap-4",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:h?"Saving...":"Save Changes"})]})]})]})}):null}function vt(e){"@babel/helpers - typeof";return vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(e)}var fr=Uint8Array,Ir=Uint16Array,pc=Int32Array,Co=new fr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Eo=new fr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xl=new fr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eu=function(e,t){for(var r=new Ir(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var s=new pc(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)s[i]=i-r[a]<<5|a;return{b:r,r:s}},tu=eu(Co,2),ru=tu.b,Ql=tu.r;ru[28]=258,Ql[258]=28;var nu=eu(Eo,0),c0=nu.b,od=nu.r,Zl=new Ir(32768);for(var Pt=0;Pt<32768;++Pt){var $n=(Pt&43690)>>1|(Pt&21845)<<1;$n=($n&52428)>>2|($n&13107)<<2,$n=($n&61680)>>4|($n&3855)<<4,Zl[Pt]=(($n&65280)>>8|($n&255)<<8)>>1}var vn=function(e,t,r){for(var a=e.length,s=0,i=new Ir(t);s<a;++s)e[s]&&++i[e[s]-1];var o=new Ir(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;var c;if(r){c=new Ir(1<<t);var d=15-t;for(s=0;s<a;++s)if(e[s])for(var h=s<<4|e[s],g=t-e[s],x=o[e[s]-1]++<<g,y=x|(1<<g)-1;x<=y;++x)c[Zl[x]>>d]=h}else for(c=new Ir(a),s=0;s<a;++s)e[s]&&(c[s]=Zl[o[e[s]-1]++]>>15-e[s]);return c},na=new fr(288);for(var Pt=0;Pt<144;++Pt)na[Pt]=8;for(var Pt=144;Pt<256;++Pt)na[Pt]=9;for(var Pt=256;Pt<280;++Pt)na[Pt]=7;for(var Pt=280;Pt<288;++Pt)na[Pt]=8;var li=new fr(32);for(var Pt=0;Pt<32;++Pt)li[Pt]=5;var d0=vn(na,9,0),u0=vn(na,9,1),h0=vn(li,5,0),f0=vn(li,5,1),El=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},en=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&r},Fl=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},xc=function(e){return(e+7)/8|0},au=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new fr(e.subarray(t,r))},m0=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rn=function(e,t,r){var a=new Error(t||m0[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,rn),!r)throw a;return a},g0=function(e,t,r,a){var s=e.length,i=0;if(!s||t.f&&!t.l)return r||new fr(0);var o=!r,c=o||t.i!=2,d=t.i;o&&(r=new fr(s*3));var h=function(_e){var Ce=r.length;if(_e>Ce){var Ee=new fr(Math.max(Ce*2,_e));Ee.set(r),r=Ee}},g=t.f||0,x=t.p||0,y=t.b||0,m=t.l,v=t.d,N=t.m,L=t.n,w=s*8;do{if(!m){g=en(e,x,1);var j=en(e,x+1,3);if(x+=3,j)if(j==1)m=u0,v=f0,N=9,L=5;else if(j==2){var K=en(e,x,31)+257,O=en(e,x+10,15)+4,M=K+en(e,x+5,31)+1;x+=14;for(var G=new fr(M),J=new fr(19),A=0;A<O;++A)J[Xl[A]]=en(e,x+A*3,7);x+=O*3;for(var _=El(J),q=(1<<_)-1,H=vn(J,_,1),A=0;A<M;){var le=H[en(e,x,q)];x+=le&15;var S=le>>4;if(S<16)G[A++]=S;else{var Y=0,V=0;for(S==16?(V=3+en(e,x,3),x+=2,Y=G[A-1]):S==17?(V=3+en(e,x,7),x+=3):S==18&&(V=11+en(e,x,127),x+=7);V--;)G[A++]=Y}}var Z=G.subarray(0,K),Q=G.subarray(K);N=El(Z),L=El(Q),m=vn(Z,N,1),v=vn(Q,L,1)}else rn(1);else{var S=xc(x)+4,I=e[S-4]|e[S-3]<<8,R=S+I;if(R>s){d&&rn(0);break}c&&h(y+I),r.set(e.subarray(S,R),y),t.b=y+=I,t.p=x=R*8,t.f=g;continue}if(x>w){d&&rn(0);break}}c&&h(y+131072);for(var ie=(1<<N)-1,ge=(1<<L)-1,k=x;;k=x){var Y=m[Fl(e,x)&ie],B=Y>>4;if(x+=Y&15,x>w){d&&rn(0);break}if(Y||rn(2),B<256)r[y++]=B;else if(B==256){k=x,m=null;break}else{var U=B-254;if(B>264){var A=B-257,X=Co[A];U=en(e,x,(1<<X)-1)+ru[A],x+=X}var ee=v[Fl(e,x)&ge],de=ee>>4;ee||rn(3),x+=ee&15;var Q=c0[de];if(de>3){var X=Eo[de];Q+=Fl(e,x)&(1<<X)-1,x+=X}if(x>w){d&&rn(0);break}c&&h(y+131072);var ue=y+U;if(y<Q){var me=i-Q,ke=Math.min(Q,ue);for(me+y<0&&rn(3);y<ke;++y)r[y]=a[me+y]}for(;y<ue;++y)r[y]=r[y-Q]}}t.l=m,t.p=k,t.b=y,t.f=g,m&&(g=1,t.m=N,t.d=v,t.n=L)}while(!g);return y!=r.length&&o?au(r,0,y):r.subarray(0,y)},In=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Xs=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Il=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var s=r.length,i=r.slice();if(!s)return{t:iu,l:0};if(s==1){var o=new fr(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(R,K){return R.f-K.f}),r.push({s:-1,f:25001});var c=r[0],d=r[1],h=0,g=1,x=2;for(r[0]={s:-1,f:c.f+d.f,l:c,r:d};g!=s-1;)c=r[r[h].f<r[x].f?h++:x++],d=r[h!=g&&r[h].f<r[x].f?h++:x++],r[g++]={s:-1,f:c.f+d.f,l:c,r:d};for(var y=i[0].s,a=1;a<s;++a)i[a].s>y&&(y=i[a].s);var m=new Ir(y+1),v=ec(r[g-1],m,0);if(v>t){var a=0,N=0,L=v-t,w=1<<L;for(i.sort(function(K,O){return m[O.s]-m[K.s]||K.f-O.f});a<s;++a){var j=i[a].s;if(m[j]>t)N+=w-(1<<v-m[j]),m[j]=t;else break}for(N>>=L;N>0;){var S=i[a].s;m[S]<t?N-=1<<t-m[S]++-1:++a}for(;a>=0&&N;--a){var I=i[a].s;m[I]==t&&(--m[I],++N)}v=t}return{t:new fr(m),l:v}},ec=function(e,t,r){return e.s==-1?Math.max(ec(e.l,t,r+1),ec(e.r,t,r+1)):t[e.s]=r},ld=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ir(++t),a=0,s=e[0],i=1,o=function(d){r[a++]=d},c=1;c<=t;++c)if(e[c]==s&&c!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=e[c]}return{c:r.subarray(0,a),n:t}},Qs=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},su=function(e,t,r){var a=r.length,s=xc(t+2);e[s]=a&255,e[s+1]=a>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<a;++i)e[s+i+4]=r[i];return(s+4+a)*8},cd=function(e,t,r,a,s,i,o,c,d,h,g){In(t,g++,r),++s[256];for(var x=Il(s,15),y=x.t,m=x.l,v=Il(i,15),N=v.t,L=v.l,w=ld(y),j=w.c,S=w.n,I=ld(N),R=I.c,K=I.n,O=new Ir(19),M=0;M<j.length;++M)++O[j[M]&31];for(var M=0;M<R.length;++M)++O[R[M]&31];for(var G=Il(O,7),J=G.t,A=G.l,_=19;_>4&&!J[Xl[_-1]];--_);var q=h+5<<3,H=Qs(s,na)+Qs(i,li)+o,le=Qs(s,y)+Qs(i,N)+o+14+3*_+Qs(O,J)+2*O[16]+3*O[17]+7*O[18];if(d>=0&&q<=H&&q<=le)return su(t,g,e.subarray(d,d+h));var Y,V,Z,Q;if(In(t,g,1+(le<H)),g+=2,le<H){Y=vn(y,m,0),V=y,Z=vn(N,L,0),Q=N;var ie=vn(J,A,0);In(t,g,S-257),In(t,g+5,K-1),In(t,g+10,_-4),g+=14;for(var M=0;M<_;++M)In(t,g+3*M,J[Xl[M]]);g+=3*_;for(var ge=[j,R],k=0;k<2;++k)for(var B=ge[k],M=0;M<B.length;++M){var U=B[M]&31;In(t,g,ie[U]),g+=J[U],U>15&&(In(t,g,B[M]>>5&127),g+=B[M]>>12)}}else Y=d0,V=na,Z=h0,Q=li;for(var M=0;M<c;++M){var X=a[M];if(X>255){var U=X>>18&31;Xs(t,g,Y[U+257]),g+=V[U+257],U>7&&(In(t,g,X>>23&31),g+=Co[U]);var ee=X&31;Xs(t,g,Z[ee]),g+=Q[ee],ee>3&&(Xs(t,g,X>>5&8191),g+=Eo[ee])}else Xs(t,g,Y[X]),g+=V[X]}return Xs(t,g,Y[256]),g+V[256]},p0=new pc([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),iu=new fr(0),x0=function(e,t,r,a,s,i){var o=i.z||e.length,c=new fr(a+o+5*(1+Math.ceil(o/7e3))+s),d=c.subarray(a,c.length-s),h=i.l,g=(i.r||0)&7;if(t){g&&(d[0]=i.r>>3);for(var x=p0[t-1],y=x>>13,m=x&8191,v=(1<<r)-1,N=i.p||new Ir(32768),L=i.h||new Ir(v+1),w=Math.ceil(r/3),j=2*w,S=function(Ve){return(e[Ve]^e[Ve+1]<<w^e[Ve+2]<<j)&v},I=new pc(25e3),R=new Ir(288),K=new Ir(32),O=0,M=0,G=i.i||0,J=0,A=i.w||0,_=0;G+2<o;++G){var q=S(G),H=G&32767,le=L[q];if(N[H]=le,L[q]=H,A<=G){var Y=o-G;if((O>7e3||J>24576)&&(Y>423||!h)){g=cd(e,d,0,I,R,K,M,J,_,G-_,g),J=O=M=0,_=G;for(var V=0;V<286;++V)R[V]=0;for(var V=0;V<30;++V)K[V]=0}var Z=2,Q=0,ie=m,ge=H-le&32767;if(Y>2&&q==S(G-ge))for(var k=Math.min(y,Y)-1,B=Math.min(32767,G),U=Math.min(258,Y);ge<=B&&--ie&&H!=le;){if(e[G+Z]==e[G+Z-ge]){for(var X=0;X<U&&e[G+X]==e[G+X-ge];++X);if(X>Z){if(Z=X,Q=ge,X>k)break;for(var ee=Math.min(ge,X-2),de=0,V=0;V<ee;++V){var ue=G-ge+V&32767,me=N[ue],ke=ue-me&32767;ke>de&&(de=ke,le=ue)}}}H=le,le=N[H],ge+=H-le&32767}if(Q){I[J++]=268435456|Ql[Z]<<18|od[Q];var _e=Ql[Z]&31,Ce=od[Q]&31;M+=Co[_e]+Eo[Ce],++R[257+_e],++K[Ce],A=G+Z,++O}else I[J++]=e[G],++R[e[G]]}}for(G=Math.max(G,A);G<o;++G)I[J++]=e[G],++R[e[G]];g=cd(e,d,h,I,R,K,M,J,_,G-_,g),h||(i.r=g&7|d[g/8|0]<<3,g-=7,i.h=L,i.p=N,i.i=G,i.w=A)}else{for(var G=i.w||0;G<o+h;G+=65535){var Ee=G+65535;Ee>=o&&(d[g/8|0]=h,Ee=o),g=su(d,g+1,e.subarray(G,Ee))}i.i=o}return au(c,0,a+xc(g)+s)},ou=function(){var e=1,t=0;return{p:function(r){for(var a=e,s=t,i=r.length|0,o=0;o!=i;){for(var c=Math.min(o+2655,i);o<c;++o)s+=a+=r[o];a=(a&65535)+15*(a>>16),s=(s&65535)+15*(s>>16)}e=a,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},y0=function(e,t,r,a,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new fr(i.length+e.length);o.set(i),o.set(e,i.length),e=o,s.w=i.length}return x0(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,s)},lu=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},v0=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=ou();s.p(t.dictionary),lu(e,2,s.d())}},b0=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&rn(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&rn(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function tc(e,t){t||(t={});var r=ou();r.p(e);var a=y0(e,t,t.dictionary?6:2,4);return v0(a,t),lu(a,a.length-4,r.d()),a}function w0(e,t){return g0(e.subarray(b0(e,t),-4),{i:2},t,t)}var N0=typeof TextDecoder<"u"&&new TextDecoder,j0=0;try{N0.decode(iu,{stream:!0}),j0=1}catch{}var Ge=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Ml(){Ge.console&&typeof Ge.console.log=="function"&&Ge.console.log.apply(Ge.console,arguments)}var _t={log:Ml,warn:function(e){Ge.console&&(typeof Ge.console.warn=="function"?Ge.console.warn.apply(Ge.console,arguments):Ml.call(null,arguments))},error:function(e){Ge.console&&(typeof Ge.console.error=="function"?Ge.console.error.apply(Ge.console,arguments):Ml(e))}};function Tl(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){va(a.response,t,r)},a.onerror=function(){_t.error("could not download file")},a.send()}function dd(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function oo(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var ti,rc,va=Ge.saveAs||((typeof window>"u"?"undefined":vt(window))!=="object"||window!==Ge?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Ge.URL||Ge.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?dd(s.href)?Tl(e,t,r):oo(s,s.target="_blank"):oo(s)):(s.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(s.href)},4e4),setTimeout(function(){oo(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(dd(e))Tl(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){oo(a)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:vt(i)!=="object"&&(_t.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return Tl(e,t,r);var s=e.type==="application/octet-stream",i=/constructor/i.test(Ge.HTMLElement)||Ge.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":vt(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var g=c.result;g=o?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=g:location=g,a=null},c.readAsDataURL(e)}else{var d=Ge.URL||Ge.webkitURL,h=d.createObjectURL(e);a?a.location=h:location.href=h,a=null,setTimeout(function(){d.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function cu(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var s=r[a].re,i=r[a].process,o=s.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),d=this.g.toString(16),h=this.b.toString(16);return c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),h.length==1&&(h="0"+h),"#"+c+d+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Ol(e,t){var r=e[0],a=e[1],s=e[2],i=e[3];r=cr(r,a,s,i,t[0],7,-680876936),i=cr(i,r,a,s,t[1],12,-389564586),s=cr(s,i,r,a,t[2],17,606105819),a=cr(a,s,i,r,t[3],22,-1044525330),r=cr(r,a,s,i,t[4],7,-176418897),i=cr(i,r,a,s,t[5],12,1200080426),s=cr(s,i,r,a,t[6],17,-1473231341),a=cr(a,s,i,r,t[7],22,-45705983),r=cr(r,a,s,i,t[8],7,1770035416),i=cr(i,r,a,s,t[9],12,-1958414417),s=cr(s,i,r,a,t[10],17,-42063),a=cr(a,s,i,r,t[11],22,-1990404162),r=cr(r,a,s,i,t[12],7,1804603682),i=cr(i,r,a,s,t[13],12,-40341101),s=cr(s,i,r,a,t[14],17,-1502002290),r=dr(r,a=cr(a,s,i,r,t[15],22,1236535329),s,i,t[1],5,-165796510),i=dr(i,r,a,s,t[6],9,-1069501632),s=dr(s,i,r,a,t[11],14,643717713),a=dr(a,s,i,r,t[0],20,-373897302),r=dr(r,a,s,i,t[5],5,-701558691),i=dr(i,r,a,s,t[10],9,38016083),s=dr(s,i,r,a,t[15],14,-660478335),a=dr(a,s,i,r,t[4],20,-405537848),r=dr(r,a,s,i,t[9],5,568446438),i=dr(i,r,a,s,t[14],9,-1019803690),s=dr(s,i,r,a,t[3],14,-187363961),a=dr(a,s,i,r,t[8],20,1163531501),r=dr(r,a,s,i,t[13],5,-1444681467),i=dr(i,r,a,s,t[2],9,-51403784),s=dr(s,i,r,a,t[7],14,1735328473),r=ur(r,a=dr(a,s,i,r,t[12],20,-1926607734),s,i,t[5],4,-378558),i=ur(i,r,a,s,t[8],11,-2022574463),s=ur(s,i,r,a,t[11],16,1839030562),a=ur(a,s,i,r,t[14],23,-35309556),r=ur(r,a,s,i,t[1],4,-1530992060),i=ur(i,r,a,s,t[4],11,1272893353),s=ur(s,i,r,a,t[7],16,-155497632),a=ur(a,s,i,r,t[10],23,-1094730640),r=ur(r,a,s,i,t[13],4,681279174),i=ur(i,r,a,s,t[0],11,-358537222),s=ur(s,i,r,a,t[3],16,-722521979),a=ur(a,s,i,r,t[6],23,76029189),r=ur(r,a,s,i,t[9],4,-640364487),i=ur(i,r,a,s,t[12],11,-421815835),s=ur(s,i,r,a,t[15],16,530742520),r=hr(r,a=ur(a,s,i,r,t[2],23,-995338651),s,i,t[0],6,-198630844),i=hr(i,r,a,s,t[7],10,1126891415),s=hr(s,i,r,a,t[14],15,-1416354905),a=hr(a,s,i,r,t[5],21,-57434055),r=hr(r,a,s,i,t[12],6,1700485571),i=hr(i,r,a,s,t[3],10,-1894986606),s=hr(s,i,r,a,t[10],15,-1051523),a=hr(a,s,i,r,t[1],21,-2054922799),r=hr(r,a,s,i,t[8],6,1873313359),i=hr(i,r,a,s,t[15],10,-30611744),s=hr(s,i,r,a,t[6],15,-1560198380),a=hr(a,s,i,r,t[13],21,1309151649),r=hr(r,a,s,i,t[4],6,-145523070),i=hr(i,r,a,s,t[11],10,-1120210379),s=hr(s,i,r,a,t[2],15,718787259),a=hr(a,s,i,r,t[9],21,-343485551),e[0]=Qn(r,e[0]),e[1]=Qn(a,e[1]),e[2]=Qn(s,e[2]),e[3]=Qn(i,e[3])}function Fo(e,t,r,a,s,i){return t=Qn(Qn(t,e),Qn(a,i)),Qn(t<<s|t>>>32-s,r)}function cr(e,t,r,a,s,i,o){return Fo(t&r|~t&a,e,t,s,i,o)}function dr(e,t,r,a,s,i,o){return Fo(t&a|r&~a,e,t,s,i,o)}function ur(e,t,r,a,s,i,o){return Fo(t^r^a,e,t,s,i,o)}function hr(e,t,r,a,s,i,o){return Fo(r^(t|~a),e,t,s,i,o)}function du(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Ol(a,S0(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Ol(a,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Ol(a,s),a}function S0(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}ti=Ge.atob.bind(Ge),rc=Ge.btoa.bind(Ge);var ud="0123456789abcdef".split("");function _0(e){for(var t="",r=0;r<4;r++)t+=ud[e>>8*r+4&15]+ud[e>>8*r&15];return t}function k0(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function nc(e){return du(e).map(k0).join("")}var L0=function(e){for(var t=0;t<e.length;t++)e[t]=_0(e[t]);return e.join("")}(du("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qn(e,t){if(L0){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function ac(e,t){var r,a,s,i;if(e!==r){for(var o=(s=e,i=1+(256/e.length>>0),new Array(i+1).join(s)),c=[],d=0;d<256;d++)c[d]=d;var h=0;for(d=0;d<256;d++){var g=c[d];h=(h+g+o.charCodeAt(d))%256,c[d]=c[h],c[h]=g}r=e,a=c}else c=a;var x=t.length,y=0,m=0,v="";for(d=0;d<x;d++)m=(m+(g=c[y=(y+1)%256]))%256,c[y]=c[m],c[m]=g,o=c[(c[y]+c[m])%256],v+=String.fromCharCode(t.charCodeAt(d)^o);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var hd={print:4,modify:8,copy:16,"annot-forms":32};function ds(e,t,r,a){this.v=1,this.r=2;var s=192;e.forEach(function(c){if(hd.perm!==void 0)throw new Error("Invalid permission: "+c);s+=hd[c]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=nc(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=ac(this.encryptionKey,this.padding)}function us(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var s=e.charCodeAt(a);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?t+="#"+("0"+s.toString(16)).slice(-2):t+=e[a]}return t}function fd(e){if(vt(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,s){if(s=s||!1,typeof r!="string"||typeof a!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[a,!!s],i},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,a)}catch(c){Ge.console&&_t.error("jsPDF PubSub Error",c.message,c)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function ci(e){if(!(this instanceof ci))return new ci(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function uu(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Xn(e,t,r,a,s){if(!(this instanceof Xn))return new Xn(e,t,r,a,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,uu.call(this,a,s)}function wa(e,t,r,a,s){if(!(this instanceof wa))return new wa(e,t,r,a,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,uu.call(this,a,s)}function Ue(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],s=arguments[2],i=arguments[3],o=[],c=1,d=16,h="S",g=null;vt(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,s=e.format||s,i=e.compress||e.compressPdf||i,(g=e.encryption||null)!==null&&(g.userPassword=g.userPassword||"",g.ownerPassword=g.ownerPassword||"",g.userPermissions=g.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(d=e.floatPrecision),h=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var x=e.putOnlyUsedFonts||!1,y={},m={internal:{},__private__:{}};m.__private__.PubSub=fd;var v="1.3",N=m.__private__.getPdfVersion=function(){return v};m.__private__.setPdfVersion=function(f){v=f};var L={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return L};var w=m.__private__.getPageFormat=function(f){return L[f]};s=s||"a4";var j={COMPAT:"compat",ADVANCED:"advanced"},S=j.COMPAT;function I(){this.saveGraphicsState(),te(new We(Te,0,0,-Te,0,On()*Te).toString()+" cm"),this.setFontSize(this.getFontSize()/Te),h="n",S=j.ADVANCED}function R(){this.restoreGraphicsState(),h="S",S=j.COMPAT}var K=m.__private__.combineFontStyleAndFontWeight=function(f,C){if(f=="bold"&&C=="normal"||f=="bold"&&C==400||f=="normal"&&C=="italic"||f=="bold"&&C=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return C&&(f=C==400||C==="normal"?f==="italic"?"italic":"normal":C!=700&&C!=="bold"||f!=="normal"?(C==700?"bold":C)+""+f:"bold"),f};m.advancedAPI=function(f){var C=S===j.COMPAT;return C&&I.call(this),typeof f!="function"||(f(this),C&&R.call(this)),this},m.compatAPI=function(f){var C=S===j.ADVANCED;return C&&R.call(this),typeof f!="function"||(f(this),C&&I.call(this)),this},m.isAdvancedAPI=function(){return S===j.ADVANCED};var O,M=function(f){if(S!==j.ADVANCED)throw new Error(f+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},G=m.roundToPrecision=m.__private__.roundToPrecision=function(f,C){var $=t||C;if(isNaN(f)||isNaN($))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return f.toFixed($).replace(/0+$/,"")};O=m.hpf=m.__private__.hpf=typeof d=="number"?function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.hpf");return G(f,d)}:d==="smart"?function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.hpf");return G(f,f>-1&&f<1?16:5)}:function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.hpf");return G(f,16)};var J=m.f2=m.__private__.f2=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.f2");return G(f,2)},A=m.__private__.f3=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.f3");return G(f,3)},_=m.scale=m.__private__.scale=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.scale");return S===j.COMPAT?f*Te:S===j.ADVANCED?f:void 0},q=function(f){return S===j.COMPAT?On()-f:S===j.ADVANCED?f:void 0},H=function(f){return _(q(f))};m.__private__.setPrecision=m.setPrecision=function(f){typeof parseInt(f,10)=="number"&&(t=parseInt(f,10))};var le,Y="00000000000000000000000000000000",V=m.__private__.getFileId=function(){return Y},Z=m.__private__.setFileId=function(f){return Y=f!==void 0&&/^[a-fA-F0-9]{32}$/.test(f)?f.toUpperCase():Y.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),g!==null&&(or=new ds(g.userPermissions,g.userPassword,g.ownerPassword,Y)),Y};m.setFileId=function(f){return Z(f),this},m.getFileId=function(){return V()};var Q=m.__private__.convertDateToPDFDate=function(f){var C=f.getTimezoneOffset(),$=C<0?"+":"-",re=Math.floor(Math.abs(C/60)),ce=Math.abs(C%60),xe=[$,U(re),"'",U(ce),"'"].join("");return["D:",f.getFullYear(),U(f.getMonth()+1),U(f.getDate()),U(f.getHours()),U(f.getMinutes()),U(f.getSeconds()),xe].join("")},ie=m.__private__.convertPDFDateToDate=function(f){var C=parseInt(f.substr(2,4),10),$=parseInt(f.substr(6,2),10)-1,re=parseInt(f.substr(8,2),10),ce=parseInt(f.substr(10,2),10),xe=parseInt(f.substr(12,2),10),Se=parseInt(f.substr(14,2),10);return new Date(C,$,re,ce,xe,Se,0)},ge=m.__private__.setCreationDate=function(f){var C;if(f===void 0&&(f=new Date),f instanceof Date)C=Q(f);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(f))throw new Error("Invalid argument passed to jsPDF.setCreationDate");C=f}return le=C},k=m.__private__.getCreationDate=function(f){var C=le;return f==="jsDate"&&(C=ie(le)),C};m.setCreationDate=function(f){return ge(f),this},m.getCreationDate=function(f){return k(f)};var B,U=m.__private__.padd2=function(f){return("0"+parseInt(f)).slice(-2)},X=m.__private__.padd2Hex=function(f){return("00"+(f=f.toString())).substr(f.length)},ee=0,de=[],ue=[],me=0,ke=[],_e=[],Ce=!1,Ee=ue,Ve=function(){ee=0,me=0,ue=[],de=[],ke=[],jn=Wt(),Gr=Wt()};m.__private__.setCustomOutputDestination=function(f){Ce=!0,Ee=f};var ye=function(f){Ce||(Ee=f)};m.__private__.resetCustomOutputDestination=function(){Ce=!1,Ee=ue};var te=m.__private__.out=function(f){return f=f.toString(),me+=f.length+1,Ee.push(f),Ee},et=m.__private__.write=function(f){return te(arguments.length===1?f.toString():Array.prototype.join.call(arguments," "))},Re=m.__private__.getArrayBuffer=function(f){for(var C=f.length,$=new ArrayBuffer(C),re=new Uint8Array($);C--;)re[C]=f.charCodeAt(C);return $},Le=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Le};var Ae=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(f){return Ae=S===j.ADVANCED?f/Te:f,this};var Me,Ie=m.__private__.getFontSize=m.getFontSize=function(){return S===j.COMPAT?Ae:Ae*Te},qe=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(f){return qe=f,this},m.__private__.getR2L=m.getR2L=function(){return qe};var Ke,nt=m.__private__.setZoomMode=function(f){var C=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(f))Me=f;else if(isNaN(f)){if(C.indexOf(f)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+f+'" is not recognized.');Me=f}else Me=parseInt(f,10)};m.__private__.getZoomMode=function(){return Me};var at,lt=m.__private__.setPageMode=function(f){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(f)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+f+'" is not recognized.');Ke=f};m.__private__.getPageMode=function(){return Ke};var wt=m.__private__.setLayoutMode=function(f){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(f)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+f+'" is not recognized.');at=f};m.__private__.getLayoutMode=function(){return at},m.__private__.setDisplayMode=m.setDisplayMode=function(f,C,$){return nt(f),wt(C),lt($),this};var Ye={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(f){if(Object.keys(Ye).indexOf(f)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ye[f]},m.__private__.getDocumentProperties=function(){return Ye},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(f){for(var C in Ye)Ye.hasOwnProperty(C)&&f[C]&&(Ye[C]=f[C]);return this},m.__private__.setDocumentProperty=function(f,C){if(Object.keys(Ye).indexOf(f)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ye[f]=C};var st,Te,ir,ut,Hr,jt={},Ct={},on=[],mt={},ia={},It={},Wr={},Nn=null,Mt=0,Xe=[],gt=new fd(m),oa=e.hotfixes||[],nr={},ln={},cn=[],We=function f(C,$,re,ce,xe,Se){if(!(this instanceof f))return new f(C,$,re,ce,xe,Se);isNaN(C)&&(C=1),isNaN($)&&($=0),isNaN(re)&&(re=0),isNaN(ce)&&(ce=1),isNaN(xe)&&(xe=0),isNaN(Se)&&(Se=0),this._matrix=[C,$,re,ce,xe,Se]};Object.defineProperty(We.prototype,"sx",{get:function(){return this._matrix[0]},set:function(f){this._matrix[0]=f}}),Object.defineProperty(We.prototype,"shy",{get:function(){return this._matrix[1]},set:function(f){this._matrix[1]=f}}),Object.defineProperty(We.prototype,"shx",{get:function(){return this._matrix[2]},set:function(f){this._matrix[2]=f}}),Object.defineProperty(We.prototype,"sy",{get:function(){return this._matrix[3]},set:function(f){this._matrix[3]=f}}),Object.defineProperty(We.prototype,"tx",{get:function(){return this._matrix[4]},set:function(f){this._matrix[4]=f}}),Object.defineProperty(We.prototype,"ty",{get:function(){return this._matrix[5]},set:function(f){this._matrix[5]=f}}),Object.defineProperty(We.prototype,"a",{get:function(){return this._matrix[0]},set:function(f){this._matrix[0]=f}}),Object.defineProperty(We.prototype,"b",{get:function(){return this._matrix[1]},set:function(f){this._matrix[1]=f}}),Object.defineProperty(We.prototype,"c",{get:function(){return this._matrix[2]},set:function(f){this._matrix[2]=f}}),Object.defineProperty(We.prototype,"d",{get:function(){return this._matrix[3]},set:function(f){this._matrix[3]=f}}),Object.defineProperty(We.prototype,"e",{get:function(){return this._matrix[4]},set:function(f){this._matrix[4]=f}}),Object.defineProperty(We.prototype,"f",{get:function(){return this._matrix[5]},set:function(f){this._matrix[5]=f}}),Object.defineProperty(We.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(We.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(We.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(We.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),We.prototype.join=function(f){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(O).join(f)},We.prototype.multiply=function(f){var C=f.sx*this.sx+f.shy*this.shx,$=f.sx*this.shy+f.shy*this.sy,re=f.shx*this.sx+f.sy*this.shx,ce=f.shx*this.shy+f.sy*this.sy,xe=f.tx*this.sx+f.ty*this.shx+this.tx,Se=f.tx*this.shy+f.ty*this.sy+this.ty;return new We(C,$,re,ce,xe,Se)},We.prototype.decompose=function(){var f=this.sx,C=this.shy,$=this.shx,re=this.sy,ce=this.tx,xe=this.ty,Se=Math.sqrt(f*f+C*C),Oe=(f/=Se)*$+(C/=Se)*re;$-=f*Oe,re-=C*Oe;var ze=Math.sqrt($*$+re*re);return Oe/=ze,f*(re/=ze)<C*($/=ze)&&(f=-f,C=-C,Oe=-Oe,Se=-Se),{scale:new We(Se,0,0,ze,0,0),translate:new We(1,0,0,1,ce,xe),rotate:new We(f,C,-C,f,0,0),skew:new We(1,0,Oe,1,0,0)}},We.prototype.toString=function(f){return this.join(" ")},We.prototype.inversed=function(){var f=this.sx,C=this.shy,$=this.shx,re=this.sy,ce=this.tx,xe=this.ty,Se=1/(f*re-C*$),Oe=re*Se,ze=-C*Se,tt=-$*Se,Qe=f*Se;return new We(Oe,ze,tt,Qe,-Oe*ce-tt*xe,-ze*ce-Qe*xe)},We.prototype.applyToPoint=function(f){var C=f.x*this.sx+f.y*this.shx+this.tx,$=f.x*this.shy+f.y*this.sy+this.ty;return new Wa(C,$)},We.prototype.applyToRectangle=function(f){var C=this.applyToPoint(f),$=this.applyToPoint(new Wa(f.x+f.w,f.y+f.h));return new Cs(C.x,C.y,$.x-C.x,$.y-C.y)},We.prototype.clone=function(){var f=this.sx,C=this.shy,$=this.shx,re=this.sy,ce=this.tx,xe=this.ty;return new We(f,C,$,re,ce,xe)},m.Matrix=We;var Vr=m.matrixMult=function(f,C){return C.multiply(f)},dn=new We(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=dn;var vr=function(f,C){if(!ia[f]){var $=(C instanceof Xn?"Sh":"P")+(Object.keys(mt).length+1).toString(10);C.id=$,ia[f]=$,mt[$]=C,gt.publish("addPattern",C)}};m.ShadingPattern=Xn,m.TilingPattern=wa,m.addShadingPattern=function(f,C){return M("addShadingPattern()"),vr(f,C),this},m.beginTilingPattern=function(f){M("beginTilingPattern()"),Ti(f.boundingBox[0],f.boundingBox[1],f.boundingBox[2]-f.boundingBox[0],f.boundingBox[3]-f.boundingBox[1],f.matrix)},m.endTilingPattern=function(f,C){M("endTilingPattern()"),C.stream=_e[B].join(`
`),vr(f,C),gt.publish("endTilingPattern",C),cn.pop().restore()};var $t=m.__private__.newObject=function(){var f=Wt();return Ar(f,!0),f},Wt=m.__private__.newObjectDeferred=function(){return ee++,de[ee]=function(){return me},ee},Ar=function(f,C){return C=typeof C=="boolean"&&C,de[f]=me,C&&te(f+" 0 obj"),f},Ea=m.__private__.newAdditionalObject=function(){var f={objId:Wt(),content:""};return ke.push(f),f},jn=Wt(),Gr=Wt(),Yr=m.__private__.decodeColorString=function(f){var C=f.split(" ");if(C.length!==2||C[1]!=="g"&&C[1]!=="G")C.length===5&&(C[4]==="k"||C[4]==="K")&&(C=[(1-C[0])*(1-C[3]),(1-C[1])*(1-C[3]),(1-C[2])*(1-C[3]),"r"]);else{var $=parseFloat(C[0]);C=[$,$,$,"r"]}for(var re="#",ce=0;ce<3;ce++)re+=("0"+Math.floor(255*parseFloat(C[ce])).toString(16)).slice(-2);return re},$r=m.__private__.encodeColorString=function(f){var C;typeof f=="string"&&(f={ch1:f});var $=f.ch1,re=f.ch2,ce=f.ch3,xe=f.ch4,Se=f.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof $=="string"&&$.charAt(0)!=="#"){var Oe=new cu($);if(Oe.ok)$=Oe.toHex();else if(!/^\d*\.?\d*$/.test($))throw new Error('Invalid color "'+$+'" passed to jsPDF.encodeColorString.')}if(typeof $=="string"&&/^#[0-9A-Fa-f]{3}$/.test($)&&($="#"+$[1]+$[1]+$[2]+$[2]+$[3]+$[3]),typeof $=="string"&&/^#[0-9A-Fa-f]{6}$/.test($)){var ze=parseInt($.substr(1),16);$=ze>>16&255,re=ze>>8&255,ce=255&ze}if(re===void 0||xe===void 0&&$===re&&re===ce)if(typeof $=="string")C=$+" "+Se[0];else switch(f.precision){case 2:C=J($/255)+" "+Se[0];break;case 3:default:C=A($/255)+" "+Se[0]}else if(xe===void 0||vt(xe)==="object"){if(xe&&!isNaN(xe.a)&&xe.a===0)return C=["1.","1.","1.",Se[1]].join(" ");if(typeof $=="string")C=[$,re,ce,Se[1]].join(" ");else switch(f.precision){case 2:C=[J($/255),J(re/255),J(ce/255),Se[1]].join(" ");break;default:case 3:C=[A($/255),A(re/255),A(ce/255),Se[1]].join(" ")}}else if(typeof $=="string")C=[$,re,ce,xe,Se[2]].join(" ");else switch(f.precision){case 2:C=[J($),J(re),J(ce),J(xe),Se[2]].join(" ");break;case 3:default:C=[A($),A(re),A(ce),A(xe),Se[2]].join(" ")}return C},un=m.__private__.getFilters=function(){return o},Tr=m.__private__.putStream=function(f){var C=(f=f||{}).data||"",$=f.filters||un(),re=f.alreadyAppliedFilters||[],ce=f.addLength1||!1,xe=C.length,Se=f.objectId,Oe=function(lr){return lr};if(g!==null&&Se===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");g!==null&&(Oe=or.encryptor(Se,0));var ze={};$===!0&&($=["FlateEncode"]);var tt=f.additionalKeyValues||[],Qe=(ze=Ue.API.processDataByFilters!==void 0?Ue.API.processDataByFilters(C,$):{data:C,reverseChain:[]}).reverseChain+(Array.isArray(re)?re.join(" "):re.toString());if(ze.data.length!==0&&(tt.push({key:"Length",value:ze.data.length}),ce===!0&&tt.push({key:"Length1",value:xe})),Qe.length!=0)if(Qe.split("/").length-1==1)tt.push({key:"Filter",value:Qe});else{tt.push({key:"Filter",value:"["+Qe+"]"});for(var ot=0;ot<tt.length;ot+=1)if(tt[ot].key==="DecodeParms"){for(var Et=[],Tt=0;Tt<ze.reverseChain.split("/").length-1;Tt+=1)Et.push("null");Et.push(tt[ot].value),tt[ot].value="["+Et.join(" ")+"]"}}te("<<");for(var Vt=0;Vt<tt.length;Vt++)te("/"+tt[Vt].key+" "+tt[Vt].value);te(">>"),ze.data.length!==0&&(te("stream"),te(Oe(ze.data)),te("endstream"))},hn=m.__private__.putPage=function(f){var C=f.number,$=f.data,re=f.objId,ce=f.contentsObjId;Ar(re,!0),te("<</Type /Page"),te("/Parent "+f.rootDictionaryObjId+" 0 R"),te("/Resources "+f.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(O(f.mediaBox.bottomLeftX))+" "+parseFloat(O(f.mediaBox.bottomLeftY))+" "+O(f.mediaBox.topRightX)+" "+O(f.mediaBox.topRightY)+"]"),f.cropBox!==null&&te("/CropBox ["+O(f.cropBox.bottomLeftX)+" "+O(f.cropBox.bottomLeftY)+" "+O(f.cropBox.topRightX)+" "+O(f.cropBox.topRightY)+"]"),f.bleedBox!==null&&te("/BleedBox ["+O(f.bleedBox.bottomLeftX)+" "+O(f.bleedBox.bottomLeftY)+" "+O(f.bleedBox.topRightX)+" "+O(f.bleedBox.topRightY)+"]"),f.trimBox!==null&&te("/TrimBox ["+O(f.trimBox.bottomLeftX)+" "+O(f.trimBox.bottomLeftY)+" "+O(f.trimBox.topRightX)+" "+O(f.trimBox.topRightY)+"]"),f.artBox!==null&&te("/ArtBox ["+O(f.artBox.bottomLeftX)+" "+O(f.artBox.bottomLeftY)+" "+O(f.artBox.topRightX)+" "+O(f.artBox.topRightY)+"]"),typeof f.userUnit=="number"&&f.userUnit!==1&&te("/UserUnit "+f.userUnit),gt.publish("putPage",{objId:re,pageContext:Xe[C],pageNumber:C,page:$}),te("/Contents "+ce+" 0 R"),te(">>"),te("endobj");var xe=$.join(`
`);return S===j.ADVANCED&&(xe+=`
Q`),Ar(ce,!0),Tr({data:xe,filters:un(),objectId:ce}),te("endobj"),re},la=m.__private__.putPages=function(){var f,C,$=[];for(f=1;f<=Mt;f++)Xe[f].objId=Wt(),Xe[f].contentsObjId=Wt();for(f=1;f<=Mt;f++)$.push(hn({number:f,data:_e[f],objId:Xe[f].objId,contentsObjId:Xe[f].contentsObjId,mediaBox:Xe[f].mediaBox,cropBox:Xe[f].cropBox,bleedBox:Xe[f].bleedBox,trimBox:Xe[f].trimBox,artBox:Xe[f].artBox,userUnit:Xe[f].userUnit,rootDictionaryObjId:jn,resourceDictionaryObjId:Gr}));Ar(jn,!0),te("<</Type /Pages");var re="/Kids [";for(C=0;C<Mt;C++)re+=$[C]+" 0 R ";te(re+"]"),te("/Count "+Mt),te(">>"),te("endobj"),gt.publish("postPutPages")},Fa=function(f){gt.publish("putFont",{font:f,out:te,newObject:$t,putStream:Tr}),f.isAlreadyPutted!==!0&&(f.objectNumber=$t(),te("<<"),te("/Type /Font"),te("/BaseFont /"+us(f.postScriptName)),te("/Subtype /Type1"),typeof f.encoding=="string"&&te("/Encoding /"+f.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},Ia=function(){for(var f in jt)jt.hasOwnProperty(f)&&(x===!1||x===!0&&y.hasOwnProperty(f))&&Fa(jt[f])},Ma=function(f){f.objectNumber=$t();var C=[];C.push({key:"Type",value:"/XObject"}),C.push({key:"Subtype",value:"/Form"}),C.push({key:"BBox",value:"["+[O(f.x),O(f.y),O(f.x+f.width),O(f.y+f.height)].join(" ")+"]"}),C.push({key:"Matrix",value:"["+f.matrix.toString()+"]"});var $=f.pages[1].join(`
`);Tr({data:$,additionalKeyValues:C,objectId:f.objectNumber}),te("endobj")},Ta=function(){for(var f in nr)nr.hasOwnProperty(f)&&Ma(nr[f])},xi=function(f,C){var $,re=[],ce=1/(C-1);for($=0;$<1;$+=ce)re.push($);if(re.push(1),f[0].offset!=0){var xe={offset:0,color:f[0].color};f.unshift(xe)}if(f[f.length-1].offset!=1){var Se={offset:1,color:f[f.length-1].color};f.push(Se)}for(var Oe="",ze=0,tt=0;tt<re.length;tt++){for($=re[tt];$>f[ze+1].offset;)ze++;var Qe=f[ze].offset,ot=($-Qe)/(f[ze+1].offset-Qe),Et=f[ze].color,Tt=f[ze+1].color;Oe+=X(Math.round((1-ot)*Et[0]+ot*Tt[0]).toString(16))+X(Math.round((1-ot)*Et[1]+ot*Tt[1]).toString(16))+X(Math.round((1-ot)*Et[2]+ot*Tt[2]).toString(16))}return Oe.trim()},zo=function(f,C){C||(C=21);var $=$t(),re=xi(f.colors,C),ce=[];ce.push({key:"FunctionType",value:"0"}),ce.push({key:"Domain",value:"[0.0 1.0]"}),ce.push({key:"Size",value:"["+C+"]"}),ce.push({key:"BitsPerSample",value:"8"}),ce.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ce.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Tr({data:re,additionalKeyValues:ce,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:$}),te("endobj"),f.objectNumber=$t(),te("<< /ShadingType "+f.type),te("/ColorSpace /DeviceRGB");var xe="/Coords ["+O(parseFloat(f.coords[0]))+" "+O(parseFloat(f.coords[1]))+" ";f.type===2?xe+=O(parseFloat(f.coords[2]))+" "+O(parseFloat(f.coords[3])):xe+=O(parseFloat(f.coords[2]))+" "+O(parseFloat(f.coords[3]))+" "+O(parseFloat(f.coords[4]))+" "+O(parseFloat(f.coords[5])),te(xe+="]"),f.matrix&&te("/Matrix ["+f.matrix.toString()+"]"),te("/Function "+$+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},Uo=function(f,C){var $=Wt(),re=$t();C.push({resourcesOid:$,objectOid:re}),f.objectNumber=re;var ce=[];ce.push({key:"Type",value:"/Pattern"}),ce.push({key:"PatternType",value:"1"}),ce.push({key:"PaintType",value:"1"}),ce.push({key:"TilingType",value:"1"}),ce.push({key:"BBox",value:"["+f.boundingBox.map(O).join(" ")+"]"}),ce.push({key:"XStep",value:O(f.xStep)}),ce.push({key:"YStep",value:O(f.yStep)}),ce.push({key:"Resources",value:$+" 0 R"}),f.matrix&&ce.push({key:"Matrix",value:"["+f.matrix.toString()+"]"}),Tr({data:f.stream,additionalKeyValues:ce,objectId:f.objectNumber}),te("endobj")},Oa=function(f){var C;for(C in mt)mt.hasOwnProperty(C)&&(mt[C]instanceof Xn?zo(mt[C]):mt[C]instanceof wa&&Uo(mt[C],f))},yi=function(f){for(var C in f.objectNumber=$t(),te("<<"),f)switch(C){case"opacity":te("/ca "+J(f[C]));break;case"stroke-opacity":te("/CA "+J(f[C]))}te(">>"),te("endobj")},Ho=function(){var f;for(f in It)It.hasOwnProperty(f)&&yi(It[f])},bs=function(){for(var f in te("/XObject <<"),nr)nr.hasOwnProperty(f)&&nr[f].objectNumber>=0&&te("/"+f+" "+nr[f].objectNumber+" 0 R");gt.publish("putXobjectDict"),te(">>")},Wo=function(){or.oid=$t(),te("<<"),te("/Filter /Standard"),te("/V "+or.v),te("/R "+or.r),te("/U <"+or.toHexString(or.U)+">"),te("/O <"+or.toHexString(or.O)+">"),te("/P "+or.P),te(">>"),te("endobj")},vi=function(){for(var f in te("/Font <<"),jt)jt.hasOwnProperty(f)&&(x===!1||x===!0&&y.hasOwnProperty(f))&&te("/"+f+" "+jt[f].objectNumber+" 0 R");te(">>")},Vo=function(){if(Object.keys(mt).length>0){for(var f in te("/Shading <<"),mt)mt.hasOwnProperty(f)&&mt[f]instanceof Xn&&mt[f].objectNumber>=0&&te("/"+f+" "+mt[f].objectNumber+" 0 R");gt.publish("putShadingPatternDict"),te(">>")}},Da=function(f){if(Object.keys(mt).length>0){for(var C in te("/Pattern <<"),mt)mt.hasOwnProperty(C)&&mt[C]instanceof m.TilingPattern&&mt[C].objectNumber>=0&&mt[C].objectNumber<f&&te("/"+C+" "+mt[C].objectNumber+" 0 R");gt.publish("putTilingPatternDict"),te(">>")}},Go=function(){if(Object.keys(It).length>0){var f;for(f in te("/ExtGState <<"),It)It.hasOwnProperty(f)&&It[f].objectNumber>=0&&te("/"+f+" "+It[f].objectNumber+" 0 R");gt.publish("putGStateDict"),te(">>")}},Bt=function(f){Ar(f.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),vi(),Vo(),Da(f.objectOid),Go(),bs(),te(">>"),te("endobj")},bi=function(){var f=[];Ia(),Ho(),Ta(),Oa(f),gt.publish("putResources"),f.forEach(Bt),Bt({resourcesOid:Gr,objectOid:Number.MAX_SAFE_INTEGER}),gt.publish("postPutResources")},wi=function(){gt.publish("putAdditionalObjects");for(var f=0;f<ke.length;f++){var C=ke[f];Ar(C.objId,!0),te(C.content),te("endobj")}gt.publish("postPutAdditionalObjects")},Ni=function(f){Ct[f.fontName]=Ct[f.fontName]||{},Ct[f.fontName][f.fontStyle]=f.id},ws=function(f,C,$,re,ce){var xe={id:"F"+(Object.keys(jt).length+1).toString(10),postScriptName:f,fontName:C,fontStyle:$,encoding:re,isStandardFont:ce||!1,metadata:{}};return gt.publish("addFont",{font:xe,instance:this}),jt[xe.id]=xe,Ni(xe),xe.id},Yo=function(f){for(var C=0,$=Le.length;C<$;C++){var re=ws.call(this,f[C][0],f[C][1],f[C][2],Le[C][3],!0);x===!1&&(y[re]=!0);var ce=f[C][0].split("-");Ni({id:re,fontName:ce[0],fontStyle:ce[1]||""})}gt.publish("addFonts",{fonts:jt,dictionary:Ct})},Jr=function(f){return f.foo=function(){try{return f.apply(this,arguments)}catch(re){var C=re.stack||"";~C.indexOf(" at ")&&(C=C.split(" at ")[1]);var $="Error in function "+C.split(`
`)[0].split("<")[0]+": "+re.message;if(!Ge.console)throw new Error($);Ge.console.error($,re),Ge.alert&&alert($)}},f.foo.bar=f,f.foo},Ba=function(f,C){var $,re,ce,xe,Se,Oe,ze,tt,Qe;if(ce=(C=C||{}).sourceEncoding||"Unicode",Se=C.outputEncoding,(C.autoencode||Se)&&jt[st].metadata&&jt[st].metadata[ce]&&jt[st].metadata[ce].encoding&&(xe=jt[st].metadata[ce].encoding,!Se&&jt[st].encoding&&(Se=jt[st].encoding),!Se&&xe.codePages&&(Se=xe.codePages[0]),typeof Se=="string"&&(Se=xe[Se]),Se)){for(ze=!1,Oe=[],$=0,re=f.length;$<re;$++)(tt=Se[f.charCodeAt($)])?Oe.push(String.fromCharCode(tt)):Oe.push(f[$]),Oe[$].charCodeAt(0)>>8&&(ze=!0);f=Oe.join("")}for($=f.length;ze===void 0&&$!==0;)f.charCodeAt($-1)>>8&&(ze=!0),$--;if(!ze)return f;for(Oe=C.noBOM?[]:[254,255],$=0,re=f.length;$<re;$++){if((Qe=(tt=f.charCodeAt($))>>8)>>8)throw new Error("Character at position "+$+" of string '"+f+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Oe.push(Qe),Oe.push(tt-(Qe<<8))}return String.fromCharCode.apply(void 0,Oe)},br=m.__private__.pdfEscape=m.pdfEscape=function(f,C){return Ba(f,C).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ns=m.__private__.beginPage=function(f){_e[++Mt]=[],Xe[Mt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(f[0]),topRightY:Number(f[1])}},Si(Mt),ye(_e[B])},ji=function(f,C){var $,re,ce;switch(r=C||r,typeof f=="string"&&($=w(f.toLowerCase()),Array.isArray($)&&(re=$[0],ce=$[1])),Array.isArray(f)&&(re=f[0]*Te,ce=f[1]*Te),isNaN(re)&&(re=s[0],ce=s[1]),(re>14400||ce>14400)&&(_t.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),re=Math.min(14400,re),ce=Math.min(14400,ce)),s=[re,ce],r.substr(0,1)){case"l":ce>re&&(s=[ce,re]);break;case"p":re>ce&&(s=[ce,re])}Ns(s),Ci(ks),te(Kr),As!==0&&te(As+" J"),Ps!==0&&te(Ps+" j"),gt.publish("addPage",{pageNumber:Mt})},$o=function(f){f>0&&f<=Mt&&(_e.splice(f,1),Xe.splice(f,1),Mt--,B>Mt&&(B=Mt),this.setPage(B))},Si=function(f){f>0&&f<=Mt&&(B=f)},Jo=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return _e.length-1},_i=function(f,C,$){var re,ce=void 0;return $=$||{},f=f!==void 0?f:jt[st].fontName,C=C!==void 0?C:jt[st].fontStyle,re=f.toLowerCase(),Ct[re]!==void 0&&Ct[re][C]!==void 0?ce=Ct[re][C]:Ct[f]!==void 0&&Ct[f][C]!==void 0?ce=Ct[f][C]:$.disableWarning===!1&&_t.warn("Unable to look up font label for font '"+f+"', '"+C+"'. Refer to getFontList() for available fonts."),ce||$.noFallback||(ce=Ct.times[C])==null&&(ce=Ct.times.normal),ce},Ko=m.__private__.putInfo=function(){var f=$t(),C=function(re){return re};for(var $ in g!==null&&(C=or.encryptor(f,0)),te("<<"),te("/Producer ("+br(C("jsPDF "+Ue.version))+")"),Ye)Ye.hasOwnProperty($)&&Ye[$]&&te("/"+$.substr(0,1).toUpperCase()+$.substr(1)+" ("+br(C(Ye[$]))+")");te("/CreationDate ("+br(C(le))+")"),te(">>"),te("endobj")},js=m.__private__.putCatalog=function(f){var C=(f=f||{}).rootDictionaryObjId||jn;switch($t(),te("<<"),te("/Type /Catalog"),te("/Pages "+C+" 0 R"),Me||(Me="fullwidth"),Me){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var $=""+Me;$.substr($.length-1)==="%"&&(Me=parseInt(Me)/100),typeof Me=="number"&&te("/OpenAction [3 0 R /XYZ null null "+J(Me)+"]")}switch(at||(at="continuous"),at){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}Ke&&te("/PageMode /"+Ke),gt.publish("putCatalog"),te(">>"),te("endobj")},Xo=m.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(ee+1)),te("/Root "+ee+" 0 R"),te("/Info "+(ee-1)+" 0 R"),g!==null&&te("/Encrypt "+or.oid+" 0 R"),te("/ID [ <"+Y+"> <"+Y+"> ]"),te(">>")},Qo=m.__private__.putHeader=function(){te("%PDF-"+v),te("%ºß¬à")},Zo=m.__private__.putXRef=function(){var f="0000000000";te("xref"),te("0 "+(ee+1)),te("0000000000 65535 f ");for(var C=1;C<=ee;C++)typeof de[C]=="function"?te((f+de[C]()).slice(-10)+" 00000 n "):de[C]!==void 0?te((f+de[C]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},Sn=m.__private__.buildDocument=function(){Ve(),ye(ue),gt.publish("buildDocument"),Qo(),la(),wi(),bi(),g!==null&&Wo(),Ko(),js();var f=me;return Zo(),Xo(),te("startxref"),te(""+f),te("%%EOF"),ye(_e[B]),ue.join(`
`)},Ra=m.__private__.getBlob=function(f){return new Blob([Re(f)],{type:"application/pdf"})},qa=m.output=m.__private__.output=Jr(function(f,C){switch(typeof(C=C||{})=="string"?C={filename:C}:C.filename=C.filename||"generated.pdf",f){case void 0:return Sn();case"save":m.save(C.filename);break;case"arraybuffer":return Re(Sn());case"blob":return Ra(Sn());case"bloburi":case"bloburl":if(Ge.URL!==void 0&&typeof Ge.URL.createObjectURL=="function")return Ge.URL&&Ge.URL.createObjectURL(Ra(Sn()))||void 0;_t.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var $="",re=Sn();try{$=rc(re)}catch{$=rc(unescape(encodeURIComponent(re)))}return"data:application/pdf;filename="+C.filename+";base64,"+$;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ge)==="[object Window]"){var ce="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';C.pdfObjectUrl&&(ce=C.pdfObjectUrl,xe="");var Se='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ce+'"'+xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(C)+");<\/script></body></html>",Oe=Ge.open();return Oe!==null&&Oe.document.write(Se),Oe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ge)==="[object Window]"){var ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(C.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+C.filename+'" width="500px" height="400px" /></body></html>',tt=Ge.open();if(tt!==null){tt.document.write(ze);var Qe=this;tt.document.documentElement.querySelector("#pdfViewer").onload=function(){tt.document.title=C.filename,tt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Qe.output("bloburl"))}}return tt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ge)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",C)+'"></iframe></body></html>',Et=Ge.open();if(Et!==null&&(Et.document.write(ot),Et.document.title=C.filename),Et||typeof safari>"u")return Et;break;case"datauri":case"dataurl":return Ge.document.location.href=this.output("datauristring",C);default:return null}}),ki=function(f){return Array.isArray(oa)===!0&&oa.indexOf(f)>-1};switch(a){case"pt":Te=1;break;case"mm":Te=72/25.4;break;case"cm":Te=72/2.54;break;case"in":Te=72;break;case"px":Te=ki("px_scaling")==1?.75:96/72;break;case"pc":case"em":Te=12;break;case"ex":Te=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Te=a}var or=null;ge(),Z();var el=function(f){return g!==null?or.encryptor(f,0):function(C){return C}},Li=m.__private__.getPageInfo=m.getPageInfo=function(f){if(isNaN(f)||f%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Xe[f].objId,pageNumber:f,pageContext:Xe[f]}},Je=m.__private__.getPageInfoByObjId=function(f){if(isNaN(f)||f%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var C in Xe)if(Xe[C].objId===f)break;return Li(C)},tl=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Xe[B].objId,pageNumber:B,pageContext:Xe[B]}};m.addPage=function(){return ji.apply(this,arguments),this},m.setPage=function(){return Si.apply(this,arguments),ye.call(this,_e[B]),this},m.insertPage=function(f){return this.addPage(),this.movePage(B,f),this},m.movePage=function(f,C){var $,re;if(f>C){$=_e[f],re=Xe[f];for(var ce=f;ce>C;ce--)_e[ce]=_e[ce-1],Xe[ce]=Xe[ce-1];_e[C]=$,Xe[C]=re,this.setPage(C)}else if(f<C){$=_e[f],re=Xe[f];for(var xe=f;xe<C;xe++)_e[xe]=_e[xe+1],Xe[xe]=Xe[xe+1];_e[C]=$,Xe[C]=re,this.setPage(C)}return this},m.deletePage=function(){return $o.apply(this,arguments),this},m.__private__.text=m.text=function(f,C,$,re,ce){var xe,Se,Oe,ze,tt,Qe,ot,Et,Tt,Vt=(re=re||{}).scope||this;if(typeof f=="number"&&typeof C=="number"&&(typeof $=="string"||Array.isArray($))){var lr=$;$=C,C=f,f=lr}if(arguments[3]instanceof We?(M("The transform parameter of text() with a Matrix value"),Tt=ce):(Oe=arguments[4],ze=arguments[5],vt(ot=arguments[3])==="object"&&ot!==null||(typeof Oe=="string"&&(ze=Oe,Oe=null),typeof ot=="string"&&(ze=ot,ot=null),typeof ot=="number"&&(Oe=ot,ot=null),re={flags:ot,angle:Oe,align:ze})),isNaN(C)||isNaN($)||f==null)throw new Error("Invalid arguments passed to jsPDF.text");if(f.length===0)return Vt;var Zt="",Xr=!1,Pr=typeof re.lineHeightFactor=="number"?re.lineHeightFactor:da,gn=Vt.internal.scaleFactor;function Oi(kt){return kt=kt.split("	").join(Array(re.TabLen||9).join(" ")),br(kt,ot)}function Ms(kt){for(var Lt,qt=kt.concat(),Jt=[],Pn=qt.length;Pn--;)typeof(Lt=qt.shift())=="string"?Jt.push(Lt):Array.isArray(kt)&&(Lt.length===1||Lt[1]===void 0&&Lt[2]===void 0)?Jt.push(Lt[0]):Jt.push([Lt[0],Lt[1],Lt[2]]);return Jt}function Ts(kt,Lt){var qt;if(typeof kt=="string")qt=Lt(kt)[0];else if(Array.isArray(kt)){for(var Jt,Pn,Hs=kt.concat(),ts=[],zi=Hs.length;zi--;)typeof(Jt=Hs.shift())=="string"?ts.push(Lt(Jt)[0]):Array.isArray(Jt)&&typeof Jt[0]=="string"&&(Pn=Lt(Jt[0],Jt[1],Jt[2]),ts.push([Pn[0],Pn[1],Pn[2]]));qt=ts}return qt}var Ga=!1,Os=!0;if(typeof f=="string")Ga=!0;else if(Array.isArray(f)){var Ds=f.concat();Se=[];for(var Ya,ar=Ds.length;ar--;)(typeof(Ya=Ds.shift())!="string"||Array.isArray(Ya)&&typeof Ya[0]!="string")&&(Os=!1);Ga=Os}if(Ga===!1)throw new Error('Type of text must be string or Array. "'+f+'" is not recognized.');typeof f=="string"&&(f=f.match(/[\r?\n]/)?f.split(/\r\n|\r|\n/g):[f]);var $a=Ae/Vt.internal.scaleFactor,Ja=$a*(Pr-1);switch(re.baseline){case"bottom":$-=Ja;break;case"top":$+=$a-Ja;break;case"hanging":$+=$a-2*Ja;break;case"middle":$+=$a/2-Ja}if((Qe=re.maxWidth||0)>0&&(typeof f=="string"?f=Vt.splitTextToSize(f,Qe):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(kt,Lt){return kt.concat(Vt.splitTextToSize(Lt,Qe))},[]))),xe={text:f,x:C,y:$,options:re,mutex:{pdfEscape:br,activeFontKey:st,fonts:jt,activeFontSize:Ae}},gt.publish("preProcessText",xe),f=xe.text,Oe=(re=xe.options).angle,!(Tt instanceof We)&&Oe&&typeof Oe=="number"){Oe*=Math.PI/180,re.rotationDirection===0&&(Oe=-Oe),S===j.ADVANCED&&(Oe=-Oe);var Ka=Math.cos(Oe),Bs=Math.sin(Oe);Tt=new We(Ka,Bs,-Bs,Ka,0,0)}else Oe&&Oe instanceof We&&(Tt=Oe);S!==j.ADVANCED||Tt||(Tt=dn),(tt=re.charSpace||Ha)!==void 0&&(Zt+=O(_(tt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Et=re.horizontalScale)!==void 0&&(Zt+=O(100*Et)+` Tz
`),re.lang;var wr=-1,ul=re.renderingMode!==void 0?re.renderingMode:re.stroke,Rs=Vt.internal.getCurrentPageInfo().pageContext;switch(ul){case 0:case!1:case"fill":wr=0;break;case 1:case!0:case"stroke":wr=1;break;case 2:case"fillThenStroke":wr=2;break;case 3:case"invisible":wr=3;break;case 4:case"fillAndAddForClipping":wr=4;break;case 5:case"strokeAndAddPathForClipping":wr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":wr=6;break;case 7:case"addToPathForClipping":wr=7}var Di=Rs.usedRenderingMode!==void 0?Rs.usedRenderingMode:-1;wr!==-1?Zt+=wr+` Tr
`:Di!==-1&&(Zt+=`0 Tr
`),wr!==-1&&(Rs.usedRenderingMode=wr),ze=re.align||"left";var Or,Xa=Ae*Pr,Bi=Vt.internal.pageSize.getWidth(),Ri=jt[st];tt=re.charSpace||Ha,Qe=re.maxWidth||0,ot=Object.assign({autoencode:!0,noBOM:!0},re.flags);var Dn=[],fa=function(kt){return Vt.getStringUnitWidth(kt,{font:Ri,charSpace:tt,fontSize:Ae,doKerning:!1})*Ae/gn};if(Object.prototype.toString.call(f)==="[object Array]"){var Nr;Se=Ms(f),ze!=="left"&&(Or=Se.map(fa));var mr,Bn=0;if(ze==="right"){C-=Or[0],f=[],ar=Se.length;for(var kn=0;kn<ar;kn++)kn===0?(mr=mn(C),Nr=_n($)):(mr=_(Bn-Or[kn]),Nr=-Xa),f.push([Se[kn],mr,Nr]),Bn=Or[kn]}else if(ze==="center"){C-=Or[0]/2,f=[],ar=Se.length;for(var Ln=0;Ln<ar;Ln++)Ln===0?(mr=mn(C),Nr=_n($)):(mr=_((Bn-Or[Ln])/2),Nr=-Xa),f.push([Se[Ln],mr,Nr]),Bn=Or[Ln]}else if(ze==="left"){f=[],ar=Se.length;for(var Qa=0;Qa<ar;Qa++)f.push(Se[Qa])}else if(ze==="justify"&&Ri.encoding==="Identity-H"){f=[],ar=Se.length,Qe=Qe!==0?Qe:Bi;for(var An=0,Rt=0;Rt<ar;Rt++)if(Nr=Rt===0?_n($):-Xa,mr=Rt===0?mn(C):An,Rt<ar-1){var qs=_((Qe-Or[Rt])/(Se[Rt].split(" ").length-1)),gr=Se[Rt].split(" ");f.push([gr[0]+" ",mr,Nr]),An=0;for(var Dr=1;Dr<gr.length;Dr++){var Za=(fa(gr[Dr-1]+" "+gr[Dr])-fa(gr[Dr]))*gn+qs;Dr==gr.length-1?f.push([gr[Dr],Za,0]):f.push([gr[Dr]+" ",Za,0]),An-=Za}}else f.push([Se[Rt],mr,Nr]);f.push(["",An,0])}else{if(ze!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(f=[],ar=Se.length,Qe=Qe!==0?Qe:Bi,Rt=0;Rt<ar;Rt++)Nr=Rt===0?_n($):-Xa,mr=Rt===0?mn(C):0,Rt<ar-1?Dn.push(O(_((Qe-Or[Rt])/(Se[Rt].split(" ").length-1)))):Dn.push(0),f.push([Se[Rt],mr,Nr])}}var qi=typeof re.R2L=="boolean"?re.R2L:qe;qi===!0&&(f=Ts(f,function(kt,Lt,qt){return[kt.split("").reverse().join(""),Lt,qt]})),xe={text:f,x:C,y:$,options:re,mutex:{pdfEscape:br,activeFontKey:st,fonts:jt,activeFontSize:Ae}},gt.publish("postProcessText",xe),f=xe.text,Xr=xe.mutex.isHex||!1;var zs=jt[st].encoding;zs!=="WinAnsiEncoding"&&zs!=="StandardEncoding"||(f=Ts(f,function(kt,Lt,qt){return[Oi(kt),Lt,qt]})),Se=Ms(f),f=[];for(var ma,ga,Rn,pa=0,es=1,xa=Array.isArray(Se[0])?es:pa,qn="",Us=function(kt,Lt,qt){var Jt="";return qt instanceof We?(qt=typeof re.angle=="number"?Vr(qt,new We(1,0,0,1,kt,Lt)):Vr(new We(1,0,0,1,kt,Lt),qt),S===j.ADVANCED&&(qt=Vr(new We(1,0,0,-1,0,0),qt)),Jt=qt.join(" ")+` Tm
`):Jt=O(kt)+" "+O(Lt)+` Td
`,Jt},Br=0;Br<Se.length;Br++){switch(qn="",xa){case es:Rn=(Xr?"<":"(")+Se[Br][0]+(Xr?">":")"),ma=parseFloat(Se[Br][1]),ga=parseFloat(Se[Br][2]);break;case pa:Rn=(Xr?"<":"(")+Se[Br]+(Xr?">":")"),ma=mn(C),ga=_n($)}Dn!==void 0&&Dn[Br]!==void 0&&(qn=Dn[Br]+` Tw
`),Br===0?f.push(qn+Us(ma,ga,Tt)+Rn):xa===pa?f.push(qn+Rn):xa===es&&f.push(qn+Us(ma,ga,Tt)+Rn)}f=xa===pa?f.join(` Tj
T* `):f.join(` Tj
`),f+=` Tj
`;var Rr=`BT
/`;return Rr+=st+" "+Ae+` Tf
`,Rr+=O(Ae*Pr)+` TL
`,Rr+=ua+`
`,Rr+=Zt,Rr+=f,te(Rr+="ET"),y[st]=!0,Vt};var rl=m.__private__.clip=m.clip=function(f){return te(f==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return rl("evenodd")},m.__private__.discardPath=m.discardPath=function(){return te("n"),this};var fn=m.__private__.isValidStyle=function(f){var C=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(f)!==-1&&(C=!0),C};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(f){return fn(f)&&(h=f),this};var Ai=m.__private__.getStyle=m.getStyle=function(f){var C=h;switch(f){case"D":case"S":C="S";break;case"F":C="f";break;case"FD":case"DF":C="B";break;case"f":case"f*":case"B":case"B*":C=f}return C},Pi=m.close=function(){return te("h"),this};m.stroke=function(){return te("S"),this},m.fill=function(f){return za("f",f),this},m.fillEvenOdd=function(f){return za("f*",f),this},m.fillStroke=function(f){return za("B",f),this},m.fillStrokeEvenOdd=function(f){return za("B*",f),this};var za=function(f,C){vt(C)==="object"?al(C,f):te(f)},Ss=function(f){f===null||S===j.ADVANCED&&f===void 0||(f=Ai(f),te(f))};function nl(f,C,$,re,ce){var xe=new wa(C||this.boundingBox,$||this.xStep,re||this.yStep,this.gState,ce||this.matrix);xe.stream=this.stream;var Se=f+"$$"+this.cloneIndex+++"$$";return vr(Se,xe),xe}var al=function(f,C){var $=ia[f.key],re=mt[$];if(re instanceof Xn)te("q"),te(sl(C)),re.gState&&m.setGState(re.gState),te(f.matrix.toString()+" cm"),te("/"+$+" sh"),te("Q");else if(re instanceof wa){var ce=new We(1,0,0,-1,0,On());f.matrix&&(ce=ce.multiply(f.matrix||dn),$=nl.call(re,f.key,f.boundingBox,f.xStep,f.yStep,ce).id),te("q"),te("/Pattern cs"),te("/"+$+" scn"),re.gState&&m.setGState(re.gState),te(C),te("Q")}},sl=function(f){switch(f){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},_s=m.moveTo=function(f,C){return te(O(_(f))+" "+O(H(C))+" m"),this},ca=m.lineTo=function(f,C){return te(O(_(f))+" "+O(H(C))+" l"),this},Mn=m.curveTo=function(f,C,$,re,ce,xe){return te([O(_(f)),O(H(C)),O(_($)),O(H(re)),O(_(ce)),O(H(xe)),"c"].join(" ")),this};m.__private__.line=m.line=function(f,C,$,re,ce){if(isNaN(f)||isNaN(C)||isNaN($)||isNaN(re)||!fn(ce))throw new Error("Invalid arguments passed to jsPDF.line");return S===j.COMPAT?this.lines([[$-f,re-C]],f,C,[1,1],ce||"S"):this.lines([[$-f,re-C]],f,C,[1,1]).stroke()},m.__private__.lines=m.lines=function(f,C,$,re,ce,xe){var Se,Oe,ze,tt,Qe,ot,Et,Tt,Vt,lr,Zt,Xr;if(typeof f=="number"&&(Xr=$,$=C,C=f,f=Xr),re=re||[1,1],xe=xe||!1,isNaN(C)||isNaN($)||!Array.isArray(f)||!Array.isArray(re)||!fn(ce)||typeof xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_s(C,$),Se=re[0],Oe=re[1],tt=f.length,lr=C,Zt=$,ze=0;ze<tt;ze++)(Qe=f[ze]).length===2?(lr=Qe[0]*Se+lr,Zt=Qe[1]*Oe+Zt,ca(lr,Zt)):(ot=Qe[0]*Se+lr,Et=Qe[1]*Oe+Zt,Tt=Qe[2]*Se+lr,Vt=Qe[3]*Oe+Zt,lr=Qe[4]*Se+lr,Zt=Qe[5]*Oe+Zt,Mn(ot,Et,Tt,Vt,lr,Zt));return xe&&Pi(),Ss(ce),this},m.path=function(f){for(var C=0;C<f.length;C++){var $=f[C],re=$.c;switch($.op){case"m":_s(re[0],re[1]);break;case"l":ca(re[0],re[1]);break;case"c":Mn.apply(this,re);break;case"h":Pi()}}return this},m.__private__.rect=m.rect=function(f,C,$,re,ce){if(isNaN(f)||isNaN(C)||isNaN($)||isNaN(re)||!fn(ce))throw new Error("Invalid arguments passed to jsPDF.rect");return S===j.COMPAT&&(re=-re),te([O(_(f)),O(H(C)),O(_($)),O(_(re)),"re"].join(" ")),Ss(ce),this},m.__private__.triangle=m.triangle=function(f,C,$,re,ce,xe,Se){if(isNaN(f)||isNaN(C)||isNaN($)||isNaN(re)||isNaN(ce)||isNaN(xe)||!fn(Se))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[$-f,re-C],[ce-$,xe-re],[f-ce,C-xe]],f,C,[1,1],Se,!0),this},m.__private__.roundedRect=m.roundedRect=function(f,C,$,re,ce,xe,Se){if(isNaN(f)||isNaN(C)||isNaN($)||isNaN(re)||isNaN(ce)||isNaN(xe)||!fn(Se))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Oe=4/3*(Math.SQRT2-1);return ce=Math.min(ce,.5*$),xe=Math.min(xe,.5*re),this.lines([[$-2*ce,0],[ce*Oe,0,ce,xe-xe*Oe,ce,xe],[0,re-2*xe],[0,xe*Oe,-ce*Oe,xe,-ce,xe],[2*ce-$,0],[-ce*Oe,0,-ce,-xe*Oe,-ce,-xe],[0,2*xe-re],[0,-xe*Oe,ce*Oe,-xe,ce,-xe]],f+ce,C,[1,1],Se,!0),this},m.__private__.ellipse=m.ellipse=function(f,C,$,re,ce){if(isNaN(f)||isNaN(C)||isNaN($)||isNaN(re)||!fn(ce))throw new Error("Invalid arguments passed to jsPDF.ellipse");var xe=4/3*(Math.SQRT2-1)*$,Se=4/3*(Math.SQRT2-1)*re;return _s(f+$,C),Mn(f+$,C-Se,f+xe,C-re,f,C-re),Mn(f-xe,C-re,f-$,C-Se,f-$,C),Mn(f-$,C+Se,f-xe,C+re,f,C+re),Mn(f+xe,C+re,f+$,C+Se,f+$,C),Ss(ce),this},m.__private__.circle=m.circle=function(f,C,$,re){if(isNaN(f)||isNaN(C)||isNaN($)||!fn(re))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(f,C,$,$,re)},m.setFont=function(f,C,$){return $&&(C=K(C,$)),st=_i(f,C,{disableWarning:!1}),this};var il=m.__private__.getFont=m.getFont=function(){return jt[_i.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var f,C,$={};for(f in Ct)if(Ct.hasOwnProperty(f))for(C in $[f]=[],Ct[f])Ct[f].hasOwnProperty(C)&&$[f].push(C);return $},m.addFont=function(f,C,$,re,ce){var xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&xe.indexOf(arguments[3])!==-1?ce=arguments[3]:arguments[3]&&xe.indexOf(arguments[3])==-1&&($=K($,re)),ce=ce||"Identity-H",ws.call(this,f,C,$,ce)};var da,ks=e.lineWidth||.200025,Ua=m.__private__.getLineWidth=m.getLineWidth=function(){return ks},Ci=m.__private__.setLineWidth=m.setLineWidth=function(f){return ks=f,te(O(_(f))+" w"),this};m.__private__.setLineDash=Ue.API.setLineDash=Ue.API.setLineDashPattern=function(f,C){if(f=f||[],C=C||0,isNaN(C)||!Array.isArray(f))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return f=f.map(function($){return O(_($))}).join(" "),C=O(_(C)),te("["+f+"] "+C+" d"),this};var Ei=m.__private__.getLineHeight=m.getLineHeight=function(){return Ae*da};m.__private__.getLineHeight=m.getLineHeight=function(){return Ae*da};var Fi=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(f){return typeof(f=f||1.15)=="number"&&(da=f),this},Ii=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return da};Fi(e.lineHeight);var mn=m.__private__.getHorizontalCoordinate=function(f){return _(f)},_n=m.__private__.getVerticalCoordinate=function(f){return S===j.ADVANCED?f:Xe[B].mediaBox.topRightY-Xe[B].mediaBox.bottomLeftY-_(f)},ol=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(f){return O(mn(f))},Tn=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(f){return O(_n(f))},Kr=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Yr(Kr)},m.__private__.setStrokeColor=m.setDrawColor=function(f,C,$,re){return Kr=$r({ch1:f,ch2:C,ch3:$,ch4:re,pdfColorType:"draw",precision:2}),te(Kr),this};var Ls=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Yr(Ls)},m.__private__.setFillColor=m.setFillColor=function(f,C,$,re){return Ls=$r({ch1:f,ch2:C,ch3:$,ch4:re,pdfColorType:"fill",precision:2}),te(Ls),this};var ua=e.textColor||"0 g",ll=m.__private__.getTextColor=m.getTextColor=function(){return Yr(ua)};m.__private__.setTextColor=m.setTextColor=function(f,C,$,re){return ua=$r({ch1:f,ch2:C,ch3:$,ch4:re,pdfColorType:"text",precision:3}),this};var Ha=e.charSpace,cl=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Ha||0)};m.__private__.setCharSpace=m.setCharSpace=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ha=f,this};var As=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(f){var C=m.CapJoinStyles[f];if(C===void 0)throw new Error("Line cap style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return As=C,te(C+" J"),this};var Ps=0;m.__private__.setLineJoin=m.setLineJoin=function(f){var C=m.CapJoinStyles[f];if(C===void 0)throw new Error("Line join style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ps=C,te(C+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(f){if(f=f||0,isNaN(f))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(O(_(f))+" M"),this},m.GState=ci,m.setGState=function(f){(f=typeof f=="string"?It[Wr[f]]:Mi(null,f)).equals(Nn)||(te("/"+f.id+" gs"),Nn=f)};var Mi=function(f,C){if(!f||!Wr[f]){var $=!1;for(var re in It)if(It.hasOwnProperty(re)&&It[re].equals(C)){$=!0;break}if($)C=It[re];else{var ce="GS"+(Object.keys(It).length+1).toString(10);It[ce]=C,C.id=ce}return f&&(Wr[f]=C.id),gt.publish("addGState",C),C}};m.addGState=function(f,C){return Mi(f,C),this},m.saveGraphicsState=function(){return te("q"),on.push({key:st,size:Ae,color:ua}),this},m.restoreGraphicsState=function(){te("Q");var f=on.pop();return st=f.key,Ae=f.size,ua=f.color,Nn=null,this},m.setCurrentTransformationMatrix=function(f){return te(f.toString()+" cm"),this},m.comment=function(f){return te("#"+f),this};var Wa=function(f,C){var $=f||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return $},set:function(xe){isNaN(xe)||($=parseFloat(xe))}});var re=C||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return re},set:function(xe){isNaN(xe)||(re=parseFloat(xe))}});var ce="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ce},set:function(xe){ce=xe.toString()}}),this},Cs=function(f,C,$,re){Wa.call(this,f,C),this.type="rect";var ce=$||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ce},set:function(Se){isNaN(Se)||(ce=parseFloat(Se))}});var xe=re||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return xe},set:function(Se){isNaN(Se)||(xe=parseFloat(Se))}}),this},Es=function(){this.page=Mt,this.currentPage=B,this.pages=_e.slice(0),this.pagesContext=Xe.slice(0),this.x=ir,this.y=ut,this.matrix=Hr,this.width=ha(B),this.height=On(B),this.outputDestination=Ee,this.id="",this.objectNumber=-1};Es.prototype.restore=function(){Mt=this.page,B=this.currentPage,Xe=this.pagesContext,_e=this.pages,ir=this.x,ut=this.y,Hr=this.matrix,Fs(B,this.width),Is(B,this.height),Ee=this.outputDestination};var Ti=function(f,C,$,re,ce){cn.push(new Es),Mt=B=0,_e=[],ir=f,ut=C,Hr=ce,Ns([$,re])},dl=function(f){if(ln[f])cn.pop().restore();else{var C=new Es,$="Xo"+(Object.keys(nr).length+1).toString(10);C.id=$,ln[f]=$,nr[$]=C,gt.publish("addFormObject",C),cn.pop().restore()}};for(var Va in m.beginFormObject=function(f,C,$,re,ce){return Ti(f,C,$,re,ce),this},m.endFormObject=function(f){return dl(f),this},m.doFormObject=function(f,C){var $=nr[ln[f]];return te("q"),te(C.toString()+" cm"),te("/"+$.id+" Do"),te("Q"),this},m.getFormObject=function(f){var C=nr[ln[f]];return{x:C.x,y:C.y,width:C.width,height:C.height,matrix:C.matrix}},m.save=function(f,C){return f=f||"generated.pdf",(C=C||{}).returnPromise=C.returnPromise||!1,C.returnPromise===!1?(va(Ra(Sn()),f),typeof va.unload=="function"&&Ge.setTimeout&&setTimeout(va.unload,911),this):new Promise(function($,re){try{var ce=va(Ra(Sn()),f);typeof va.unload=="function"&&Ge.setTimeout&&setTimeout(va.unload,911),$(ce)}catch(xe){re(xe.message)}})},Ue.API)Ue.API.hasOwnProperty(Va)&&(Va==="events"&&Ue.API.events.length?function(f,C){var $,re,ce;for(ce=C.length-1;ce!==-1;ce--)$=C[ce][0],re=C[ce][1],f.subscribe.apply(f,[$].concat(typeof re=="function"?[re]:re))}(gt,Ue.API.events):m[Va]=Ue.API[Va]);var ha=m.getPageWidth=function(f){return(Xe[f=f||B].mediaBox.topRightX-Xe[f].mediaBox.bottomLeftX)/Te},Fs=m.setPageWidth=function(f,C){Xe[f].mediaBox.topRightX=C*Te+Xe[f].mediaBox.bottomLeftX},On=m.getPageHeight=function(f){return(Xe[f=f||B].mediaBox.topRightY-Xe[f].mediaBox.bottomLeftY)/Te},Is=m.setPageHeight=function(f,C){Xe[f].mediaBox.topRightY=C*Te+Xe[f].mediaBox.bottomLeftY};return m.internal={pdfEscape:br,getStyle:Ai,getFont:il,getFontSize:Ie,getCharSpace:cl,getTextColor:ll,getLineHeight:Ei,getLineHeightFactor:Ii,getLineWidth:Ua,write:et,getHorizontalCoordinate:mn,getVerticalCoordinate:_n,getCoordinateString:ol,getVerticalCoordinateString:Tn,collections:{},newObject:$t,newAdditionalObject:Ea,newObjectDeferred:Wt,newObjectDeferredBegin:Ar,getFilters:un,putStream:Tr,events:gt,scaleFactor:Te,pageSize:{getWidth:function(){return ha(B)},setWidth:function(f){Fs(B,f)},getHeight:function(){return On(B)},setHeight:function(f){Is(B,f)}},encryptionOptions:g,encryption:or,getEncryptor:el,output:qa,getNumberOfPages:Jo,pages:_e,out:te,f2:J,f3:A,getPageInfo:Li,getPageInfoByObjId:Je,getCurrentPageInfo:tl,getPDFVersion:N,Point:Wa,Rectangle:Cs,Matrix:We,hasHotfix:ki},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return ha(B)},set:function(f){Fs(B,f)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return On(B)},set:function(f){Is(B,f)},enumerable:!0,configurable:!0}),Yo.call(m,Le),st="F1",ji(s,r),gt.publish("initialized"),m}ds.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},ds.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ds.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},ds.prototype.processOwnerPassword=function(e,t){return ac(nc(t).substr(0,5),e)},ds.prototype.encryptor=function(e,t){var r=nc(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return ac(r,a)}},ci.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||vt(e)!==vt(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},Ue.API={events:[]},Ue.version="2.5.2";var Dt=Ue.API,yc=1,Pa=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},is=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ze=function(e){return e.toFixed(2)},Jn=function(e){return e.toFixed(5)};Dt.__acroform__={};var Lr=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},md=function(e){return e*yc},xn=function(e){var t=new fu,r=Be.internal.getHeight(e)||0,a=Be.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ze(a)),Number(Ze(r))],t},A0=Dt.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},P0=Dt.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},C0=Dt.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},zt=Dt.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return C0(e,t-1)},Ut=Dt.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return A0(e,t-1)},Ht=Dt.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return P0(e,t-1)},E0=Dt.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,s=e[0],i=e[1],o=e[2],c=e[3],d={};return d.lowerLeft_X=r(s)||0,d.lowerLeft_Y=a(i+c)||0,d.upperRight_X=r(s+o)||0,d.upperRight_Y=a(i)||0,[Number(Ze(d.lowerLeft_X)),Number(Ze(d.lowerLeft_Y)),Number(Ze(d.upperRight_X)),Number(Ze(d.upperRight_Y))]},F0=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=sc(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+Ze(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=xn(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},sc=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(A){return A.split(`
`)}):s.map(function(A){return[A]});var i=r,o=Be.internal.getHeight(e)||0;o=o<0?-o:o;var c=Be.internal.getWidth(e)||0;c=c<0?-c:c;var d=function(A,_,q){if(A+1<s.length){var H=_+" "+s[A+1][0];return lo(H,e,q).width<=c-4}return!1};i++;e:for(;i>0;){t="",i--;var h,g,x=lo("3",e,i).height,y=e.multiline?o-i:(o-x)/2,m=y+=2,v=0,N=0,L=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+lo(t,e,i=12).width+", FieldWidth:"+c+`
`;break}for(var w="",j=0,S=0;S<s.length;S++)if(s.hasOwnProperty(S)){var I=!1;if(s[S].length!==1&&L!==s[S].length-1){if((x+2)*(j+2)+2>o)continue e;w+=s[S][L],I=!0,N=S,S--}else{w=(w+=s[S][L]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var R=parseInt(S),K=d(R,w,i),O=S>=s.length-1;if(K&&!O){w+=" ",L=0;continue}if(K||O){if(O)N=R;else if(e.multiline&&(x+2)*(j+2)+2>o)continue e}else{if(!e.multiline||(x+2)*(j+2)+2>o)continue e;N=R}}for(var M="",G=v;G<=N;G++){var J=s[G];if(e.multiline){if(G===N){M+=J[L]+" ",L=(L+1)%J.length;continue}if(G===v){M+=J[J.length-1]+" ";continue}}M+=J[0]+" "}switch(M=M.substr(M.length-1)==" "?M.substr(0,M.length-1):M,g=lo(M,e,i).width,e.textAlign){case"right":h=c-g-2;break;case"center":h=(c-g)/2;break;case"left":default:h=2}t+=Ze(h)+" "+Ze(m)+` Td
`,t+="("+Pa(M)+`) Tj
`,t+=-Ze(h)+` 0 Td
`,m=-(i+2),g=0,v=I?N:N+1,j++,w=""}break}return a.text=t,a.fontSize=i,a},lo=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},I0={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},M0=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},T0=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,s=e[r];t.internal.newObjectDeferredBegin(s.objId,!0),vt(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete e[a]}},O0=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(nn.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(I0)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");yc=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new mu,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in a)if(a.hasOwnProperty(s)){var i=a[s];i.objId=void 0,i.hasAnnotation&&M0(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,s){var i=!a;for(var o in a||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var c=a[o],d=[],h=c.Rect;if(c.Rect&&(c.Rect=E0(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=Be.createDefaultAppearanceStream(c),vt(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(d=c.getKeyValueListForStream()),c.Rect=h,c.hasAppearanceStream&&!c.appearanceStreamContent){var g=F0(c);d.push({key:"AP",value:"<</N "+g+">>"}),s.internal.acroformPlugin.xForms.push(g)}if(c.appearanceStreamContent){var x="";for(var y in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(y)){var m=c.appearanceStreamContent[y];if(x+="/"+y+" ",x+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var v=m[o];typeof v=="function"&&(v=v.call(s,c)),x+="/"+o+" "+v+" ",s.internal.acroformPlugin.xForms.indexOf(v)>=0||s.internal.acroformPlugin.xForms.push(v)}}else typeof(v=m)=="function"&&(v=v.call(s,c)),x+="/"+o+" "+v,s.internal.acroformPlugin.xForms.indexOf(v)>=0||s.internal.acroformPlugin.xForms.push(v);x+=">>"}d.push({key:"AP",value:`<<
`+x+">>"})}s.internal.putStream({additionalKeyValues:d,objectId:c.objId}),s.internal.out("endobj")}i&&T0(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},hu=Dt.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),vt(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),s+="("+Pa(a(e[i].toString()))+")"):s+=e[i].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Dl=function(e,t,r){var a=function(s){return s};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Pa(a(e))+")"},yn=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};yn.prototype.toString=function(){return this.objId+" 0 R"},yn.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},yn.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],s=this[a];s&&(Array.isArray(s)?e.push({key:a,value:hu(s,this.objId,this.scope)}):s instanceof yn?(s.scope=this.scope,e.push({key:a,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:a,value:s}))}return e};var fu=function(){yn.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Lr(fu,yn);var mu=function(){yn.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Pa(r(e))+")"}},set:function(r){e=r}})};Lr(mu,yn);var nn=function e(){yn.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');t=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!zt(t,3)},set:function(w){w?this.F=Ut(t,3):this.F=Ht(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');r=w}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(w){a=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(w){a[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(w){a[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(w){a[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(w){a[3]=w}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof po)return;i="FieldObject"+e.FieldNum++}var w=function(j){return j};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Pa(w(i))+")"},set:function(w){i=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(w){i=w}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(w){c=w}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(w){d=w}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/yc:h},set:function(w){h=w}});var g="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return g},set:function(w){g=w}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof po||this instanceof ea))return Dl(x,this.objId,this.scope)},set:function(w){w=w.toString(),x=w}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Kt?y:Dl(y,this.objId,this.scope)},set:function(w){w=w.toString(),y=this instanceof Kt?w:w.substr(0,1)==="("?is(w.substr(1,w.length-2)):is(w)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Kt?is(y.substr(1,y.length-1)):y},set:function(w){w=w.toString(),y=this instanceof Kt?"/"+w:w}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Kt?m:Dl(m,this.objId,this.scope)},set:function(w){w=w.toString(),m=this instanceof Kt?w:w.substr(0,1)==="("?is(w.substr(1,w.length-2)):is(w)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Kt?is(m.substr(1,m.length-1)):m},set:function(w){w=w.toString(),m=this instanceof Kt?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,N=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return N},set:function(w){w=!!w,N=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(w){v=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,1)},set:function(w){w?this.Ff=Ut(this.Ff,1):this.Ff=Ht(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,2)},set:function(w){w?this.Ff=Ut(this.Ff,2):this.Ff=Ht(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,3)},set:function(w){w?this.Ff=Ut(this.Ff,3):this.Ff=Ht(this.Ff,3)}});var L=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(L!==null)return L},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');L=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(L){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:L=2;break;case"center":case 1:L=1;break;case"left":case 0:default:L=0}}})};Lr(nn,yn);var Na=function(){nn.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return hu(t,this.objId,this.scope)},set:function(r){var a,s;s=[],typeof(a=r)=="string"&&(s=function(i,o,c){c||(c=1);for(var d,h=[];d=o.exec(i);)h.push(d[c]);return h}(a,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,18)},set:function(r){r?this.Ff=Ut(this.Ff,18):this.Ff=Ht(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ut(this.Ff,19):this.Ff=Ht(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,20)},set:function(r){r?(this.Ff=Ut(this.Ff,20),t.sort()):this.Ff=Ht(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,22)},set:function(r){r?this.Ff=Ut(this.Ff,22):this.Ff=Ht(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,23)},set:function(r){r?this.Ff=Ut(this.Ff,23):this.Ff=Ht(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,27)},set:function(r){r?this.Ff=Ut(this.Ff,27):this.Ff=Ht(this.Ff,27)}}),this.hasAppearanceStream=!1};Lr(Na,nn);var ja=function(){Na.call(this),this.fontName="helvetica",this.combo=!1};Lr(ja,Na);var Sa=function(){ja.call(this),this.combo=!0};Lr(Sa,ja);var ri=function(){Sa.call(this),this.edit=!0};Lr(ri,Sa);var Kt=function(){nn.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,15)},set:function(r){r?this.Ff=Ut(this.Ff,15):this.Ff=Ht(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,16)},set:function(r){r?this.Ff=Ut(this.Ff,16):this.Ff=Ht(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,17)},set:function(r){r?this.Ff=Ut(this.Ff,17):this.Ff=Ht(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,26)},set:function(r){r?this.Ff=Ut(this.Ff,26):this.Ff=Ht(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,s=[];for(a in s.push("<<"),t)s.push("/"+a+" ("+Pa(r(t[a]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){vt(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Lr(Kt,nn);var ni=function(){Kt.call(this),this.pushButton=!0};Lr(ni,Kt);var _a=function(){Kt.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Lr(_a,Kt);var po=function(){var e,t;nn.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),a)o.push("/"+i+" ("+Pa(s(a[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){vt(s)==="object"&&(a=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(s){typeof s=="string"&&(a.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Be.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Lr(po,nn),_a.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},_a.prototype.createOption=function(e){var t=new po;return t.Parent=this,t.optionName=e,this.Kids.push(t),D0.call(this.scope,t),t};var ai=function(){Kt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Be.CheckBox.createAppearanceStream()};Lr(ai,Kt);var ea=function(){nn.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,13)},set:function(t){t?this.Ff=Ut(this.Ff,13):this.Ff=Ht(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,21)},set:function(t){t?this.Ff=Ut(this.Ff,21):this.Ff=Ht(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,23)},set:function(t){t?this.Ff=Ut(this.Ff,23):this.Ff=Ht(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,24)},set:function(t){t?this.Ff=Ut(this.Ff,24):this.Ff=Ht(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,25)},set:function(t){t?this.Ff=Ut(this.Ff,25):this.Ff=Ht(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,26)},set:function(t){t?this.Ff=Ut(this.Ff,26):this.Ff=Ht(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Lr(ea,nn);var si=function(){ea.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!zt(this.Ff,14)},set:function(e){e?this.Ff=Ut(this.Ff,14):this.Ff=Ht(this.Ff,14)}}),this.password=!0};Lr(si,ea);var Be={CheckBox:{createAppearanceStream:function(){return{N:{On:Be.CheckBox.YesNormal},D:{On:Be.CheckBox.YesPushDown,Off:Be.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=xn(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=sc(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ze(Be.internal.getWidth(e))+" "+Ze(Be.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Ze(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=xn(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=[],i=Be.internal.getHeight(e),o=Be.internal.getWidth(e),c=sc(e,e.caption);return s.push("1 g"),s.push("0 0 "+Ze(o)+" "+Ze(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Ze(o-1)+" "+Ze(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Ze(c.fontSize)+" Tf "+a),s.push(c.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=xn(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ze(Be.internal.getWidth(e))+" "+Ze(Be.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Be.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Be.RadioButton.Circle.YesNormal,t.D[e]=Be.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=xn(e);t.scope=e.scope;var r=[],a=Be.internal.getWidth(e)<=Be.internal.getHeight(e)?Be.internal.getWidth(e)/4:Be.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Be.internal.Bezier_C,i=Number((a*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Jn(Be.internal.getWidth(e)/2)+" "+Jn(Be.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=xn(e);t.scope=e.scope;var r=[],a=Be.internal.getWidth(e)<=Be.internal.getHeight(e)?Be.internal.getWidth(e)/4:Be.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Be.internal.Bezier_C).toFixed(5)),o=Number((a*Be.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Jn(Be.internal.getWidth(e)/2)+" "+Jn(Be.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Jn(Be.internal.getWidth(e)/2)+" "+Jn(Be.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=xn(e);t.scope=e.scope;var r=[],a=Be.internal.getWidth(e)<=Be.internal.getHeight(e)?Be.internal.getWidth(e)/4:Be.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Be.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Jn(Be.internal.getWidth(e)/2)+" "+Jn(Be.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Be.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Be.RadioButton.Cross.YesNormal,t.D[e]=Be.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=xn(e);t.scope=e.scope;var r=[],a=Be.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ze(Be.internal.getWidth(e)-2)+" "+Ze(Be.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ze(a.x1.x)+" "+Ze(a.x1.y)+" m"),r.push(Ze(a.x2.x)+" "+Ze(a.x2.y)+" l"),r.push(Ze(a.x4.x)+" "+Ze(a.x4.y)+" m"),r.push(Ze(a.x3.x)+" "+Ze(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=xn(e);t.scope=e.scope;var r=Be.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Ze(Be.internal.getWidth(e))+" "+Ze(Be.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Ze(Be.internal.getWidth(e)-2)+" "+Ze(Be.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Ze(r.x1.x)+" "+Ze(r.x1.y)+" m"),a.push(Ze(r.x2.x)+" "+Ze(r.x2.y)+" l"),a.push(Ze(r.x4.x)+" "+Ze(r.x4.y)+" m"),a.push(Ze(r.x3.x)+" "+Ze(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=xn(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ze(Be.internal.getWidth(e))+" "+Ze(Be.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Be.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Be.internal.getWidth(e),r=Be.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Be.internal.getWidth=function(e){var t=0;return vt(e)==="object"&&(t=md(e.Rect[2])),t},Be.internal.getHeight=function(e){var t=0;return vt(e)==="object"&&(t=md(e.Rect[3])),t};var D0=Dt.addField=function(e){if(O0(this,e),!(e instanceof nn))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Dt.AcroFormChoiceField=Na,Dt.AcroFormListBox=ja,Dt.AcroFormComboBox=Sa,Dt.AcroFormEditBox=ri,Dt.AcroFormButton=Kt,Dt.AcroFormPushButton=ni,Dt.AcroFormRadioButton=_a,Dt.AcroFormCheckBox=ai,Dt.AcroFormTextField=ea,Dt.AcroFormPasswordField=si,Dt.AcroFormAppearance=Be,Dt.AcroForm={ChoiceField:Na,ListBox:ja,ComboBox:Sa,EditBox:ri,Button:Kt,PushButton:ni,RadioButton:_a,CheckBox:ai,TextField:ea,PasswordField:si,Appearance:Be},Ue.AcroForm={ChoiceField:Na,ListBox:ja,ComboBox:Sa,EditBox:ri,Button:Kt,PushButton:ni,RadioButton:_a,CheckBox:ai,TextField:ea,PasswordField:si,Appearance:Be};var B0=Ue.AcroForm;function gu(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(A,_){var q,H,le,Y,V,Z=t;if((_=_||t)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(K(A))for(V in r)for(le=r[V],q=0;q<le.length;q+=1){for(Y=!0,H=0;H<le[q].length;H+=1)if(le[q][H]!==void 0&&le[q][H]!==A[H]){Y=!1;break}if(Y===!0){Z=V;break}}else for(V in r)for(le=r[V],q=0;q<le.length;q+=1){for(Y=!0,H=0;H<le[q].length;H+=1)if(le[q][H]!==void 0&&le[q][H]!==A.charCodeAt(H)){Y=!1;break}if(Y===!0){Z=V;break}}return Z===t&&_!==t&&(Z=_),Z},s=function A(_){for(var q=this.internal.write,H=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);_.objectId=this.internal.newObject();var Y=[];if(Y.push({key:"Type",value:"/XObject"}),Y.push({key:"Subtype",value:"/Image"}),Y.push({key:"Width",value:_.width}),Y.push({key:"Height",value:_.height}),_.colorSpace===L.INDEXED?Y.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(_.palette.length/3-1)+" "+("sMask"in _&&_.sMask!==void 0?_.objectId+2:_.objectId+1)+" 0 R]"}):(Y.push({key:"ColorSpace",value:"/"+_.colorSpace}),_.colorSpace===L.DEVICE_CMYK&&Y.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Y.push({key:"BitsPerComponent",value:_.bitsPerComponent}),"decodeParameters"in _&&_.decodeParameters!==void 0&&Y.push({key:"DecodeParms",value:"<<"+_.decodeParameters+">>"}),"transparency"in _&&Array.isArray(_.transparency)){for(var V="",Z=0,Q=_.transparency.length;Z<Q;Z++)V+=_.transparency[Z]+" "+_.transparency[Z]+" ";Y.push({key:"Mask",value:"["+V+"]"})}_.sMask!==void 0&&Y.push({key:"SMask",value:_.objectId+1+" 0 R"});var ie=_.filter!==void 0?["/"+_.filter]:void 0;if(H({data:_.data,additionalKeyValues:Y,alreadyAppliedFilters:ie,objectId:_.objectId}),q("endobj"),"sMask"in _&&_.sMask!==void 0){var ge="/Predictor "+_.predictor+" /Colors 1 /BitsPerComponent "+_.bitsPerComponent+" /Columns "+_.width,k={width:_.width,height:_.height,colorSpace:"DeviceGray",bitsPerComponent:_.bitsPerComponent,decodeParameters:ge,data:_.sMask};"filter"in _&&(k.filter=_.filter),A.call(this,k)}if(_.colorSpace===L.INDEXED){var B=this.internal.newObject();H({data:M(new Uint8Array(_.palette)),objectId:B}),q("endobj")}},i=function(){var A=this.internal.collections.addImage_images;for(var _ in A)s.call(this,A[_])},o=function(){var A,_=this.internal.collections.addImage_images,q=this.internal.write;for(var H in _)q("/I"+(A=_[H]).index,A.objectId,"0","R")},c=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},d=function(){var A=this.internal.collections.addImage_images;return c.call(this),A},h=function(){return Object.keys(this.internal.collections.addImage_images).length},g=function(A){return typeof e["process"+A.toUpperCase()]=="function"},x=function(A){return vt(A)==="object"&&A.nodeType===1},y=function(A,_){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var q=""+A.getAttribute("src");if(q.indexOf("data:image/")===0)return ti(unescape(q).split("base64,").pop());var H=e.loadFile(q,!0);if(H!==void 0)return H}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var le;switch(_){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;case"JPEG":case"JPG":default:le="image/jpeg"}return ti(A.toDataURL(le,1).split("base64,").pop())}},m=function(A){var _=this.internal.collections.addImage_images;if(_){for(var q in _)if(A===_[q].alias)return _[q]}},v=function(A,_,q){return A||_||(A=-96,_=-96),A<0&&(A=-1*q.width*72/A/this.internal.scaleFactor),_<0&&(_=-1*q.height*72/_/this.internal.scaleFactor),A===0&&(A=_*q.width/q.height),_===0&&(_=A*q.height/q.width),[A,_]},N=function(A,_,q,H,le,Y){var V=v.call(this,q,H,le),Z=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,ie=d.call(this);if(q=V[0],H=V[1],ie[le.index]=le,Y){Y*=Math.PI/180;var ge=Math.cos(Y),k=Math.sin(Y),B=function(X){return X.toFixed(4)},U=[B(ge),B(k),B(-1*k),B(ge),0,0,"cm"]}this.internal.write("q"),Y?(this.internal.write([1,"0","0",1,Z(A),Q(_+H),"cm"].join(" ")),this.internal.write(U.join(" ")),this.internal.write([Z(q),"0","0",Z(H),"0","0","cm"].join(" "))):this.internal.write([Z(q),"0","0",Z(H),Z(A),Q(_+H),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},L=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},j=e.__addimage__.sHashCode=function(A){var _,q,H=0;if(typeof A=="string")for(q=A.length,_=0;_<q;_++)H=(H<<5)-H+A.charCodeAt(_),H|=0;else if(K(A))for(q=A.byteLength/2,_=0;_<q;_++)H=(H<<5)-H+A[_],H|=0;return H},S=e.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var _=!0;return A.length===0&&(_=!1),A.length%4!=0&&(_=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(_=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(_=!1),_},I=e.__addimage__.extractImageFromDataUrl=function(A){var _=(A=A||"").split("base64,"),q=null;if(_.length===2){var H=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(_[0]);Array.isArray(H)&&(q={mimeType:H[1],charset:H[2],data:_[1]})}return q},R=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(A){return R()&&A instanceof ArrayBuffer};var K=e.__addimage__.isArrayBufferView=function(A){return R()&&typeof Uint32Array<"u"&&(A instanceof Int8Array||A instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array)},O=e.__addimage__.binaryStringToUint8Array=function(A){for(var _=A.length,q=new Uint8Array(_),H=0;H<_;H++)q[H]=A.charCodeAt(H);return q},M=e.__addimage__.arrayBufferToBinaryString=function(A){for(var _="",q=K(A)?A:new Uint8Array(A),H=0;H<q.length;H+=8192)_+=String.fromCharCode.apply(null,q.subarray(H,H+8192));return _};e.addImage=function(){var A,_,q,H,le,Y,V,Z,Q;if(typeof arguments[1]=="number"?(_=t,q=arguments[1],H=arguments[2],le=arguments[3],Y=arguments[4],V=arguments[5],Z=arguments[6],Q=arguments[7]):(_=arguments[1],q=arguments[2],H=arguments[3],le=arguments[4],Y=arguments[5],V=arguments[6],Z=arguments[7],Q=arguments[8]),vt(A=arguments[0])==="object"&&!x(A)&&"imageData"in A){var ie=A;A=ie.imageData,_=ie.format||_||t,q=ie.x||q||0,H=ie.y||H||0,le=ie.w||ie.width||le,Y=ie.h||ie.height||Y,V=ie.alias||V,Z=ie.compression||Z,Q=ie.rotation||ie.angle||Q}var ge=this.internal.getFilters();if(Z===void 0&&ge.indexOf("FlateEncode")!==-1&&(Z="SLOW"),isNaN(q)||isNaN(H))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var k=G.call(this,A,_,V,Z);return N.call(this,q,H,le,Y,k,Q),this};var G=function(A,_,q,H){var le,Y,V;if(typeof A=="string"&&a(A)===t){A=unescape(A);var Z=J(A,!1);(Z!==""||(Z=e.loadFile(A,!0))!==void 0)&&(A=Z)}if(x(A)&&(A=y(A,_)),_=a(A,_),!g(_))throw new Error("addImage does not support files of type '"+_+"', please ensure that a plugin for '"+_+"' support is added.");if(((V=q)==null||V.length===0)&&(q=function(Q){return typeof Q=="string"||K(Q)?j(Q):K(Q.data)?j(Q.data):null}(A)),(le=m.call(this,q))||(R()&&(A instanceof Uint8Array||_==="RGBA"||(Y=A,A=O(A))),le=this["process"+_.toUpperCase()](A,h.call(this),q,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in e.image_compression?Q:w.NONE}(H),Y)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},J=e.__addimage__.convertBase64ToBinaryString=function(A,_){var q;_=typeof _!="boolean"||_;var H,le="";if(typeof A=="string"){H=(q=I(A))!==null?q.data:A;try{le=ti(H)}catch(Y){if(_)throw S(H)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Y.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return le};e.getImageProperties=function(A){var _,q,H="";if(x(A)&&(A=y(A)),typeof A=="string"&&a(A)===t&&((H=J(A,!1))===""&&(H=e.loadFile(A)||""),A=H),q=a(A),!g(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(!R()||A instanceof Uint8Array||(A=O(A)),!(_=this["process"+q.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return _.fileType=q,_}})(Ue.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ue.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,s,i,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,g=!1,x=0;x<h.length&&!g;x++)switch((a=h[x]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(g=!0);break;case"reference":case"text":case"freetext":g=!0}if(g!=0){this.internal.write("/Annots [");for(var y=0;y<h.length;y++){a=h[y];var m=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var N=this.internal.newAdditionalObject(),L=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(N.objId),j=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+m(w(a.contents))+")",i+=" /Popup "+L.objId+" 0 R",i+=" /P "+d.objId+" 0 R",i+=" /T ("+m(w(j))+") >>",N.content=i;var S=N.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+S,a.open&&(i+=" /Open true"),i+=" >>",L.content=i,this.internal.write(N.objId,"0 R",L.objId,"0 R");break;case"freetext":s="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var I=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(v(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+I+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var R=this.annotations._nameMap[a.options.name];a.options.pageNumber=R.page,a.options.top=R.y}else a.options.top||(a.options.top=0);if(s="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(v(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var K=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+K+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,s,i,o){var c=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:d(r),y:h(a),w:d(r+s),h:h(a+i)},options:o,type:"link"})},e.textWithLink=function(r,a,s,i){var o,c,d=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){c=i.maxWidth;var g=this.splitTextToSize(r,c).length;o=Math.ceil(h*g)}else c=d,o=h;return this.text(r,a,s,i),s+=.2*h,i.align==="center"&&(a-=d/2),i.align==="right"&&(a-=d),this.link(a,s-h,c,o,i),d},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(Ue.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(N){return t[N.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(N){return typeof N=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(N)},c=e.__arabicParser__.isArabicEndLetter=function(N){return o(N)&&i(N)&&t[N.charCodeAt(0)].length<=2},d=e.__arabicParser__.isArabicAlfLetter=function(N){return o(N)&&s.indexOf(N.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(N){return o(N)&&i(N)&&t[N.charCodeAt(0)].length>=1};var h=e.__arabicParser__.arabicLetterHasFinalForm=function(N){return o(N)&&i(N)&&t[N.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(N){return o(N)&&i(N)&&t[N.charCodeAt(0)].length>=3};var g=e.__arabicParser__.arabicLetterHasMedialForm=function(N){return o(N)&&i(N)&&t[N.charCodeAt(0)].length==4},x=e.__arabicParser__.resolveLigatures=function(N){var L=0,w=r,j="",S=0;for(L=0;L<N.length;L+=1)w[N.charCodeAt(L)]!==void 0?(S++,typeof(w=w[N.charCodeAt(L)])=="number"&&(j+=String.fromCharCode(w),w=r,S=0),L===N.length-1&&(w=r,j+=N.charAt(L-(S-1)),L-=S-1,S=0)):(w=r,j+=N.charAt(L-S),L-=S,S=0);return j};e.__arabicParser__.isArabicDiacritic=function(N){return N!==void 0&&a[N.charCodeAt(0)]!==void 0};var y=e.__arabicParser__.getCorrectForm=function(N,L,w){return o(N)?i(N)===!1?-1:!h(N)||!o(L)&&!o(w)||!o(w)&&c(L)||c(N)&&!o(L)||c(N)&&d(L)||c(N)&&c(L)?0:g(N)&&o(L)&&!c(L)&&o(w)&&h(w)?3:c(N)||!o(w)?1:2:-1},m=function(N){var L=0,w=0,j=0,S="",I="",R="",K=(N=N||"").split("\\s+"),O=[];for(L=0;L<K.length;L+=1){for(O.push(""),w=0;w<K[L].length;w+=1)S=K[L][w],I=K[L][w-1],R=K[L][w+1],o(S)?(j=y(S,I,R),O[L]+=j!==-1?String.fromCharCode(t[S.charCodeAt(0)][j]):S):O[L]+=S;O[L]=x(O[L])}return O.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var N,L=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(L)){var j=0;for(w=[],j=0;j<L.length;j+=1)Array.isArray(L[j])?w.push([m(L[j][0]),L[j][1],L[j][2]]):w.push([m(L[j])]);N=w}else N=m(L);return typeof arguments[0]=="string"?N:(arguments[0].text=N,arguments[0])};e.events.push(["preProcessText",v])}(Ue.API),Ue.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(c){i=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var s;if((r=r||"2d")!=="2d")return null;for(s in a)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=a[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ue.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(N){d=N}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(N){h=N}});var g=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return g},set:function(N){g=N}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function(N){x=N}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(N){y=N}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(N){m=N}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(N){v=N}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(d){return a.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},e.getTextDimensions=function(d,h){a.call(this);var g=(h=h||{}).fontSize||this.getFontSize(),x=h.font||this.getFont(),y=h.scaleFactor||this.internal.scaleFactor,m=0,v=0,N=0,L=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var w=h.maxWidth;w>0?typeof d=="string"?d=this.splitTextToSize(d,w):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(S,I){return S.concat(L.splitTextToSize(I,w))},[])):d=Array.isArray(d)?d:[d];for(var j=0;j<d.length;j++)m<(N=this.getStringUnitWidth(d[j],{font:x})*g)&&(m=N);return m!==0&&(v=d.length),{w:m/=y,h:Math.max((v*g*this.getLineHeightFactor()-g*(this.getLineHeightFactor()-1))/y,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var d=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var d;d=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var h=this.internal.__cell__.lastCell,g=this.internal.__cell__.padding,x=this.internal.__cell__.margins||t,y=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===d.lineNumber?(d.x=(h.x||0)+(h.width||0),d.y=h.y||0):h.y+h.height+d.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=x.top,m&&y&&(this.printHeaderRow(d.lineNumber,!0),d.y+=y[0].height)):d.y=h.y+h.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,r===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-g,d.y+g,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+g,{align:"center",baseline:"top",maxWidth:d.width-g-g}):this.text(d.text,d.x+g,d.y+g,{align:"left",baseline:"top",maxWidth:d.width-g-g})),this.internal.__cell__.lastCell=d,this};e.table=function(d,h,g,x,y){if(a.call(this),!g)throw new Error("No data for PDF table.");var m,v,N,L,w=[],j=[],S=[],I={},R={},K=[],O=[],M=(y=y||{}).autoSize||!1,G=y.printHeaders!==!1,J=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,A=y.margins||Object.assign({width:this.getPageWidth()},t),_=typeof y.padding=="number"?y.padding:3,q=y.headerBackgroundColor||"#c8c8c8",H=y.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=_,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=H,this.setFontSize(J),x==null)j=w=Object.keys(g[0]),S=w.map(function(){return"left"});else if(Array.isArray(x)&&vt(x[0])==="object")for(w=x.map(function(ie){return ie.name}),j=x.map(function(ie){return ie.prompt||ie.name||""}),S=x.map(function(ie){return ie.align||"left"}),m=0;m<x.length;m+=1)R[x[m].name]=x[m].width*(19.049976/25.4);else Array.isArray(x)&&typeof x[0]=="string"&&(j=w=x,S=w.map(function(){return"left"}));if(M||Array.isArray(x)&&typeof x[0]=="string")for(m=0;m<w.length;m+=1){for(I[L=w[m]]=g.map(function(ie){return ie[L]}),this.setFont(void 0,"bold"),K.push(this.getTextDimensions(j[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=I[L],this.setFont(void 0,"normal"),N=0;N<v.length;N+=1)K.push(this.getTextDimensions(v[N],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);R[L]=Math.max.apply(null,K)+_+_,K=[]}if(G){var le={};for(m=0;m<w.length;m+=1)le[w[m]]={},le[w[m]].text=j[m],le[w[m]].align=S[m];var Y=c.call(this,le,R);O=w.map(function(ie){return new i(d,h,R[ie],Y,le[ie].text,void 0,le[ie].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var V=x.reduce(function(ie,ge){return ie[ge.name]=ge.align,ie},{});for(m=0;m<g.length;m+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:m,data:g[m]},this);var Z=c.call(this,g[m],R);for(N=0;N<w.length;N+=1){var Q=g[m][w[N]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:m,col:N,data:Q},this),o.call(this,new i(d,h,R[w[N]],Z,Q,m+2,V[w[N]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=h,this};var c=function(d,h){var g=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(d).map(function(m){var v=d[m];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,h[m]-g-g)},this).map(function(m){return this.getLineHeightFactor()*m.length*x/y+g+g},this).reduce(function(m,v){return Math.max(m,v)},0)};e.setTableHeaderRow=function(d){a.call(this),this.internal.__cell__.tableHeaderRow=d},e.printHeaderRow=function(d,h){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var g;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){g=this.internal.__cell__.tableHeaderRow[m].clone(),h&&(g.y=this.internal.__cell__.margins.top||0,y.push(g)),g.lineNumber=d;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,g),this.setTextColor(v)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),r=!1}}(Ue.API);var pu={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},xu=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],ic=gu(xu),yu=[100,200,300,400,500,600,700,800,900],R0=gu(yu);function oc(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return pu[i=i||"normal"]?i:"normal"}(e.style),a=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),s=function(i){return typeof ic[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,a].join(" ")}}}function gd(e,t,r,a){var s;for(s=r;s>=0&&s<t.length;s+=a)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=a)if(e[t[s]])return e[t[s]]}var q0={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},pd={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function xd(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function z0(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},q0,r.genericFontFamilies||{}),i=null,o=null,c=0;c<t.length;++c)if(s[(i=oc(t[c])).family]&&(i.family=s[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[a]))throw new Error("Could not find a font-family for the rule '"+xd(i)+"' and default family '"+a+"'.");if(o=function(d,h){if(h[d])return h[d];var g=ic[d],x=g<=ic.normal?-1:1,y=gd(h,xu,g,x);if(!y)throw new Error("Could not find a matching font-stretch value for "+d);return y}(i.stretch,o),o=function(d,h){if(h[d])return h[d];for(var g=pu[d],x=0;x<g.length;++x)if(h[g[x]])return h[g[x]];throw new Error("Could not find a matching font-style for "+d)}(i.style,o),!(o=function(d,h){if(h[d])return h[d];if(d===400&&h[500])return h[500];if(d===500&&h[400])return h[400];var g=R0[d],x=gd(h,yu,g,d<400?-1:1);if(!x)throw new Error("Could not find a matching font-weight for value "+d);return x}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+xd(i)+"'.");return o}function yd(e){return e.trimLeft()}function U0(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function H0(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var co,vd,bd,Bl=["times"];(function(e){var t,r,a,s,i,o,c,d,h,g=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new d,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new o,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new o,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new x(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,d=this.internal.Matrix,h=new g}]);var x=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var B=k;Object.defineProperty(this,"pdf",{get:function(){return B}});var U=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return U},set:function(ye){U=!!ye}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(ye){X=!!ye}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(ye){isNaN(ye)||(ee=ye)}});var de=0;Object.defineProperty(this,"posY",{get:function(){return de},set:function(ye){isNaN(ye)||(de=ye)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(ye){var te;typeof ye=="number"?te=[ye,ye,ye,ye]:((te=new Array(4))[0]=ye[0],te[1]=ye.length>=2?ye[1]:te[0],te[2]=ye.length>=3?ye[2]:te[0],te[3]=ye.length>=4?ye[3]:te[1]),h.margin=te}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(ye){ue=ye}});var me=0;Object.defineProperty(this,"lastBreak",{get:function(){return me},set:function(ye){me=ye}});var ke=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ke},set:function(ye){ke=ye}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(ye){ye instanceof g&&(h=ye)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(ye){h.path=ye}});var _e=[];Object.defineProperty(this,"ctxStack",{get:function(){return _e},set:function(ye){_e=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var te;te=y(ye),this.ctx.fillStyle=te.style,this.ctx.isFillTransparent=te.a===0,this.ctx.fillOpacity=te.a,this.pdf.setFillColor(te.r,te.g,te.b,{a:te.a}),this.pdf.setTextColor(te.r,te.g,te.b,{a:te.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var te=y(ye);this.ctx.strokeStyle=te.style,this.ctx.isStrokeTransparent=te.a===0,this.ctx.strokeOpacity=te.a,te.a===0?this.pdf.setDrawColor(255,255,255):(te.a,this.pdf.setDrawColor(te.r,te.g,te.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var Ce=null;function Ee(ye,te){if(Ce===null){var et=function(Re){var Le=[];return Object.keys(Re).forEach(function(Ae){Re[Ae].forEach(function(Me){var Ie=null;switch(Me){case"bold":Ie={family:Ae,weight:"bold"};break;case"italic":Ie={family:Ae,style:"italic"};break;case"bolditalic":Ie={family:Ae,weight:"bold",style:"italic"};break;case"":case"normal":Ie={family:Ae}}Ie!==null&&(Ie.ref={name:Ae,style:Me},Le.push(Ie))})}),Le}(ye.getFontList());Ce=function(Re){for(var Le={},Ae=0;Ae<Re.length;++Ae){var Me=oc(Re[Ae]),Ie=Me.family,qe=Me.stretch,Ke=Me.style,nt=Me.weight;Le[Ie]=Le[Ie]||{},Le[Ie][qe]=Le[Ie][qe]||{},Le[Ie][qe][Ke]=Le[Ie][qe][Ke]||{},Le[Ie][qe][Ke][nt]=Me}return Le}(et.concat(te))}return Ce}var Ve=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ve},set:function(ye){Ce=null,Ve=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var te;if(this.ctx.font=ye,(te=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var et=te[1],Re=(te[2],te[3]),Le=te[4],Ae=(te[5],te[6]),Me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Le)[2];Le=Math.floor(Me==="px"?parseFloat(Le)*this.pdf.internal.scaleFactor:Me==="em"?parseFloat(Le)*this.pdf.getFontSize():parseFloat(Le)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Le);var Ie=function(Ye){var st,Te,ir=[],ut=Ye.trim();if(ut==="")return Bl;if(ut in pd)return[pd[ut]];for(;ut!=="";){switch(Te=null,st=(ut=yd(ut)).charAt(0)){case'"':case"'":Te=U0(ut.substring(1),st);break;default:Te=H0(ut)}if(Te===null||(ir.push(Te[0]),(ut=yd(Te[1]))!==""&&ut.charAt(0)!==","))return Bl;ut=ut.replace(/^,/,"")}return ir}(Ae);if(this.fontFaces){var qe=z0(Ee(this.pdf,this.fontFaces),Ie.map(function(Ye){return{family:Ye,stretch:"normal",weight:Re,style:et}}));this.pdf.setFont(qe.ref.name,qe.ref.style)}else{var Ke="";(Re==="bold"||parseInt(Re,10)>=700||et==="bold")&&(Ke="bold"),et==="italic"&&(Ke+="italic"),Ke.length===0&&(Ke="normal");for(var nt="",at={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},lt=0;lt<Ie.length;lt++){if(this.pdf.internal.getFont(Ie[lt],Ke,{noFallback:!0,disableWarning:!0})!==void 0){nt=Ie[lt];break}if(Ke==="bolditalic"&&this.pdf.internal.getFont(Ie[lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)nt=Ie[lt],Ke="bold";else if(this.pdf.internal.getFont(Ie[lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){nt=Ie[lt],Ke="normal";break}}if(nt===""){for(var wt=0;wt<Ie.length;wt++)if(at[Ie[wt]]){nt=at[Ie[wt]];break}}nt=nt===""?"Times":nt,this.pdf.setFont(nt,Ke)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,ge.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,ge.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};x.prototype.setLineDash=function(k){this.lineDash=k},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){I.call(this,"fill",!1)},x.prototype.stroke=function(){I.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function(k,B){if(isNaN(k)||isNaN(B))throw _t.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var U=this.ctx.transform.applyToPoint(new o(k,B));this.path.push({type:"mt",x:U.x,y:U.y}),this.ctx.lastPoint=new o(k,B)},x.prototype.closePath=function(){var k=new o(0,0),B=0;for(B=this.path.length-1;B!==-1;B--)if(this.path[B].type==="begin"&&vt(this.path[B+1])==="object"&&typeof this.path[B+1].x=="number"){k=new o(this.path[B+1].x,this.path[B+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(k.x,k.y)},x.prototype.lineTo=function(k,B){if(isNaN(k)||isNaN(B))throw _t.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var U=this.ctx.transform.applyToPoint(new o(k,B));this.path.push({type:"lt",x:U.x,y:U.y}),this.ctx.lastPoint=new o(U.x,U.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),I.call(this,null,!0)},x.prototype.quadraticCurveTo=function(k,B,U,X){if(isNaN(U)||isNaN(X)||isNaN(k)||isNaN(B))throw _t.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new o(U,X)),de=this.ctx.transform.applyToPoint(new o(k,B));this.path.push({type:"qct",x1:de.x,y1:de.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new o(ee.x,ee.y)},x.prototype.bezierCurveTo=function(k,B,U,X,ee,de){if(isNaN(ee)||isNaN(de)||isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X))throw _t.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new o(ee,de)),me=this.ctx.transform.applyToPoint(new o(k,B)),ke=this.ctx.transform.applyToPoint(new o(U,X));this.path.push({type:"bct",x1:me.x,y1:me.y,x2:ke.x,y2:ke.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new o(ue.x,ue.y)},x.prototype.arc=function(k,B,U,X,ee,de){if(isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X)||isNaN(ee))throw _t.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(de=!!de,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new o(k,B));k=ue.x,B=ue.y;var me=this.ctx.transform.applyToPoint(new o(0,U)),ke=this.ctx.transform.applyToPoint(new o(0,0));U=Math.sqrt(Math.pow(me.x-ke.x,2)+Math.pow(me.y-ke.y,2))}Math.abs(ee-X)>=2*Math.PI&&(X=0,ee=2*Math.PI),this.path.push({type:"arc",x:k,y:B,radius:U,startAngle:X,endAngle:ee,counterclockwise:de})},x.prototype.arcTo=function(k,B,U,X,ee){throw new Error("arcTo not implemented.")},x.prototype.rect=function(k,B,U,X){if(isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X))throw _t.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,B),this.lineTo(k+U,B),this.lineTo(k+U,B+X),this.lineTo(k,B+X),this.lineTo(k,B),this.lineTo(k+U,B),this.lineTo(k,B)},x.prototype.fillRect=function(k,B,U,X){if(isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X))throw _t.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,B,U,X),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},x.prototype.strokeRect=function(k,B,U,X){if(isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X))throw _t.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(k,B,U,X),this.stroke())},x.prototype.clearRect=function(k,B,U,X){if(isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X))throw _t.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,B,U,X))},x.prototype.save=function(k){k=typeof k!="boolean"||k;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("q");if(this.pdf.setPage(B),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new g(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},x.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("Q");this.pdf.setPage(B),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(k){var B,U,X,ee;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))B=0,U=0,X=0,ee=0;else{var de=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(de!==null)B=parseInt(de[1]),U=parseInt(de[2]),X=parseInt(de[3]),ee=1;else if((de=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)B=parseInt(de[1]),U=parseInt(de[2]),X=parseInt(de[3]),ee=parseFloat(de[4]);else{if(ee=1,typeof k=="string"&&k.charAt(0)!=="#"){var ue=new cu(k);k=ue.ok?ue.toHex():"#000000"}k.length===4?(B=k.substring(1,2),B+=B,U=k.substring(2,3),U+=U,X=k.substring(3,4),X+=X):(B=k.substring(1,3),U=k.substring(3,5),X=k.substring(5,7)),B=parseInt(B,16),U=parseInt(U,16),X=parseInt(X,16)}}return{r:B,g:U,b:X,a:ee,style:k}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function(k,B,U,X){if(isNaN(B)||isNaN(U)||typeof k!="string")throw _t.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!m.call(this)){var ee=Z(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;_.call(this,{text:k,x:B,y:U,scale:de,angle:ee,align:this.textAlign,maxWidth:X})}},x.prototype.strokeText=function(k,B,U,X){if(isNaN(B)||isNaN(U)||typeof k!="string")throw _t.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){X=isNaN(X)?void 0:X;var ee=Z(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;_.call(this,{text:k,x:B,y:U,scale:de,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:X})}},x.prototype.measureText=function(k){if(typeof k!="string")throw _t.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var B=this.pdf,U=this.pdf.internal.scaleFactor,X=B.internal.getFontSize(),ee=B.getStringUnitWidth(k)*X/B.internal.scaleFactor,de=function(ue){var me=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this};return new de({width:ee*=Math.round(96*U/72*1e4)/1e4})},x.prototype.scale=function(k,B){if(isNaN(k)||isNaN(B))throw _t.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var U=new d(k,0,0,B,0,0);this.ctx.transform=this.ctx.transform.multiply(U)},x.prototype.rotate=function(k){if(isNaN(k))throw _t.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var B=new d(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(B)},x.prototype.translate=function(k,B){if(isNaN(k)||isNaN(B))throw _t.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var U=new d(1,0,0,1,k,B);this.ctx.transform=this.ctx.transform.multiply(U)},x.prototype.transform=function(k,B,U,X,ee,de){if(isNaN(k)||isNaN(B)||isNaN(U)||isNaN(X)||isNaN(ee)||isNaN(de))throw _t.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new d(k,B,U,X,ee,de);this.ctx.transform=this.ctx.transform.multiply(ue)},x.prototype.setTransform=function(k,B,U,X,ee,de){k=isNaN(k)?1:k,B=isNaN(B)?0:B,U=isNaN(U)?0:U,X=isNaN(X)?1:X,ee=isNaN(ee)?0:ee,de=isNaN(de)?0:de,this.ctx.transform=new d(k,B,U,X,ee,de)};var N=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function(k,B,U,X,ee,de,ue,me,ke){var _e=this.pdf.getImageProperties(k),Ce=1,Ee=1,Ve=1,ye=1;X!==void 0&&me!==void 0&&(Ve=me/X,ye=ke/ee,Ce=_e.width/X*me/X,Ee=_e.height/ee*ke/ee),de===void 0&&(de=B,ue=U,B=0,U=0),X!==void 0&&me===void 0&&(me=X,ke=ee),X===void 0&&me===void 0&&(me=_e.width,ke=_e.height);for(var te,et=this.ctx.transform.decompose(),Re=Z(et.rotate.shx),Le=new d,Ae=(Le=(Le=(Le=Le.multiply(et.translate)).multiply(et.skew)).multiply(et.scale)).applyToRectangle(new c(de-B*Ve,ue-U*ye,X*Ce,ee*Ee)),Me=L.call(this,Ae),Ie=[],qe=0;qe<Me.length;qe+=1)Ie.indexOf(Me[qe])===-1&&Ie.push(Me[qe]);if(S(Ie),this.autoPaging)for(var Ke=Ie[0],nt=Ie[Ie.length-1],at=Ke;at<nt+1;at++){this.pdf.setPage(at);var lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=at===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],st=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=at===1?0:Ye+(at-2)*st;if(this.ctx.clip_path.length!==0){var ir=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(te,this.posX+this.margin[3],-Te+wt+this.ctx.prevPageLastElemOffset),R.call(this,"fill",!0),this.path=ir}var ut=JSON.parse(JSON.stringify(Ae));ut=j([ut],this.posX+this.margin[3],-Te+wt+this.ctx.prevPageLastElemOffset)[0];var Hr=(at>Ke||at<nt)&&N.call(this);Hr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,st,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",ut.x,ut.y,ut.w,ut.h,null,null,Re),Hr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Ae.x,Ae.y,Ae.w,Ae.h,null,null,Re)};var L=function(k,B,U){var X=[];B=B||this.pdf.internal.pageSize.width,U=U||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":X.push(Math.floor((k.y+ee)/U)+1);break;case"arc":X.push(Math.floor((k.y+ee-k.radius)/U)+1),X.push(Math.floor((k.y+ee+k.radius)/U)+1);break;case"qct":var de=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);X.push(Math.floor((de.y+ee)/U)+1),X.push(Math.floor((de.y+de.h+ee)/U)+1);break;case"bct":var ue=ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);X.push(Math.floor((ue.y+ee)/U)+1),X.push(Math.floor((ue.y+ue.h+ee)/U)+1);break;case"rect":X.push(Math.floor((k.y+ee)/U)+1),X.push(Math.floor((k.y+k.h+ee)/U)+1)}for(var me=0;me<X.length;me+=1)for(;this.pdf.internal.getNumberOfPages()<X[me];)w.call(this);return X},w=function(){var k=this.fillStyle,B=this.strokeStyle,U=this.font,X=this.lineCap,ee=this.lineWidth,de=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=B,this.font=U,this.lineCap=X,this.lineWidth=ee,this.lineJoin=de},j=function(k,B,U){for(var X=0;X<k.length;X++)switch(k[X].type){case"bct":k[X].x2+=B,k[X].y2+=U;case"qct":k[X].x1+=B,k[X].y1+=U;case"mt":case"lt":case"arc":default:k[X].x+=B,k[X].y+=U}return k},S=function(k){return k.sort(function(B,U){return B-U})},I=function(k,B){for(var U,X,ee=this.fillStyle,de=this.strokeStyle,ue=this.lineCap,me=this.lineWidth,ke=Math.abs(me*this.ctx.transform.scaleX),_e=this.lineJoin,Ce=JSON.parse(JSON.stringify(this.path)),Ee=JSON.parse(JSON.stringify(this.path)),Ve=[],ye=0;ye<Ee.length;ye++)if(Ee[ye].x!==void 0)for(var te=L.call(this,Ee[ye]),et=0;et<te.length;et+=1)Ve.indexOf(te[et])===-1&&Ve.push(te[et]);for(var Re=0;Re<Ve.length;Re++)for(;this.pdf.internal.getNumberOfPages()<Ve[Re];)w.call(this);if(S(Ve),this.autoPaging)for(var Le=Ve[0],Ae=Ve[Ve.length-1],Me=Le;Me<Ae+1;Me++){this.pdf.setPage(Me),this.fillStyle=ee,this.strokeStyle=de,this.lineCap=ue,this.lineWidth=ke,this.lineJoin=_e;var Ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qe=Me===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=Me===1?0:Ke+(Me-2)*nt;if(this.ctx.clip_path.length!==0){var lt=this.path;U=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(U,this.posX+this.margin[3],-at+qe+this.ctx.prevPageLastElemOffset),R.call(this,k,!0),this.path=lt}if(X=JSON.parse(JSON.stringify(Ce)),this.path=j(X,this.posX+this.margin[3],-at+qe+this.ctx.prevPageLastElemOffset),B===!1||Me===0){var wt=(Me>Le||Me<Ae)&&N.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ie,nt,null).clip().discardPath()),R.call(this,k,B),wt&&this.pdf.restoreGraphicsState()}this.lineWidth=me}else this.lineWidth=ke,R.call(this,k,B),this.lineWidth=me;this.path=Ce},R=function(k,B){if((k!=="stroke"||B||!v.call(this))&&(k==="stroke"||B||!m.call(this))){for(var U,X,ee=[],de=this.path,ue=0;ue<de.length;ue++){var me=de[ue];switch(me.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:me,deltas:[],abs:[]});break;case"lt":var ke=ee.length;if(de[ue-1]&&!isNaN(de[ue-1].x)&&(U=[me.x-de[ue-1].x,me.y-de[ue-1].y],ke>0)){for(;ke>=0;ke--)if(ee[ke-1].close!==!0&&ee[ke-1].begin!==!0){ee[ke-1].deltas.push(U),ee[ke-1].abs.push(me);break}}break;case"bct":U=[me.x1-de[ue-1].x,me.y1-de[ue-1].y,me.x2-de[ue-1].x,me.y2-de[ue-1].y,me.x-de[ue-1].x,me.y-de[ue-1].y],ee[ee.length-1].deltas.push(U);break;case"qct":var _e=de[ue-1].x+2/3*(me.x1-de[ue-1].x),Ce=de[ue-1].y+2/3*(me.y1-de[ue-1].y),Ee=me.x+2/3*(me.x1-me.x),Ve=me.y+2/3*(me.y1-me.y),ye=me.x,te=me.y;U=[_e-de[ue-1].x,Ce-de[ue-1].y,Ee-de[ue-1].x,Ve-de[ue-1].y,ye-de[ue-1].x,te-de[ue-1].y],ee[ee.length-1].deltas.push(U);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(me)}}X=B?null:k==="stroke"?"stroke":"fill";for(var et=!1,Re=0;Re<ee.length;Re++)if(ee[Re].arc)for(var Le=ee[Re].abs,Ae=0;Ae<Le.length;Ae++){var Me=Le[Ae];Me.type==="arc"?M.call(this,Me.x,Me.y,Me.radius,Me.startAngle,Me.endAngle,Me.counterclockwise,void 0,B,!et):q.call(this,Me.x,Me.y),et=!0}else if(ee[Re].close===!0)this.pdf.internal.out("h"),et=!1;else if(ee[Re].begin!==!0){var Ie=ee[Re].start.x,qe=ee[Re].start.y;H.call(this,ee[Re].deltas,Ie,qe),et=!0}X&&G.call(this,X),B&&J.call(this)}},K=function(k){var B=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,U=B*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-U;case"top":return k+B-U;case"hanging":return k+B-2*U;case"middle":return k+B/2-U;case"ideographic":return k;case"alphabetic":default:return k}},O=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(B,U){this.colorStops.push([B,U])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var M=function(k,B,U,X,ee,de,ue,me,ke){for(var _e=Y.call(this,U,X,ee,de),Ce=0;Ce<_e.length;Ce++){var Ee=_e[Ce];Ce===0&&(ke?A.call(this,Ee.x1+k,Ee.y1+B):q.call(this,Ee.x1+k,Ee.y1+B)),le.call(this,k,B,Ee.x2,Ee.y2,Ee.x3,Ee.y3,Ee.x4,Ee.y4)}me?J.call(this):G.call(this,ue)},G=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(k,B){this.pdf.internal.out(r(k)+" "+a(B)+" m")},_=function(k){var B;switch(k.align){case"right":case"end":B="right";break;case"center":B="center";break;case"left":case"start":default:B="left"}var U=this.pdf.getTextDimensions(k.text),X=K.call(this,k.y),ee=O.call(this,X)-U.h,de=this.ctx.transform.applyToPoint(new o(k.x,X)),ue=this.ctx.transform.decompose(),me=new d;me=(me=(me=me.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var ke,_e,Ce,Ee=this.ctx.transform.applyToRectangle(new c(k.x,X,U.w,U.h)),Ve=me.applyToRectangle(new c(k.x,ee,U.w,U.h)),ye=L.call(this,Ve),te=[],et=0;et<ye.length;et+=1)te.indexOf(ye[et])===-1&&te.push(ye[et]);if(S(te),this.autoPaging)for(var Re=te[0],Le=te[te.length-1],Ae=Re;Ae<Le+1;Ae++){this.pdf.setPage(Ae);var Me=Ae===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[2],Ke=qe-this.margin[0],nt=this.pdf.internal.pageSize.width-this.margin[1],at=nt-this.margin[3],lt=Ae===1?0:Ie+(Ae-2)*Ke;if(this.ctx.clip_path.length!==0){var wt=this.path;ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(ke,this.posX+this.margin[3],-1*lt+Me),R.call(this,"fill",!0),this.path=wt}var Ye=j([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-lt+Me+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(_e=this.pdf.internal.getFontSize(),this.pdf.setFontSize(_e*k.scale),Ce=this.lineWidth,this.lineWidth=Ce*k.scale);var st=this.autoPaging!=="text";if(st||Ye.y+Ye.h<=qe){if(st||Ye.y>=Me&&Ye.x<=nt){var Te=st?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||nt-Ye.x)[0],ir=j([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-lt+Me+this.ctx.prevPageLastElemOffset)[0],ut=st&&(Ae>Re||Ae<Le)&&N.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,Ke,null).clip().discardPath()),this.pdf.text(Te,ir.x,ir.y,{angle:k.angle,align:B,renderingMode:k.renderingMode}),ut&&this.pdf.restoreGraphicsState()}}else Ye.y<qe&&(this.ctx.prevPageLastElemOffset+=qe-Ye.y);k.scale>=.01&&(this.pdf.setFontSize(_e),this.lineWidth=Ce)}else k.scale>=.01&&(_e=this.pdf.internal.getFontSize(),this.pdf.setFontSize(_e*k.scale),Ce=this.lineWidth,this.lineWidth=Ce*k.scale),this.pdf.text(k.text,de.x+this.posX,de.y+this.posY,{angle:k.angle,align:B,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(_e),this.lineWidth=Ce)},q=function(k,B,U,X){U=U||0,X=X||0,this.pdf.internal.out(r(k+U)+" "+a(B+X)+" l")},H=function(k,B,U){return this.pdf.lines(k,B,U,null,null)},le=function(k,B,U,X,ee,de,ue,me){this.pdf.internal.out([t(s(U+k)),t(i(X+B)),t(s(ee+k)),t(i(de+B)),t(s(ue+k)),t(i(me+B)),"c"].join(" "))},Y=function(k,B,U,X){for(var ee=2*Math.PI,de=Math.PI/2;B>U;)B-=ee;var ue=Math.abs(U-B);ue<ee&&X&&(ue=ee-ue);for(var me=[],ke=X?-1:1,_e=B;ue>1e-5;){var Ce=_e+ke*Math.min(ue,de);me.push(V.call(this,k,_e,Ce)),ue-=Math.abs(Ce-_e),_e=Ce}return me},V=function(k,B,U){var X=(U-B)/2,ee=k*Math.cos(X),de=k*Math.sin(X),ue=ee,me=-de,ke=ue*ue+me*me,_e=ke+ue*ee+me*de,Ce=4/3*(Math.sqrt(2*ke*_e)-_e)/(ue*de-me*ee),Ee=ue-Ce*me,Ve=me+Ce*ue,ye=Ee,te=-Ve,et=X+B,Re=Math.cos(et),Le=Math.sin(et);return{x1:k*Math.cos(B),y1:k*Math.sin(B),x2:Ee*Re-Ve*Le,y2:Ee*Le+Ve*Re,x3:ye*Re-te*Le,y3:ye*Le+te*Re,x4:k*Math.cos(U),y4:k*Math.sin(U)}},Z=function(k){return 180*k/Math.PI},Q=function(k,B,U,X,ee,de){var ue=k+.5*(U-k),me=B+.5*(X-B),ke=ee+.5*(U-ee),_e=de+.5*(X-de),Ce=Math.min(k,ee,ue,ke),Ee=Math.max(k,ee,ue,ke),Ve=Math.min(B,de,me,_e),ye=Math.max(B,de,me,_e);return new c(Ce,Ve,Ee-Ce,ye-Ve)},ie=function(k,B,U,X,ee,de,ue,me){var ke,_e,Ce,Ee,Ve,ye,te,et,Re,Le,Ae,Me,Ie,qe,Ke=U-k,nt=X-B,at=ee-U,lt=de-X,wt=ue-ee,Ye=me-de;for(_e=0;_e<41;_e++)Re=(te=(Ce=k+(ke=_e/40)*Ke)+ke*((Ve=U+ke*at)-Ce))+ke*(Ve+ke*(ee+ke*wt-Ve)-te),Le=(et=(Ee=B+ke*nt)+ke*((ye=X+ke*lt)-Ee))+ke*(ye+ke*(de+ke*Ye-ye)-et),_e==0?(Ae=Re,Me=Le,Ie=Re,qe=Le):(Ae=Math.min(Ae,Re),Me=Math.min(Me,Le),Ie=Math.max(Ie,Re),qe=Math.max(qe,Le));return new c(Math.round(Ae),Math.round(Me),Math.round(Ie-Ae),Math.round(qe-Me))},ge=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,B,U=(k=this.ctx.lineDash,B=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:B}));this.prevLineDash!==U&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=U)}}})(Ue.API),function(e){var t=function(i){var o,c,d,h,g,x,y,m,v,N;for(c=[],d=0,h=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;h>d;d+=4)(g=(i.charCodeAt(d)<<24)+(i.charCodeAt(d+1)<<16)+(i.charCodeAt(d+2)<<8)+i.charCodeAt(d+3))!==0?(x=(g=((g=((g=((g=(g-(N=g%85))/85)-(v=g%85))/85)-(m=g%85))/85)-(y=g%85))/85)%85,c.push(x+33,y+33,m+33,v+33,N+33)):c.push(122);return function(L,w){for(var j=w;j>0;j--)L.pop()}(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(i){var o,c,d,h,g,x=String,y="length",m=255,v="charCodeAt",N="slice",L="replace";for(i[N](-2),i=i[N](0,-2)[L](/\s/g,"")[L]("z","!!!!!"),d=[],h=0,g=(i+=o="uuuuu"[N](i[y]%5||5))[y];g>h;h+=5)c=52200625*(i[v](h)-33)+614125*(i[v](h+1)-33)+7225*(i[v](h+2)-33)+85*(i[v](h+3)-33)+(i[v](h+4)-33),d.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(w,j){for(var S=j;S>0;S--)w.pop()}(d,o[y]),x.fromCharCode.apply(x,d)},a=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var c="",d=0;d<i.length;d+=2)c+=String.fromCharCode("0x"+(i[d]+i[d+1]));return c},s=function(i){for(var o=new Uint8Array(i.length),c=i.length;c--;)o[c]=i.charCodeAt(c);return i=(o=tc(o)).reduce(function(d,h){return d+String.fromCharCode(h)},"")};e.processDataByFilters=function(i,o){var c=0,d=i||"",h=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=d.split("").map(function(g){return("0"+g.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:d,reverseChain:h.reverse().join(" ")}}}(Ue.API),function(e){e.loadFile=function(t,r,a){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=function(d,h,g){var x=new XMLHttpRequest,y=0,m=function(v){var N=v.length,L=[],w=String.fromCharCode;for(y=0;y<N;y+=1)L.push(w(255&v.charCodeAt(y)));return L.join("")};if(x.open("GET",d,!h),x.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(x.onload=function(){x.status===200?g(m(this.responseText)):g(void 0)}),x.send(null),h&&x.status===200)return m(x.responseText)}(s,i,o)}catch{}return c}(t,r,a)},e.loadImageFile=e.loadFile}(Ue.API),function(e){function t(){return(Ge.html2canvas?Promise.resolve(Ge.html2canvas):Jl(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ge.DOMPurify?Promise.resolve(Ge.DOMPurify):Jl(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var a=function(o){var c=vt(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(o,c){var d=document.createElement(o);for(var h in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[h]=c.style[h];return d},i=function o(c){var d=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),h=o.convert(Promise.resolve(),d);return h=(h=h.setProgress(1,o,1,[o])).set(c)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,c){return o.__proto__=c||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,c){return this.then(function(){switch(c=c||function(d){switch(a(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(d){return this.set({src:s("div",{innerHTML:o,dompurify:d})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=function d(h,g){for(var x=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),y=h.firstChild;y;y=y.nextSibling)g!==!0&&y.nodeType===1&&y.nodeName==="SCRIPT"||x.appendChild(d(y,g));return h.nodeType===1&&(h.nodeName==="CANVAS"?(x.width=h.width,x.height=h.height,x.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(x.value=h.value),x.addEventListener("load",function(){x.scrollTop=h.scrollTop,x.scrollLeft=h.scrollLeft},!0)),x}(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var d=this.opt.jsPDF,h=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=h,h)for(var y=0;y<h.length;++y){var m=h[y],v=m.src.find(function(N){return N.format==="truetype"});v&&d.addFont(v.url,m.ref.name,m.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,d.context2d.save(!0),c(this.prop.container,x)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},i.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(a(o)!=="object")return this;var c=Object.keys(o||{}).map(function(d){if(d in i.template.prop)return function(){this.prop[d]=o[d]};switch(d){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[d]=o[d]}}},this);return this.then(function(){return this.thenList(c)})},i.prototype.get=function(o,c){return this.then(function(){var d=o in i.template.prop?this.prop[o]:this.opt[o];return c?c(d):d})},i.prototype.setMargin=function(o){return this.then(function(){switch(a(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function c(d,h){return Math.floor(d*h/72*96)}return this.then(function(){(o=o||Ue.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,c,d,h){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,c,d,h){return this.setProgress(o?this.progress.val+o:null,c||null,d?this.progress.n+d:null,h?this.progress.stack.concat(h):null)},i.prototype.then=function(o,c){var d=this;return this.thenCore(o,c,function(h,g){return d.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(x){return d.updateProgress(null,h),x}).then(h,g).then(function(x){return d.updateProgress(1),x})})},i.prototype.thenCore=function(o,c,d){d=d||Promise.prototype.then,o&&(o=o.bind(this)),c&&(c=c.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),g=d.call(h,o,c);return i.convert(g,this.__proto__)},i.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},i.prototype.thenList=function(o){var c=this;return o.forEach(function(d){c=c.thenCore(d)}),c},i.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return i.convert(c,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Ue.getPageSize=function(o,c,d){if(vt(o)==="object"){var h=o;o=h.orientation,c=h.unit||c,d=h.format||d}c=c||"mm",d=d||"a4",o=(""+(o||"P")).toLowerCase();var g,x=(""+d).toLowerCase(),y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+c}var m,v=0,N=0;if(y.hasOwnProperty(x))v=y[x][1]/g,N=y[x][0]/g;else try{v=d[1],N=d[0]}catch{throw new Error("Invalid format: "+d)}if(o==="p"||o==="portrait")o="p",N>v&&(m=N,N=v,v=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",v>N&&(m=N,N=v,v=m)}return{width:N,height:v,unit:c,k:g,orientation:o}},e.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(oc):null;var d=new i(c);return c.worker?d:d.from(o).doCallback()}}(Ue.API),Ue.API.addJS=function(e){return bd=e,this.internal.events.subscribe("postPutResources",function(){co=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(co+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),vd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+bd+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){co!==void 0&&vd!==void 0&&this.internal.out("/Names <</JavaScript "+co+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],c=a.exec(o);if(c!=null){var d=c[1];r.internal.newObjectDeferredBegin(d,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,g=[];for(i=0;i<h;i++){var x=r.internal.newObject();g.push(x);var y=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<g.length;i++)r.internal.write("(page_"+(i+1)+")"+g[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,s,i){var o={title:s,options:i,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var s=0;s<a.children.length;s++)this.genIds_r(a.children[s])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var o=a.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var d=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var h=0;h<a.children.length;h++)this.renderItems(a.children[h])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,s){for(var i=0;i<s.children.length;i++)a.count++,this.count_r(a,s.children[i]);return a.count}}])}(Ue.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,s,i,o,c){var d,h=this.decode.DCT_DECODE,g=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(d=function(x){for(var y,m=256*x.charCodeAt(4)+x.charCodeAt(5),v=x.length,N={width:0,height:0,numcomponents:1},L=4;L<v;L+=2){if(L+=m,t.indexOf(x.charCodeAt(L+1))!==-1){y=256*x.charCodeAt(L+5)+x.charCodeAt(L+6),N={width:256*x.charCodeAt(L+7)+x.charCodeAt(L+8),height:y,numcomponents:x.charCodeAt(L+9)};break}m=256*x.charCodeAt(L+2)+x.charCodeAt(L+3)}return N}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}g={data:r,width:d.width,height:d.height,colorSpace:c,bitsPerComponent:8,filter:h,index:a,alias:s}}return g}}(Ue.API);var os,uo,wd,Nd,jd,W0=function(){var e,t,r;function a(i){var o,c,d,h,g,x,y,m,v,N,L,w,j,S;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},x=null;;){switch(o=this.readUInt32(),v=(function(){var I,R;for(R=[],I=0;I<4;++I)R.push(String.fromCharCode(this.data[this.pos++]));return R}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":x&&this.animation.frames.push(x),this.pos+=4,x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},g=this.readUInt16(),h=this.readUInt16()||100,x.delay=1e3*g/h,x.disposeOp=this.data[this.pos++],x.blendOp=this.data[this.pos++],x.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,o-=4),i=(x!=null?x.data:void 0)||this.imgData,w=0;0<=o?w<o:w>o;0<=o?++w:--w)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(d=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>d)throw new Error("More transparent colors than palette size");if((N=d-this.transparency.indexed.length)>0)for(j=0;0<=N?j<N:j>N;0<=N?++j:--j)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":y=(L=this.read(o)).indexOf(0),m=String.fromCharCode.apply(String,L.slice(0,y)),this.text[m]=String.fromCharCode.apply(String,L.slice(y+1));break;case"IEND":return x&&this.animation.frames.push(x),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(S=this.colorType)===4||S===6,c=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*c,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var o,c;for(c=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)c.push(this.data[this.pos++]);return c},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,c=new Uint8Array(this.width*this.height*o),d=0,h=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function g(x,y,m,v){var N,L,w,j,S,I,R,K,O,M,G,J,A,_,q,H,le,Y,V,Z,Q,ie=Math.ceil((h.width-x)/m),ge=Math.ceil((h.height-y)/v),k=h.width==ie&&h.height==ge;for(_=o*ie,J=k?c:new Uint8Array(_*ge),I=i.length,A=0,L=0;A<ge&&d<I;){switch(i[d++]){case 0:for(j=le=0;le<_;j=le+=1)J[L++]=i[d++];break;case 1:for(j=Y=0;Y<_;j=Y+=1)N=i[d++],S=j<o?0:J[L-o],J[L++]=(N+S)%256;break;case 2:for(j=V=0;V<_;j=V+=1)N=i[d++],w=(j-j%o)/o,q=A&&J[(A-1)*_+w*o+j%o],J[L++]=(q+N)%256;break;case 3:for(j=Z=0;Z<_;j=Z+=1)N=i[d++],w=(j-j%o)/o,S=j<o?0:J[L-o],q=A&&J[(A-1)*_+w*o+j%o],J[L++]=(N+Math.floor((S+q)/2))%256;break;case 4:for(j=Q=0;Q<_;j=Q+=1)N=i[d++],w=(j-j%o)/o,S=j<o?0:J[L-o],A===0?q=H=0:(q=J[(A-1)*_+w*o+j%o],H=w&&J[(A-1)*_+(w-1)*o+j%o]),R=S+q-H,K=Math.abs(R-S),M=Math.abs(R-q),G=Math.abs(R-H),O=K<=M&&K<=G?S:M<=G?q:H,J[L++]=(N+O)%256;break;default:throw new Error("Invalid filter algorithm: "+i[d-1])}if(!k){var B=((y+A*v)*h.width+x)*o,U=A*_;for(j=0;j<ie;j+=1){for(var X=0;X<o;X+=1)c[B++]=J[U++];B+=(m-1)*o}}A++}}return i=w0(i),h.interlaceMethod==1?(g(0,0,8,8),g(4,0,8,8),g(0,4,4,8),g(2,0,4,4),g(0,2,2,4),g(1,0,2,2),g(0,1,1,2)):g(0,0,1,1),c},a.prototype.decodePalette=function(){var i,o,c,d,h,g,x,y,m;for(c=this.palette,g=this.transparency.indexed||[],h=new Uint8Array((g.length||0)+c.length),d=0,i=0,o=x=0,y=c.length;x<y;o=x+=3)h[d++]=c[o],h[d++]=c[o+1],h[d++]=c[o+2],h[d++]=(m=g[i++])!=null?m:255;return h},a.prototype.copyToImageData=function(i,o){var c,d,h,g,x,y,m,v,N,L,w;if(d=this.colors,N=null,c=this.hasAlphaChannel,this.palette.length&&(N=(w=this._decodedPalette)!=null?w:this._decodedPalette=this.decodePalette(),d=4,c=!0),v=(h=i.data||i).length,x=N||o,g=y=0,d===1)for(;g<v;)m=N?4*o[g/4]:y,L=x[m++],h[g++]=L,h[g++]=L,h[g++]=L,h[g++]=c?x[m++]:255,y=m;else for(;g<v;)m=N?4*o[g/4]:y,h[g++]=x[m++],h[g++]=x[m++],h[g++]=x[m++],h[g++]=c?x[m++]:255,y=m},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var s=function(){if(Object.prototype.toString.call(Ge)==="[object Window]"){try{t=Ge.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return s(),e=function(i){var o;if(s()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var o,c,d,h,g,x,y,m;if(this.animation){for(m=[],c=g=0,x=(y=this.animation.frames).length;g<x;c=++g)o=y[c],d=i.createImageData(o.width,o.height),h=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(d,h),o.imageData=d,m.push(o.image=e(d));return m}},a.prototype.renderFrame=function(i,o){var c,d,h;return c=(d=this.animation.frames)[o],h=d[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(h!=null?h.disposeOp:void 0)===1?i.clearRect(h.xOffset,h.yOffset,h.width,h.height):(h!=null?h.disposeOp:void 0)===2&&i.putImageData(h.imageData,h.xOffset,h.yOffset),c.blendOp===0&&i.clearRect(c.xOffset,c.yOffset,c.width,c.height),i.drawImage(c.image,c.xOffset,c.yOffset)},a.prototype.animate=function(i){var o,c,d,h,g,x,y=this;return c=0,x=this.animation,h=x.numFrames,d=x.frames,g=x.numPlays,(o=function(){var m,v;if(m=c++%h,v=d[m],y.renderFrame(i,m),h>1&&c/h<g)return y.animation._timeout=setTimeout(o,v.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var o,c;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(c=o.createImageData(this.width,this.height),this.copyToImageData(c,this.decodePixels()),o.putImageData(c,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function V0(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,o=1<<(7&s)+1;e[t++],e[t++];var c=null,d=null;i&&(c=t,d=o,t+=3*o);var h=!0,g=[],x=0,y=null,m=0,v=null;for(this.width=r,this.height=a;h&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((A=e[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var N=e[t++];x=e[t++]|e[t++]<<8,y=e[t++],!(1&N)&&(y=null),m=N>>2&7,t++;break;case 254:for(;;){if(!((A=e[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var L=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,j=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,I=e[t++],R=I>>6&1,K=1<<(7&I)+1,O=c,M=d,G=!1;I>>7&&(G=!0,O=t,M=K,t+=3*K);var J=t;for(t++;;){var A;if(!((A=e[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}g.push({x:L,y:w,width:j,height:S,has_local_palette:G,palette_offset:O,palette_size:M,data_offset:J,data_length:t-J,transparent_index:y,interlaced:!!R,delay:x,disposal:m});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return g.length},this.loopCount=function(){return v},this.frameInfo=function(_){if(_<0||_>=g.length)throw new Error("Frame index out of range.");return g[_]},this.decodeAndBlitFrameBGRA=function(_,q){var H=this.frameInfo(_),le=H.width*H.height,Y=new Uint8Array(le);Sd(e,H.data_offset,Y,le);var V=H.palette_offset,Z=H.transparent_index;Z===null&&(Z=256);var Q=H.width,ie=r-Q,ge=Q,k=4*(H.y*r+H.x),B=4*((H.y+H.height)*r+H.x),U=k,X=4*ie;H.interlaced===!0&&(X+=4*r*7);for(var ee=8,de=0,ue=Y.length;de<ue;++de){var me=Y[de];if(ge===0&&(ge=Q,(U+=X)>=B&&(X=4*ie+4*r*(ee-1),U=k+(Q+ie)*(ee<<1),ee>>=1)),me===Z)U+=4;else{var ke=e[V+3*me],_e=e[V+3*me+1],Ce=e[V+3*me+2];q[U++]=Ce,q[U++]=_e,q[U++]=ke,q[U++]=255}--ge}},this.decodeAndBlitFrameRGBA=function(_,q){var H=this.frameInfo(_),le=H.width*H.height,Y=new Uint8Array(le);Sd(e,H.data_offset,Y,le);var V=H.palette_offset,Z=H.transparent_index;Z===null&&(Z=256);var Q=H.width,ie=r-Q,ge=Q,k=4*(H.y*r+H.x),B=4*((H.y+H.height)*r+H.x),U=k,X=4*ie;H.interlaced===!0&&(X+=4*r*7);for(var ee=8,de=0,ue=Y.length;de<ue;++de){var me=Y[de];if(ge===0&&(ge=Q,(U+=X)>=B&&(X=4*ie+4*r*(ee-1),U=k+(Q+ie)*(ee<<1),ee>>=1)),me===Z)U+=4;else{var ke=e[V+3*me],_e=e[V+3*me+1],Ce=e[V+3*me+2];q[U++]=ke,q[U++]=_e,q[U++]=Ce,q[U++]=255}--ge}}}function Sd(e,t,r,a){for(var s=e[t++],i=1<<s,o=i+1,c=o+1,d=s+1,h=(1<<d)-1,g=0,x=0,y=0,m=e[t++],v=new Int32Array(4096),N=null;;){for(;g<16&&m!==0;)x|=e[t++]<<g,g+=8,m===1?m=e[t++]:--m;if(g<d)break;var L=x&h;if(x>>=d,g-=d,L!==i){if(L===o)break;for(var w=L<c?L:N,j=0,S=w;S>i;)S=v[S]>>8,++j;var I=S;if(y+j+(w!==L?1:0)>a)return void _t.log("Warning, gif stream longer than expected.");r[y++]=I;var R=y+=j;for(w!==L&&(r[y++]=I),S=w;j--;)S=v[S],r[--R]=255&S,S>>=8;N!==null&&c<4096&&(v[c++]=N<<8|I,c>=h+1&&d<12&&(++d,h=h<<1|1)),N=L}else c=o+1,h=(1<<(d=s+1))-1,N=null}return y!==a&&_t.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Rl(e){var t,r,a,s,i,o=Math.floor,c=new Array(64),d=new Array(64),h=new Array(64),g=new Array(64),x=new Array(65535),y=new Array(65535),m=new Array(64),v=new Array(64),N=[],L=0,w=7,j=new Array(64),S=new Array(64),I=new Array(64),R=new Array(256),K=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Y(k,B){for(var U=0,X=0,ee=new Array,de=1;de<=16;de++){for(var ue=1;ue<=k[de];ue++)ee[B[X]]=[],ee[B[X]][0]=U,ee[B[X]][1]=de,X++,U++;U*=2}return ee}function V(k){for(var B=k[0],U=k[1]-1;U>=0;)B&1<<U&&(L|=1<<w),U--,--w<0&&(L==255?(Z(255),Z(0)):Z(L),w=7,L=0)}function Z(k){N.push(k)}function Q(k){Z(k>>8&255),Z(255&k)}function ie(k,B,U,X,ee){for(var de,ue=ee[0],me=ee[240],ke=function(Le,Ae){var Me,Ie,qe,Ke,nt,at,lt,wt,Ye,st,Te=0;for(Ye=0;Ye<8;++Ye){Me=Le[Te],Ie=Le[Te+1],qe=Le[Te+2],Ke=Le[Te+3],nt=Le[Te+4],at=Le[Te+5],lt=Le[Te+6];var ir=Me+(wt=Le[Te+7]),ut=Me-wt,Hr=Ie+lt,jt=Ie-lt,Ct=qe+at,on=qe-at,mt=Ke+nt,ia=Ke-nt,It=ir+mt,Wr=ir-mt,Nn=Hr+Ct,Mt=Hr-Ct;Le[Te]=It+Nn,Le[Te+4]=It-Nn;var Xe=.707106781*(Mt+Wr);Le[Te+2]=Wr+Xe,Le[Te+6]=Wr-Xe;var gt=.382683433*((It=ia+on)-(Mt=jt+ut)),oa=.5411961*It+gt,nr=1.306562965*Mt+gt,ln=.707106781*(Nn=on+jt),cn=ut+ln,We=ut-ln;Le[Te+5]=We+oa,Le[Te+3]=We-oa,Le[Te+1]=cn+nr,Le[Te+7]=cn-nr,Te+=8}for(Te=0,Ye=0;Ye<8;++Ye){Me=Le[Te],Ie=Le[Te+8],qe=Le[Te+16],Ke=Le[Te+24],nt=Le[Te+32],at=Le[Te+40],lt=Le[Te+48];var Vr=Me+(wt=Le[Te+56]),dn=Me-wt,vr=Ie+lt,$t=Ie-lt,Wt=qe+at,Ar=qe-at,Ea=Ke+nt,jn=Ke-nt,Gr=Vr+Ea,Yr=Vr-Ea,$r=vr+Wt,un=vr-Wt;Le[Te]=Gr+$r,Le[Te+32]=Gr-$r;var Tr=.707106781*(un+Yr);Le[Te+16]=Yr+Tr,Le[Te+48]=Yr-Tr;var hn=.382683433*((Gr=jn+Ar)-(un=$t+dn)),la=.5411961*Gr+hn,Fa=1.306562965*un+hn,Ia=.707106781*($r=Ar+$t),Ma=dn+Ia,Ta=dn-Ia;Le[Te+40]=Ta+la,Le[Te+24]=Ta-la,Le[Te+8]=Ma+Fa,Le[Te+56]=Ma-Fa,Te++}for(Ye=0;Ye<64;++Ye)st=Le[Ye]*Ae[Ye],m[Ye]=st>0?st+.5|0:st-.5|0;return m}(k,B),_e=0;_e<64;++_e)v[O[_e]]=ke[_e];var Ce=v[0]-U;U=v[0],Ce==0?V(X[0]):(V(X[y[de=32767+Ce]]),V(x[de]));for(var Ee=63;Ee>0&&v[Ee]==0;)Ee--;if(Ee==0)return V(ue),U;for(var Ve,ye=1;ye<=Ee;){for(var te=ye;v[ye]==0&&ye<=Ee;)++ye;var et=ye-te;if(et>=16){Ve=et>>4;for(var Re=1;Re<=Ve;++Re)V(me);et&=15}de=32767+v[ye],V(ee[(et<<4)+y[de]]),V(x[de]),ye++}return Ee!=63&&V(ue),U}function ge(k){k=Math.min(Math.max(k,1),100),i!=k&&(function(B){for(var U=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var ee=o((U[X]*B+50)/100);ee=Math.min(Math.max(ee,1),255),c[O[X]]=ee}for(var de=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var me=o((de[ue]*B+50)/100);me=Math.min(Math.max(me,1),255),d[O[ue]]=me}for(var ke=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],_e=0,Ce=0;Ce<8;Ce++)for(var Ee=0;Ee<8;Ee++)h[_e]=1/(c[O[_e]]*ke[Ce]*ke[Ee]*8),g[_e]=1/(d[O[_e]]*ke[Ce]*ke[Ee]*8),_e++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),i=k)}this.encode=function(k,B){B&&ge(B),N=new Array,L=0,w=7,Q(65496),Q(65504),Q(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),Q(1),Q(1),Z(0),Z(0),function(){Q(65499),Q(132),Z(0);for(var Ie=0;Ie<64;Ie++)Z(c[Ie]);Z(1);for(var qe=0;qe<64;qe++)Z(d[qe])}(),function(Ie,qe){Q(65472),Q(17),Z(8),Q(qe),Q(Ie),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)}(k.width,k.height),function(){Q(65476),Q(418),Z(0);for(var Ie=0;Ie<16;Ie++)Z(M[Ie+1]);for(var qe=0;qe<=11;qe++)Z(G[qe]);Z(16);for(var Ke=0;Ke<16;Ke++)Z(J[Ke+1]);for(var nt=0;nt<=161;nt++)Z(A[nt]);Z(1);for(var at=0;at<16;at++)Z(_[at+1]);for(var lt=0;lt<=11;lt++)Z(q[lt]);Z(17);for(var wt=0;wt<16;wt++)Z(H[wt+1]);for(var Ye=0;Ye<=161;Ye++)Z(le[Ye])}(),Q(65498),Q(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0);var U=0,X=0,ee=0;L=0,w=7,this.encode.displayName="_encode_";for(var de,ue,me,ke,_e,Ce,Ee,Ve,ye,te=k.data,et=k.width,Re=k.height,Le=4*et,Ae=0;Ae<Re;){for(de=0;de<Le;){for(_e=Le*Ae+de,Ee=-1,Ve=0,ye=0;ye<64;ye++)Ce=_e+(Ve=ye>>3)*Le+(Ee=4*(7&ye)),Ae+Ve>=Re&&(Ce-=Le*(Ae+1+Ve-Re)),de+Ee>=Le&&(Ce-=de+Ee-Le+4),ue=te[Ce++],me=te[Ce++],ke=te[Ce++],j[ye]=(K[ue]+K[me+256>>0]+K[ke+512>>0]>>16)-128,S[ye]=(K[ue+768>>0]+K[me+1024>>0]+K[ke+1280>>0]>>16)-128,I[ye]=(K[ue+1280>>0]+K[me+1536>>0]+K[ke+1792>>0]>>16)-128;U=ie(j,h,U,t,a),X=ie(S,g,X,r,s),ee=ie(I,g,ee,r,s),de+=32}Ae+=8}if(w>=0){var Me=[];Me[1]=w+1,Me[0]=(1<<w+1)-1,V(Me)}return Q(65497),new Uint8Array(N)},e=e||50,function(){for(var k=String.fromCharCode,B=0;B<256;B++)R[B]=k(B)}(),t=Y(M,G),r=Y(_,q),a=Y(J,A),s=Y(H,le),function(){for(var k=1,B=2,U=1;U<=15;U++){for(var X=k;X<B;X++)y[32767+X]=U,x[32767+X]=[],x[32767+X][1]=U,x[32767+X][0]=X;for(var ee=-(B-1);ee<=-k;ee++)y[32767+ee]=U,x[32767+ee]=[],x[32767+ee][1]=U,x[32767+ee][0]=B-1+ee;k<<=1,B<<=1}}(),function(){for(var k=0;k<256;k++)K[k]=19595*k,K[k+256>>0]=38470*k,K[k+512>>0]=7471*k+32768,K[k+768>>0]=-11059*k,K[k+1024>>0]=-21709*k,K[k+1280>>0]=32768*k+8421375,K[k+1536>>0]=-27439*k,K[k+1792>>0]=-5329*k}(),ge(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function tn(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function _d(e){function t(M){if(!M)throw Error("assert :P")}function r(M,G,J){for(var A=0;4>A;A++)if(M[G+A]!=J.charCodeAt(A))return!0;return!1}function a(M,G,J,A,_){for(var q=0;q<_;q++)M[G+q]=J[A+q]}function s(M,G,J,A){for(var _=0;_<A;_++)M[G+_]=J}function i(M){return new Int32Array(M)}function o(M,G){for(var J=[],A=0;A<M;A++)J.push(new G);return J}function c(M,G){var J=[];return function A(_,q,H){for(var le=H[q],Y=0;Y<le&&(_.push(H.length>q+1?[]:new G),!(H.length<q+1));Y++)A(_[Y],q+1,H)}(J,0,M),J}var d=function(){var M=this;function G(l,u){for(var p=1<<u-1>>>0;l&p;)p>>>=1;return p?(l&p-1)+p:l}function J(l,u,p,b,P){t(!(b%p));do l[u+(b-=p)]=P;while(0<b)}function A(l,u,p,b,P){if(t(2328>=P),512>=P)var E=i(512);else if((E=i(P))==null)return 0;return function(F,T,D,z,ne,he){var fe,oe,we=T,pe=1<<D,ae=i(16),se=i(16);for(t(ne!=0),t(z!=null),t(F!=null),t(0<D),oe=0;oe<ne;++oe){if(15<z[oe])return 0;++ae[z[oe]]}if(ae[0]==ne)return 0;for(se[1]=0,fe=1;15>fe;++fe){if(ae[fe]>1<<fe)return 0;se[fe+1]=se[fe]+ae[fe]}for(oe=0;oe<ne;++oe)fe=z[oe],0<z[oe]&&(he[se[fe]++]=oe);if(se[15]==1)return(z=new _).g=0,z.value=he[0],J(F,we,1,pe,z),pe;var ve,Ne=-1,be=pe-1,De=0,Pe=1,He=1,Fe=1<<D;for(oe=0,fe=1,ne=2;fe<=D;++fe,ne<<=1){if(Pe+=He<<=1,0>(He-=ae[fe]))return 0;for(;0<ae[fe];--ae[fe])(z=new _).g=fe,z.value=he[oe++],J(F,we+De,ne,Fe,z),De=G(De,fe)}for(fe=D+1,ne=2;15>=fe;++fe,ne<<=1){if(Pe+=He<<=1,0>(He-=ae[fe]))return 0;for(;0<ae[fe];--ae[fe]){if(z=new _,(De&be)!=Ne){for(we+=Fe,ve=1<<(Ne=fe)-D;15>Ne&&!(0>=(ve-=ae[Ne]));)++Ne,ve<<=1;pe+=Fe=1<<(ve=Ne-D),F[T+(Ne=De&be)].g=ve+D,F[T+Ne].value=we-T-Ne}z.g=fe-D,z.value=he[oe++],J(F,we+(De>>D),ne,Fe,z),De=G(De,fe)}}return Pe!=2*se[15]-1?0:pe}(l,u,p,b,P,E)}function _(){this.value=this.g=0}function q(){this.value=this.g=0}function H(){this.G=o(5,_),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ar,q)}function le(l,u,p,b){t(l!=null),t(u!=null),t(2147483648>b),l.Ca=254,l.I=0,l.b=-8,l.Ka=0,l.oa=u,l.pa=p,l.Jd=u,l.Yc=p+b,l.Zc=4<=b?p+b-4+1:p,de(l)}function Y(l,u){for(var p=0;0<u--;)p|=me(l,128)<<u;return p}function V(l,u){var p=Y(l,u);return ue(l)?-p:p}function Z(l,u,p,b){var P,E=0;for(t(l!=null),t(u!=null),t(4294967288>b),l.Sb=b,l.Ra=0,l.u=0,l.h=0,4<b&&(b=4),P=0;P<b;++P)E+=u[p+P]<<8*P;l.Ra=E,l.bb=b,l.oa=u,l.pa=p}function Q(l){for(;8<=l.u&&l.bb<l.Sb;)l.Ra>>>=8,l.Ra+=l.oa[l.pa+l.bb]<<Ka-8>>>0,++l.bb,l.u-=8;U(l)&&(l.h=1,l.u=0)}function ie(l,u){if(t(0<=u),!l.h&&u<=Ja){var p=B(l)&$a[u];return l.u+=u,Q(l),p}return l.h=1,l.u=0}function ge(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function B(l){return l.Ra>>>(l.u&Ka-1)>>>0}function U(l){return t(l.bb<=l.Sb),l.h||l.bb==l.Sb&&l.u>Ka}function X(l,u){l.u=u,l.h=U(l)}function ee(l){l.u>=Bs&&(t(l.u>=Bs),Q(l))}function de(l){t(l!=null&&l.oa!=null),l.pa<l.Zc?(l.I=(l.oa[l.pa++]|l.I<<8)>>>0,l.b+=8):(t(l!=null&&l.oa!=null),l.pa<l.Yc?(l.b+=8,l.I=l.oa[l.pa++]|l.I<<8):l.Ka?l.b=0:(l.I<<=8,l.b+=8,l.Ka=1))}function ue(l){return Y(l,1)}function me(l,u){var p=l.Ca;0>l.b&&de(l);var b=l.b,P=p*u>>>8,E=(l.I>>>b>P)+0;for(E?(p-=P,l.I-=P+1<<b>>>0):p=P+1,b=p,P=0;256<=b;)P+=8,b>>=8;return b=7^P+wr[b],l.b-=b,l.Ca=(p<<b)-1,E}function ke(l,u,p){l[u+0]=p>>24&255,l[u+1]=p>>16&255,l[u+2]=p>>8&255,l[u+3]=p>>0&255}function _e(l,u){return l[u+0]<<0|l[u+1]<<8}function Ce(l,u){return _e(l,u)|l[u+2]<<16}function Ee(l,u){return _e(l,u)|_e(l,u+2)<<16}function Ve(l,u){var p=1<<u;return t(l!=null),t(0<u),l.X=i(p),l.X==null?0:(l.Mb=32-u,l.Xa=u,1)}function ye(l,u){t(l!=null),t(u!=null),t(l.Xa==u.Xa),a(u.X,0,l.X,0,1<<u.Xa)}function te(){this.X=[],this.Xa=this.Mb=0}function et(l,u,p,b){t(p!=null),t(b!=null);var P=p[0],E=b[0];return P==0&&(P=(l*E+u/2)/u),E==0&&(E=(u*P+l/2)/l),0>=P||0>=E?0:(p[0]=P,b[0]=E,1)}function Re(l,u){return l+(1<<u)-1>>>u}function Le(l,u){return((4278255360&l)+(4278255360&u)>>>0&4278255360)+((16711935&l)+(16711935&u)>>>0&16711935)>>>0}function Ae(l,u){M[u]=function(p,b,P,E,F,T,D){var z;for(z=0;z<F;++z){var ne=M[l](T[D+z-1],P,E+z);T[D+z]=Le(p[b+z],ne)}}}function Me(){this.ud=this.hd=this.jd=0}function Ie(l,u){return((4278124286&(l^u))>>>1)+(l&u)>>>0}function qe(l){return 0<=l&&256>l?l:0>l?0:255<l?255:void 0}function Ke(l,u){return qe(l+(l-u+.5>>1))}function nt(l,u,p){return Math.abs(u-p)-Math.abs(l-p)}function at(l,u,p,b,P,E,F){for(b=E[F-1],p=0;p<P;++p)E[F+p]=b=Le(l[u+p],b)}function lt(l,u,p,b,P){var E;for(E=0;E<p;++E){var F=l[u+E],T=F>>8&255,D=16711935&(D=(D=16711935&F)+((T<<16)+T));b[P+E]=(4278255360&F)+D>>>0}}function wt(l,u){u.jd=l>>0&255,u.hd=l>>8&255,u.ud=l>>16&255}function Ye(l,u,p,b,P,E){var F;for(F=0;F<b;++F){var T=u[p+F],D=T>>>8,z=T,ne=255&(ne=(ne=T>>>16)+((l.jd<<24>>24)*(D<<24>>24)>>>5));z=255&(z=(z=z+((l.hd<<24>>24)*(D<<24>>24)>>>5))+((l.ud<<24>>24)*(ne<<24>>24)>>>5)),P[E+F]=(4278255360&T)+(ne<<16)+z}}function st(l,u,p,b,P){M[u]=function(E,F,T,D,z,ne,he,fe,oe){for(D=he;D<fe;++D)for(he=0;he<oe;++he)z[ne++]=P(T[b(E[F++])])},M[l]=function(E,F,T,D,z,ne,he){var fe=8>>E.b,oe=E.Ea,we=E.K[0],pe=E.w;if(8>fe)for(E=(1<<E.b)-1,pe=(1<<fe)-1;F<T;++F){var ae,se=0;for(ae=0;ae<oe;++ae)ae&E||(se=b(D[z++])),ne[he++]=P(we[se&pe]),se>>=fe}else M["VP8LMapColor"+p](D,z,we,pe,ne,he,F,T,oe)}}function Te(l,u,p,b,P){for(p=u+p;u<p;){var E=l[u++];b[P++]=E>>16&255,b[P++]=E>>8&255,b[P++]=E>>0&255}}function ir(l,u,p,b,P){for(p=u+p;u<p;){var E=l[u++];b[P++]=E>>16&255,b[P++]=E>>8&255,b[P++]=E>>0&255,b[P++]=E>>24&255}}function ut(l,u,p,b,P){for(p=u+p;u<p;){var E=(F=l[u++])>>16&240|F>>12&15,F=F>>0&240|F>>28&15;b[P++]=E,b[P++]=F}}function Hr(l,u,p,b,P){for(p=u+p;u<p;){var E=(F=l[u++])>>16&248|F>>13&7,F=F>>5&224|F>>3&31;b[P++]=E,b[P++]=F}}function jt(l,u,p,b,P){for(p=u+p;u<p;){var E=l[u++];b[P++]=E>>0&255,b[P++]=E>>8&255,b[P++]=E>>16&255}}function Ct(l,u,p,b,P,E){if(E==0)for(p=u+p;u<p;)ke(b,((E=l[u++])[0]>>24|E[1]>>8&65280|E[2]<<8&16711680|E[3]<<24)>>>0),P+=32;else a(b,P,l,u,p)}function on(l,u){M[u][0]=M[l+"0"],M[u][1]=M[l+"1"],M[u][2]=M[l+"2"],M[u][3]=M[l+"3"],M[u][4]=M[l+"4"],M[u][5]=M[l+"5"],M[u][6]=M[l+"6"],M[u][7]=M[l+"7"],M[u][8]=M[l+"8"],M[u][9]=M[l+"9"],M[u][10]=M[l+"10"],M[u][11]=M[l+"11"],M[u][12]=M[l+"12"],M[u][13]=M[l+"13"],M[u][14]=M[l+"0"],M[u][15]=M[l+"0"]}function mt(l){return l==ml||l==gl||l==Yi||l==pl}function ia(){this.eb=[],this.size=this.A=this.fb=0}function It(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Wr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ia,this.f.kb=new It,this.sd=null}function Nn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Xe(l){return alert("todo:WebPSamplerProcessPlane"),l.T}function gt(l,u){var p=l.T,b=u.ba.f.RGBA,P=b.eb,E=b.fb+l.ka*b.A,F=zr[u.ba.S],T=l.y,D=l.O,z=l.f,ne=l.N,he=l.ea,fe=l.W,oe=u.cc,we=u.dc,pe=u.Mc,ae=u.Nc,se=l.ka,ve=l.ka+l.T,Ne=l.U,be=Ne+1>>1;for(se==0?F(T,D,null,null,z,ne,he,fe,z,ne,he,fe,P,E,null,null,Ne):(F(u.ec,u.fc,T,D,oe,we,pe,ae,z,ne,he,fe,P,E-b.A,P,E,Ne),++p);se+2<ve;se+=2)oe=z,we=ne,pe=he,ae=fe,ne+=l.Rc,fe+=l.Rc,E+=2*b.A,F(T,(D+=2*l.fa)-l.fa,T,D,oe,we,pe,ae,z,ne,he,fe,P,E-b.A,P,E,Ne);return D+=l.fa,l.j+ve<l.o?(a(u.ec,u.fc,T,D,Ne),a(u.cc,u.dc,z,ne,be),a(u.Mc,u.Nc,he,fe,be),p--):1&ve||F(T,D,null,null,z,ne,he,fe,z,ne,he,fe,P,E+b.A,null,null,Ne),p}function oa(l,u,p){var b=l.F,P=[l.J];if(b!=null){var E=l.U,F=u.ba.S,T=F==Gi||F==Yi;u=u.ba.f.RGBA;var D=[0],z=l.ka;D[0]=l.T,l.Kb&&(z==0?--D[0]:(--z,P[0]-=l.width),l.j+l.ka+l.T==l.o&&(D[0]=l.o-l.j-z));var ne=u.eb;z=u.fb+z*u.A,l=Lt(b,P[0],l.width,E,D,ne,z+(T?0:3),u.A),t(p==D),l&&mt(F)&&Rr(ne,z,T,E,D,u.A)}return 0}function nr(l){var u=l.ma,p=u.ba.S,b=11>p,P=p==Wi||p==Vi||p==Gi||p==fl||p==12||mt(p);if(u.memory=null,u.Ib=null,u.Jb=null,u.Nd=null,!Os(u.Oa,l,P?11:12))return 0;if(P&&mt(p)&&Se(),l.da)alert("todo:use_scaling");else{if(b){if(u.Ib=Xe,l.Kb){if(p=l.U+1>>1,u.memory=i(l.U+2*p),u.memory==null)return 0;u.ec=u.memory,u.fc=0,u.cc=u.ec,u.dc=u.fc+l.U,u.Mc=u.cc,u.Nc=u.dc+p,u.Ib=gt,Se()}}else alert("todo:EmitYUV");P&&(u.Jb=oa,b&&ce())}if(b&&!qc){for(l=0;256>l;++l)Nh[l]=89858*(l-128)+Ji>>$i,_h[l]=-22014*(l-128)+Ji,Sh[l]=-45773*(l-128),jh[l]=113618*(l-128)+Ji>>$i;for(l=Vs;l<vl;++l)u=76283*(l-16)+Ji>>$i,kh[l-Vs]=Pr(u,255),Lh[l-Vs]=Pr(u+8>>4,15);qc=1}return 1}function ln(l){var u=l.ma,p=l.U,b=l.T;return t(!(1&l.ka)),0>=p||0>=b?0:(p=u.Ib(l,u),u.Jb!=null&&u.Jb(l,u,p),u.Dc+=p,1)}function cn(l){l.ma.memory=null}function We(l,u,p,b){return ie(l,8)!=47?0:(u[0]=ie(l,14)+1,p[0]=ie(l,14)+1,b[0]=ie(l,1),ie(l,3)!=0?0:!l.h)}function Vr(l,u){if(4>l)return l+1;var p=l-2>>1;return(2+(1&l)<<p)+ie(u,p)+1}function dn(l,u){return 120<u?u-120:1<=(p=((p=lh[u-1])>>4)*l+(8-(15&p)))?p:1;var p}function vr(l,u,p){var b=B(p),P=l[u+=255&b].g-8;return 0<P&&(X(p,p.u+8),b=B(p),u+=l[u].value,u+=b&(1<<P)-1),X(p,p.u+l[u].g),l[u].value}function $t(l,u,p){return p.g+=l.g,p.value+=l.value<<u>>>0,t(8>=p.g),l.g}function Wt(l,u,p){var b=l.xc;return t((u=b==0?0:l.vc[l.md*(p>>b)+(u>>b)])<l.Wb),l.Ya[u]}function Ar(l,u,p,b){var P=l.ab,E=l.c*u,F=l.C;u=F+u;var T=p,D=b;for(b=l.Ta,p=l.Ua;0<P--;){var z=l.gc[P],ne=F,he=u,fe=T,oe=D,we=(D=b,T=p,z.Ea);switch(t(ne<he),t(he<=z.nc),z.hc){case 2:Di(fe,oe,(he-ne)*we,D,T);break;case 0:var pe=ne,ae=he,se=D,ve=T,Ne=(Fe=z).Ea;pe==0&&(ul(fe,oe,null,null,1,se,ve),at(fe,oe+1,0,0,Ne-1,se,ve+1),oe+=Ne,ve+=Ne,++pe);for(var be=1<<Fe.b,De=be-1,Pe=Re(Ne,Fe.b),He=Fe.K,Fe=Fe.w+(pe>>Fe.b)*Pe;pe<ae;){var ht=He,pt=Fe,ct=1;for(Rs(fe,oe,se,ve-Ne,1,se,ve);ct<Ne;){var it=(ct&~De)+be;it>Ne&&(it=Ne),(0,Dn[ht[pt++]>>8&15])(fe,oe+ +ct,se,ve+ct-Ne,it-ct,se,ve+ct),ct=it}oe+=Ne,ve+=Ne,++pe&De||(Fe+=Pe)}he!=z.nc&&a(D,T-we,D,T+(he-ne-1)*we,we);break;case 1:for(we=fe,ae=oe,Ne=(fe=z.Ea)-(ve=fe&~(se=(oe=1<<z.b)-1)),pe=Re(fe,z.b),be=z.K,z=z.w+(ne>>z.b)*pe;ne<he;){for(De=be,Pe=z,He=new Me,Fe=ae+ve,ht=ae+fe;ae<Fe;)wt(De[Pe++],He),fa(He,we,ae,oe,D,T),ae+=oe,T+=oe;ae<ht&&(wt(De[Pe++],He),fa(He,we,ae,Ne,D,T),ae+=Ne,T+=Ne),++ne&se||(z+=pe)}break;case 3:if(fe==D&&oe==T&&0<z.b){for(ae=D,fe=we=T+(he-ne)*we-(ve=(he-ne)*Re(z.Ea,z.b)),oe=D,se=T,pe=[],ve=(Ne=ve)-1;0<=ve;--ve)pe[ve]=oe[se+ve];for(ve=Ne-1;0<=ve;--ve)ae[fe+ve]=pe[ve];Or(z,ne,he,D,we,D,T)}else Or(z,ne,he,fe,oe,D,T)}T=b,D=p}D!=p&&a(b,p,T,D,E)}function Ea(l,u){var p=l.V,b=l.Ba+l.c*l.C,P=u-l.C;if(t(u<=l.l.o),t(16>=P),0<P){var E=l.l,F=l.Ta,T=l.Ua,D=E.width;if(Ar(l,P,p,b),P=T=[T],t((p=l.C)<(b=u)),t(E.v<E.va),b>E.o&&(b=E.o),p<E.j){var z=E.j-p;p=E.j,P[0]+=z*D}if(p>=b?p=0:(P[0]+=4*E.v,E.ka=p-E.j,E.U=E.va-E.v,E.T=b-p,p=1),p){if(T=T[0],11>(p=l.ca).S){var ne=p.f.RGBA,he=(b=p.S,P=E.U,E=E.T,z=ne.eb,ne.A),fe=E;for(ne=ne.fb+l.Ma*ne.A;0<fe--;){var oe=F,we=T,pe=P,ae=z,se=ne;switch(b){case Hi:Nr(oe,we,pe,ae,se);break;case Wi:mr(oe,we,pe,ae,se);break;case ml:mr(oe,we,pe,ae,se),Rr(ae,se,0,pe,1,0);break;case Cc:Ln(oe,we,pe,ae,se);break;case Vi:Ct(oe,we,pe,ae,se,1);break;case gl:Ct(oe,we,pe,ae,se,1),Rr(ae,se,0,pe,1,0);break;case Gi:Ct(oe,we,pe,ae,se,0);break;case Yi:Ct(oe,we,pe,ae,se,0),Rr(ae,se,1,pe,1,0);break;case fl:Bn(oe,we,pe,ae,se);break;case pl:Bn(oe,we,pe,ae,se),kt(ae,se,pe,1,0);break;case Ec:kn(oe,we,pe,ae,se);break;default:t(0)}T+=D,ne+=he}l.Ma+=E}else alert("todo:EmitRescaledRowsYUVA");t(l.Ma<=p.height)}}l.C=u,t(l.C<=l.i)}function jn(l){var u;if(0<l.ua)return 0;for(u=0;u<l.Wb;++u){var p=l.Ya[u].G,b=l.Ya[u].H;if(0<p[1][b[1]+0].g||0<p[2][b[2]+0].g||0<p[3][b[3]+0].g)return 0}return 1}function Gr(l,u,p,b,P,E){if(l.Z!=0){var F=l.qd,T=l.rd;for(t(Un[l.Z]!=null);u<p;++u)Un[l.Z](F,T,b,P,b,P,E),F=b,T=P,P+=E;l.qd=F,l.rd=T}}function Yr(l,u){var p=l.l.ma,b=p.Z==0||p.Z==1?l.l.j:l.C;if(b=l.C<b?b:l.C,t(u<=l.l.o),u>b){var P=l.l.width,E=p.ca,F=p.tb+P*b,T=l.V,D=l.Ba+l.c*b,z=l.gc;t(l.ab==1),t(z[0].hc==3),Bi(z[0],b,u,T,D,E,F),Gr(p,b,u,E,F,P)}l.C=l.Ma=u}function $r(l,u,p,b,P,E,F){var T=l.$/b,D=l.$%b,z=l.m,ne=l.s,he=p+l.$,fe=he;P=p+b*P;var oe=p+b*E,we=280+ne.ua,pe=l.Pb?T:16777216,ae=0<ne.ua?ne.Wa:null,se=ne.wc,ve=he<oe?Wt(ne,D,T):null;t(l.C<E),t(oe<=P);var Ne=!1;e:for(;;){for(;Ne||he<oe;){var be=0;if(T>=pe){var De=he-p;t((pe=l).Pb),pe.wd=pe.m,pe.xd=De,0<pe.s.ua&&ye(pe.s.Wa,pe.s.vb),pe=T+dh}if(D&se||(ve=Wt(ne,D,T)),t(ve!=null),ve.Qb&&(u[he]=ve.qb,Ne=!0),!Ne)if(ee(z),ve.jc){be=z,De=u;var Pe=he,He=ve.pd[B(be)&ar-1];t(ve.jc),256>He.g?(X(be,be.u+He.g),De[Pe]=He.value,be=0):(X(be,be.u+He.g-256),t(256<=He.value),be=He.value),be==0&&(Ne=!0)}else be=vr(ve.G[0],ve.H[0],z);if(z.h)break;if(Ne||256>be){if(!Ne)if(ve.nd)u[he]=(ve.qb|be<<8)>>>0;else{if(ee(z),Ne=vr(ve.G[1],ve.H[1],z),ee(z),De=vr(ve.G[2],ve.H[2],z),Pe=vr(ve.G[3],ve.H[3],z),z.h)break;u[he]=(Pe<<24|Ne<<16|be<<8|De)>>>0}if(Ne=!1,++he,++D>=b&&(D=0,++T,F!=null&&T<=E&&!(T%16)&&F(l,T),ae!=null))for(;fe<he;)be=u[fe++],ae.X[(506832829*be&4294967295)>>>ae.Mb]=be}else if(280>be){if(be=Vr(be-256,z),De=vr(ve.G[4],ve.H[4],z),ee(z),De=dn(b,De=Vr(De,z)),z.h)break;if(he-p<De||P-he<be)break e;for(Pe=0;Pe<be;++Pe)u[he+Pe]=u[he+Pe-De];for(he+=be,D+=be;D>=b;)D-=b,++T,F!=null&&T<=E&&!(T%16)&&F(l,T);if(t(he<=P),D&se&&(ve=Wt(ne,D,T)),ae!=null)for(;fe<he;)be=u[fe++],ae.X[(506832829*be&4294967295)>>>ae.Mb]=be}else{if(!(be<we))break e;for(Ne=be-280,t(ae!=null);fe<he;)be=u[fe++],ae.X[(506832829*be&4294967295)>>>ae.Mb]=be;be=he,t(!(Ne>>>(De=ae).Xa)),u[be]=De.X[Ne],Ne=!0}Ne||t(z.h==U(z))}if(l.Pb&&z.h&&he<P)t(l.m.h),l.a=5,l.m=l.wd,l.$=l.xd,0<l.s.ua&&ye(l.s.vb,l.s.Wa);else{if(z.h)break e;F!=null&&F(l,T>E?E:T),l.a=0,l.$=he-p}return 1}return l.a=3,0}function un(l){t(l!=null),l.vc=null,l.yc=null,l.Ya=null;var u=l.Wa;u!=null&&(u.X=null),l.vb=null,t(l!=null)}function Tr(){var l=new dl;return l==null?null:(l.a=0,l.xb=Mc,on("Predictor","VP8LPredictors"),on("Predictor","VP8LPredictors_C"),on("PredictorAdd","VP8LPredictorsAdd"),on("PredictorAdd","VP8LPredictorsAdd_C"),Di=lt,fa=Ye,Nr=Te,mr=ir,Bn=ut,kn=Hr,Ln=jt,M.VP8LMapColor32b=Xa,M.VP8LMapColor8b=Ri,l)}function hn(l,u,p,b,P){var E=1,F=[l],T=[u],D=b.m,z=b.s,ne=null,he=0;e:for(;;){if(p)for(;E&&ie(D,1);){var fe=F,oe=T,we=b,pe=1,ae=we.m,se=we.gc[we.ab],ve=ie(ae,2);if(we.Oc&1<<ve)E=0;else{switch(we.Oc|=1<<ve,se.hc=ve,se.Ea=fe[0],se.nc=oe[0],se.K=[null],++we.ab,t(4>=we.ab),ve){case 0:case 1:se.b=ie(ae,3)+2,pe=hn(Re(se.Ea,se.b),Re(se.nc,se.b),0,we,se.K),se.K=se.K[0];break;case 3:var Ne,be=ie(ae,8)+1,De=16<be?0:4<be?1:2<be?2:3;if(fe[0]=Re(se.Ea,De),se.b=De,Ne=pe=hn(be,1,0,we,se.K)){var Pe,He=be,Fe=se,ht=1<<(8>>Fe.b),pt=i(ht);if(pt==null)Ne=0;else{var ct=Fe.K[0],it=Fe.w;for(pt[0]=Fe.K[0][0],Pe=1;Pe<1*He;++Pe)pt[Pe]=Le(ct[it+Pe],pt[Pe-1]);for(;Pe<4*ht;++Pe)pt[Pe]=0;Fe.K[0]=null,Fe.K[0]=pt,Ne=1}}pe=Ne;break;case 2:break;default:t(0)}E=pe}}if(F=F[0],T=T[0],E&&ie(D,1)&&!(E=1<=(he=ie(D,4))&&11>=he)){b.a=3;break e}var St;if(St=E)t:{var Nt,rt,Gt,jr=b,Yt=F,Sr=T,xt=he,Er=p,Fr=jr.m,er=jr.s,sr=[null],pr=1,Ur=0,pn=ch[xt];r:for(;;){if(Er&&ie(Fr,1)){var tr=ie(Fr,3)+2,En=Re(Yt,tr),ya=Re(Sr,tr),rs=En*ya;if(!hn(En,ya,0,jr,sr))break r;for(sr=sr[0],er.xc=tr,Nt=0;Nt<rs;++Nt){var Hn=sr[Nt]>>8&65535;sr[Nt]=Hn,Hn>=pr&&(pr=Hn+1)}}if(Fr.h)break r;for(rt=0;5>rt;++rt){var Ot=Fc[rt];!rt&&0<xt&&(Ot+=1<<xt),Ur<Ot&&(Ur=Ot)}var bl=o(pr*pn,_),Hc=pr,Wc=o(Hc,H);if(Wc==null)var Xi=null;else t(65536>=Hc),Xi=Wc;var Gs=i(Ur);if(Xi==null||Gs==null||bl==null){jr.a=1;break r}var Qi=bl;for(Nt=Gt=0;Nt<pr;++Nt){var Zr=Xi[Nt],ns=Zr.G,as=Zr.H,Vc=0,Zi=1,Gc=0;for(rt=0;5>rt;++rt){Ot=Fc[rt],ns[rt]=Qi,as[rt]=Gt,!rt&&0<xt&&(Ot+=1<<xt);a:{var eo,wl=Ot,to=jr,Ys=Gs,Ch=Qi,Eh=Gt,Nl=0,Wn=to.m,Fh=ie(Wn,1);if(s(Ys,0,0,wl),Fh){var Ih=ie(Wn,1)+1,Mh=ie(Wn,1),Yc=ie(Wn,Mh==0?1:8);Ys[Yc]=1,Ih==2&&(Ys[Yc=ie(Wn,8)]=1);var ro=1}else{var $c=i(19),Jc=ie(Wn,4)+4;if(19<Jc){to.a=3;var no=0;break a}for(eo=0;eo<Jc;++eo)$c[oh[eo]]=ie(Wn,3);var jl=void 0,$s=void 0,Kc=to,Th=$c,ao=wl,Xc=Ys,Sl=0,Vn=Kc.m,Qc=8,Zc=o(128,_);n:for(;A(Zc,0,7,Th,19);){if(ie(Vn,1)){var Oh=2+2*ie(Vn,3);if((jl=2+ie(Vn,Oh))>ao)break n}else jl=ao;for($s=0;$s<ao&&jl--;){ee(Vn);var ed=Zc[0+(127&B(Vn))];X(Vn,Vn.u+ed.g);var ss=ed.value;if(16>ss)Xc[$s++]=ss,ss!=0&&(Qc=ss);else{var Dh=ss==16,td=ss-16,Bh=sh[td],rd=ie(Vn,ah[td])+Bh;if($s+rd>ao)break n;for(var Rh=Dh?Qc:0;0<rd--;)Xc[$s++]=Rh}}Sl=1;break n}Sl||(Kc.a=3),ro=Sl}(ro=ro&&!Wn.h)&&(Nl=A(Ch,Eh,8,Ys,wl)),ro&&Nl!=0?no=Nl:(to.a=3,no=0)}if(no==0)break r;if(Zi&&ih[rt]==1&&(Zi=Qi[Gt].g==0),Vc+=Qi[Gt].g,Gt+=no,3>=rt){var Js,_l=Gs[0];for(Js=1;Js<Ot;++Js)Gs[Js]>_l&&(_l=Gs[Js]);Gc+=_l}}if(Zr.nd=Zi,Zr.Qb=0,Zi&&(Zr.qb=(ns[3][as[3]+0].value<<24|ns[1][as[1]+0].value<<16|ns[2][as[2]+0].value)>>>0,Vc==0&&256>ns[0][as[0]+0].value&&(Zr.Qb=1,Zr.qb+=ns[0][as[0]+0].value<<8)),Zr.jc=!Zr.Qb&&6>Gc,Zr.jc){var so,Fn=Zr;for(so=0;so<ar;++so){var Gn=so,Yn=Fn.pd[Gn],io=Fn.G[0][Fn.H[0]+Gn];256<=io.value?(Yn.g=io.g+256,Yn.value=io.value):(Yn.g=0,Yn.value=0,Gn>>=$t(io,8,Yn),Gn>>=$t(Fn.G[1][Fn.H[1]+Gn],16,Yn),Gn>>=$t(Fn.G[2][Fn.H[2]+Gn],0,Yn),$t(Fn.G[3][Fn.H[3]+Gn],24,Yn))}}}er.vc=sr,er.Wb=pr,er.Ya=Xi,er.yc=bl,St=1;break t}St=0}if(!(E=St)){b.a=3;break e}if(0<he){if(z.ua=1<<he,!Ve(z.Wa,he)){b.a=1,E=0;break e}}else z.ua=0;var kl=b,nd=F,qh=T,Ll=kl.s,Al=Ll.xc;if(kl.c=nd,kl.i=qh,Ll.md=Re(nd,Al),Ll.wc=Al==0?-1:(1<<Al)-1,p){b.xb=xh;break e}if((ne=i(F*T))==null){b.a=1,E=0;break e}E=(E=$r(b,ne,0,F,T,T,null))&&!D.h;break e}return E?(P!=null?P[0]=ne:(t(ne==null),t(p)),b.$=0,p||un(z)):un(z),E}function la(l,u){var p=l.c*l.i,b=p+u+16*u;return t(l.c<=u),l.V=i(b),l.V==null?(l.Ta=null,l.Ua=0,l.a=1,0):(l.Ta=l.V,l.Ua=l.Ba+p+u,1)}function Fa(l,u){var p=l.C,b=u-p,P=l.V,E=l.Ba+l.c*p;for(t(u<=l.l.o);0<b;){var F=16<b?16:b,T=l.l.ma,D=l.l.width,z=D*F,ne=T.ca,he=T.tb+D*p,fe=l.Ta,oe=l.Ua;Ar(l,F,P,E),qt(fe,oe,ne,he,z),Gr(T,p,p+F,ne,he,D),b-=F,P+=F*l.c,p+=F}t(p==u),l.C=l.Ma=u}function Ia(){this.ub=this.yd=this.td=this.Rb=0}function Ma(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ta(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function xi(){this.Yb=function(){var l=[];return function u(p,b,P){for(var E=P[b],F=0;F<E&&(p.push(P.length>b+1?[]:0),!(P.length<b+1));F++)u(p[F],b+1,P)}(l,0,[3,11]),l}()}function zo(){this.jb=i(3),this.Wc=c([4,8],xi),this.Xc=c([4,17],xi)}function Uo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Oa(){this.ld=this.La=this.dd=this.tc=0}function yi(){this.Na=this.la=0}function Ho(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function bs(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Wo(){this.uc=this.M=this.Nb=0,this.wa=Array(new Oa),this.Y=0,this.ya=Array(new bs),this.aa=0,this.l=new Da}function vi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Vo(){this.cb=this.a=0,this.sc="",this.m=new ge,this.Od=new Ia,this.Kc=new Ma,this.ed=new Uo,this.Qa=new Ta,this.Ic=this.$c=this.Aa=0,this.D=new Wo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ge),this.ia=0,this.pb=o(4,Ho),this.Pa=new zo,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new vi),this.Hd=0,this.rb=Array(new yi),this.sb=0,this.wa=Array(new Oa),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new bs),this.L=this.aa=0,this.gd=c([4,2],Oa),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Da(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Go(){var l=new Vo;return l!=null&&(l.a=0,l.sc="OK",l.cb=0,l.Xb=0,Ws||(Ws=Ni)),l}function Bt(l,u,p){return l.a==0&&(l.a=u,l.sc=p,l.cb=0),0}function bi(l,u,p){return 3<=p&&l[u+0]==157&&l[u+1]==1&&l[u+2]==42}function wi(l,u){if(l==null)return 0;if(l.a=0,l.sc="OK",u==null)return Bt(l,2,"null VP8Io passed to VP8GetHeaders()");var p=u.data,b=u.w,P=u.ha;if(4>P)return Bt(l,7,"Truncated header.");var E=p[b+0]|p[b+1]<<8|p[b+2]<<16,F=l.Od;if(F.Rb=!(1&E),F.td=E>>1&7,F.yd=E>>4&1,F.ub=E>>5,3<F.td)return Bt(l,3,"Incorrect keyframe parameters.");if(!F.yd)return Bt(l,4,"Frame not displayable.");b+=3,P-=3;var T=l.Kc;if(F.Rb){if(7>P)return Bt(l,7,"cannot parse picture header");if(!bi(p,b,P))return Bt(l,3,"Bad code word");T.c=16383&(p[b+4]<<8|p[b+3]),T.Td=p[b+4]>>6,T.i=16383&(p[b+6]<<8|p[b+5]),T.Ud=p[b+6]>>6,b+=7,P-=7,l.za=T.c+15>>4,l.Ub=T.i+15>>4,u.width=T.c,u.height=T.i,u.Da=0,u.j=0,u.v=0,u.va=u.width,u.o=u.height,u.da=0,u.ib=u.width,u.hb=u.height,u.U=u.width,u.T=u.height,s((E=l.Pa).jb,0,255,E.jb.length),t((E=l.Qa)!=null),E.Cb=0,E.Bb=0,E.Fb=1,s(E.Zb,0,0,E.Zb.length),s(E.Lb,0,0,E.Lb)}if(F.ub>P)return Bt(l,7,"bad partition length");le(E=l.m,p,b,F.ub),b+=F.ub,P-=F.ub,F.Rb&&(T.Ld=ue(E),T.Kd=ue(E)),T=l.Qa;var D,z=l.Pa;if(t(E!=null),t(T!=null),T.Cb=ue(E),T.Cb){if(T.Bb=ue(E),ue(E)){for(T.Fb=ue(E),D=0;4>D;++D)T.Zb[D]=ue(E)?V(E,7):0;for(D=0;4>D;++D)T.Lb[D]=ue(E)?V(E,6):0}if(T.Bb)for(D=0;3>D;++D)z.jb[D]=ue(E)?Y(E,8):255}else T.Bb=0;if(E.Ka)return Bt(l,3,"cannot parse segment header");if((T=l.ed).zd=ue(E),T.Tb=Y(E,6),T.wb=Y(E,3),T.Pc=ue(E),T.Pc&&ue(E)){for(z=0;4>z;++z)ue(E)&&(T.vd[z]=V(E,6));for(z=0;4>z;++z)ue(E)&&(T.od[z]=V(E,6))}if(l.L=T.Tb==0?0:T.zd?1:2,E.Ka)return Bt(l,3,"cannot parse filter header");var ne=P;if(P=D=b,b=D+ne,T=ne,l.Xb=(1<<Y(l.m,2))-1,ne<3*(z=l.Xb))p=7;else{for(D+=3*z,T-=3*z,ne=0;ne<z;++ne){var he=p[P+0]|p[P+1]<<8|p[P+2]<<16;he>T&&(he=T),le(l.Jc[+ne],p,D,he),D+=he,T-=he,P+=3}le(l.Jc[+z],p,D,T),p=D<b?0:5}if(p!=0)return Bt(l,p,"cannot parse partitions");for(p=Y(D=l.m,7),P=ue(D)?V(D,4):0,b=ue(D)?V(D,4):0,T=ue(D)?V(D,4):0,z=ue(D)?V(D,4):0,D=ue(D)?V(D,4):0,ne=l.Qa,he=0;4>he;++he){if(ne.Cb){var fe=ne.Zb[he];ne.Fb||(fe+=p)}else{if(0<he){l.pb[he]=l.pb[0];continue}fe=p}var oe=l.pb[he];oe.Sc[0]=xl[Pr(fe+P,127)],oe.Sc[1]=yl[Pr(fe+0,127)],oe.Eb[0]=2*xl[Pr(fe+b,127)],oe.Eb[1]=101581*yl[Pr(fe+T,127)]>>16,8>oe.Eb[1]&&(oe.Eb[1]=8),oe.Qc[0]=xl[Pr(fe+z,117)],oe.Qc[1]=yl[Pr(fe+D,127)],oe.lc=fe+D}if(!F.Rb)return Bt(l,4,"Not a key frame.");for(ue(E),F=l.Pa,p=0;4>p;++p){for(P=0;8>P;++P)for(b=0;3>b;++b)for(T=0;11>T;++T)z=me(E,gh[p][P][b][T])?Y(E,8):fh[p][P][b][T],F.Wc[p][P].Yb[b][T]=z;for(P=0;17>P;++P)F.Xc[p][P]=F.Wc[p][ph[P]]}return l.kc=ue(E),l.kc&&(l.Bd=Y(E,8)),l.cb=1}function Ni(l,u,p,b,P,E,F){var T=u[P].Yb[p];for(p=0;16>P;++P){if(!me(l,T[p+0]))return P;for(;!me(l,T[p+1]);)if(T=u[++P].Yb[0],p=0,P==16)return 16;var D=u[P+1].Yb;if(me(l,T[p+2])){var z=l,ne=0;if(me(z,(fe=T)[(he=p)+3]))if(me(z,fe[he+6])){for(T=0,he=2*(ne=me(z,fe[he+8]))+(fe=me(z,fe[he+9+ne])),ne=0,fe=uh[he];fe[T];++T)ne+=ne+me(z,fe[T]);ne+=3+(8<<he)}else me(z,fe[he+7])?(ne=7+2*me(z,165),ne+=me(z,145)):ne=5+me(z,159);else ne=me(z,fe[he+4])?3+me(z,fe[he+5]):2;T=D[2]}else ne=1,T=D[1];D=F+hh[P],0>(z=l).b&&de(z);var he,fe=z.b,oe=(he=z.Ca>>1)-(z.I>>fe)>>31;--z.b,z.Ca+=oe,z.Ca|=1,z.I-=(he+1&oe)<<fe,E[D]=((ne^oe)-oe)*b[(0<P)+0]}return 16}function ws(l){var u=l.rb[l.sb-1];u.la=0,u.Na=0,s(l.zc,0,0,l.zc.length),l.ja=0}function Yo(l,u){if(l==null)return 0;if(u==null)return Bt(l,2,"NULL VP8Io parameter in VP8Decode().");if(!l.cb&&!wi(l,u))return 0;if(t(l.cb),u.ac==null||u.ac(u)){u.ob&&(l.L=0);var p=Ki[l.L];if(l.L==2?(l.yb=0,l.zb=0):(l.yb=u.v-p>>4,l.zb=u.j-p>>4,0>l.yb&&(l.yb=0),0>l.zb&&(l.zb=0)),l.Va=u.o+15+p>>4,l.Hb=u.va+15+p>>4,l.Hb>l.za&&(l.Hb=l.za),l.Va>l.Ub&&(l.Va=l.Ub),0<l.L){var b=l.ed;for(p=0;4>p;++p){var P;if(l.Qa.Cb){var E=l.Qa.Lb[p];l.Qa.Fb||(E+=b.Tb)}else E=b.Tb;for(P=0;1>=P;++P){var F=l.gd[p][P],T=E;if(b.Pc&&(T+=b.vd[0],P&&(T+=b.od[0])),0<(T=0>T?0:63<T?63:T)){var D=T;0<b.wb&&(D=4<b.wb?D>>2:D>>1)>9-b.wb&&(D=9-b.wb),1>D&&(D=1),F.dd=D,F.tc=2*T+D,F.ld=40<=T?2:15<=T?1:0}else F.tc=0;F.La=P}}}p=0}else Bt(l,6,"Frame setup failed"),p=l.a;if(p=p==0){if(p){l.$c=0,0<l.Aa||(l.Ic=Ph);e:{p=l.Ic,b=4*(D=l.za);var z=32*D,ne=D+1,he=0<l.L?D*(0<l.Aa?2:1):0,fe=(l.Aa==2?2:1)*D;if((F=b+832+(P=3*(16*p+Ki[l.L])/2*z)+(E=l.Fa!=null&&0<l.Fa.length?l.Kc.c*l.Kc.i:0))!=F)p=0;else{if(F>l.Vb){if(l.Vb=0,l.Ec=i(F),l.Fc=0,l.Ec==null){p=Bt(l,1,"no memory during frame initialization.");break e}l.Vb=F}F=l.Ec,T=l.Fc,l.Ac=F,l.Bc=T,T+=b,l.Gd=o(z,vi),l.Hd=0,l.rb=o(ne+1,yi),l.sb=1,l.wa=he?o(he,Oa):null,l.Y=0,l.D.Nb=0,l.D.wa=l.wa,l.D.Y=l.Y,0<l.Aa&&(l.D.Y+=D),t(!0),l.oc=F,l.pc=T,T+=832,l.ya=o(fe,bs),l.aa=0,l.D.ya=l.ya,l.D.aa=l.aa,l.Aa==2&&(l.D.aa+=D),l.R=16*D,l.B=8*D,D=(z=Ki[l.L])*l.R,z=z/2*l.B,l.sa=F,l.ta=T+D,l.qa=l.sa,l.ra=l.ta+16*p*l.R+z,l.Ha=l.qa,l.Ia=l.ra+8*p*l.B+z,l.$c=0,T+=P,l.mb=E?F:null,l.nb=E?T:null,t(T+E<=l.Fc+l.Vb),ws(l),s(l.Ac,l.Bc,0,b),p=1}}if(p){if(u.ka=0,u.y=l.sa,u.O=l.ta,u.f=l.qa,u.N=l.ra,u.ea=l.Ha,u.Vd=l.Ia,u.fa=l.R,u.Rc=l.B,u.F=null,u.J=0,!zi){for(p=-255;255>=p;++p)Jt[255+p]=0>p?-p:p;for(p=-1020;1020>=p;++p)Pn[1020+p]=-128>p?-128:127<p?127:p;for(p=-112;112>=p;++p)Hs[112+p]=-16>p?-16:15<p?15:p;for(p=-255;510>=p;++p)ts[255+p]=0>p?0:255<p?255:p;zi=1}Qa=Ko,An=$o,qs=Si,gr=Jo,Dr=_i,Rt=ji,Za=Ls,qi=ua,zs=cl,ma=As,ga=ll,Rn=Ha,pa=Ps,es=Mi,xa=Ii,qn=mn,Us=_n,Br=ol,Qr[0]=fn,Qr[1]=Xo,Qr[2]=tl,Qr[3]=rl,Qr[4]=Ai,Qr[5]=za,Qr[6]=Pi,Qr[7]=Ss,Qr[8]=al,Qr[9]=nl,zn[0]=ki,zn[1]=Zo,zn[2]=Sn,zn[3]=Ra,zn[4]=or,zn[5]=el,zn[6]=Li,Cn[0]=Mn,Cn[1]=Qo,Cn[2]=sl,Cn[3]=_s,Cn[4]=da,Cn[5]=il,Cn[6]=ks,p=1}else p=0}p&&(p=function(oe,we){for(oe.M=0;oe.M<oe.Va;++oe.M){var pe,ae=oe.Jc[oe.M&oe.Xb],se=oe.m,ve=oe;for(pe=0;pe<ve.za;++pe){var Ne=se,be=ve,De=be.Ac,Pe=be.Bc+4*pe,He=be.zc,Fe=be.ya[be.aa+pe];if(be.Qa.Bb?Fe.$b=me(Ne,be.Pa.jb[0])?2+me(Ne,be.Pa.jb[2]):me(Ne,be.Pa.jb[1]):Fe.$b=0,be.kc&&(Fe.Ad=me(Ne,be.Bd)),Fe.Za=!me(Ne,145)+0,Fe.Za){var ht=Fe.Ob,pt=0;for(be=0;4>be;++be){var ct,it=He[0+be];for(ct=0;4>ct;++ct){it=mh[De[Pe+ct]][it];for(var St=Ic[me(Ne,it[0])];0<St;)St=Ic[2*St+me(Ne,it[St])];it=-St,De[Pe+ct]=it}a(ht,pt,De,Pe,4),pt+=4,He[0+be]=it}}else it=me(Ne,156)?me(Ne,128)?1:3:me(Ne,163)?2:0,Fe.Ob[0]=it,s(De,Pe,it,4),s(He,0,it,4);Fe.Dd=me(Ne,142)?me(Ne,114)?me(Ne,183)?1:3:2:0}if(ve.m.Ka)return Bt(oe,7,"Premature end-of-partition0 encountered.");for(;oe.ja<oe.za;++oe.ja){if(ve=ae,Ne=(se=oe).rb[se.sb-1],De=se.rb[se.sb+se.ja],pe=se.ya[se.aa+se.ja],Pe=se.kc?pe.Ad:0)Ne.la=De.la=0,pe.Za||(Ne.Na=De.Na=0),pe.Hc=0,pe.Gc=0,pe.ia=0;else{var Nt,rt;if(Ne=De,De=ve,Pe=se.Pa.Xc,He=se.ya[se.aa+se.ja],Fe=se.pb[He.$b],be=He.ad,ht=0,pt=se.rb[se.sb-1],it=ct=0,s(be,ht,0,384),He.Za)var Gt=0,jr=Pe[3];else{St=i(16);var Yt=Ne.Na+pt.Na;if(Yt=Ws(De,Pe[1],Yt,Fe.Eb,0,St,0),Ne.Na=pt.Na=(0<Yt)+0,1<Yt)Qa(St,0,be,ht);else{var Sr=St[0]+3>>3;for(St=0;256>St;St+=16)be[ht+St]=Sr}Gt=1,jr=Pe[0]}var xt=15&Ne.la,Er=15&pt.la;for(St=0;4>St;++St){var Fr=1&Er;for(Sr=rt=0;4>Sr;++Sr)xt=xt>>1|(Fr=(Yt=Ws(De,jr,Yt=Fr+(1&xt),Fe.Sc,Gt,be,ht))>Gt)<<7,rt=rt<<2|(3<Yt?3:1<Yt?2:be[ht+0]!=0),ht+=16;xt>>=4,Er=Er>>1|Fr<<7,ct=(ct<<8|rt)>>>0}for(jr=xt,Gt=Er>>4,Nt=0;4>Nt;Nt+=2){for(rt=0,xt=Ne.la>>4+Nt,Er=pt.la>>4+Nt,St=0;2>St;++St){for(Fr=1&Er,Sr=0;2>Sr;++Sr)Yt=Fr+(1&xt),xt=xt>>1|(Fr=0<(Yt=Ws(De,Pe[2],Yt,Fe.Qc,0,be,ht)))<<3,rt=rt<<2|(3<Yt?3:1<Yt?2:be[ht+0]!=0),ht+=16;xt>>=2,Er=Er>>1|Fr<<5}it|=rt<<4*Nt,jr|=xt<<4<<Nt,Gt|=(240&Er)<<Nt}Ne.la=jr,pt.la=Gt,He.Hc=ct,He.Gc=it,He.ia=43690&it?0:Fe.ia,Pe=!(ct|it)}if(0<se.L&&(se.wa[se.Y+se.ja]=se.gd[pe.$b][pe.Za],se.wa[se.Y+se.ja].La|=!Pe),ve.Ka)return Bt(oe,7,"Premature end-of-file encountered.")}if(ws(oe),se=we,ve=1,pe=(ae=oe).D,Ne=0<ae.L&&ae.M>=ae.zb&&ae.M<=ae.Va,ae.Aa==0)e:{if(pe.M=ae.M,pe.uc=Ne,Ts(ae,pe),ve=1,pe=(rt=ae.D).Nb,Ne=(it=Ki[ae.L])*ae.R,De=it/2*ae.B,St=16*pe*ae.R,Sr=8*pe*ae.B,Pe=ae.sa,He=ae.ta-Ne+St,Fe=ae.qa,be=ae.ra-De+Sr,ht=ae.Ha,pt=ae.Ia-De+Sr,Er=(xt=rt.M)==0,ct=xt>=ae.Va-1,ae.Aa==2&&Ts(ae,rt),rt.uc)for(Fr=(Yt=ae).D.M,t(Yt.D.uc),rt=Yt.yb;rt<Yt.Hb;++rt){Gt=rt,jr=Fr;var er=(sr=(Ot=Yt).D).Nb;Nt=Ot.R;var sr=sr.wa[sr.Y+Gt],pr=Ot.sa,Ur=Ot.ta+16*er*Nt+16*Gt,pn=sr.dd,tr=sr.tc;if(tr!=0)if(t(3<=tr),Ot.L==1)0<Gt&&qn(pr,Ur,Nt,tr+4),sr.La&&Br(pr,Ur,Nt,tr),0<jr&&xa(pr,Ur,Nt,tr+4),sr.La&&Us(pr,Ur,Nt,tr);else{var En=Ot.B,ya=Ot.qa,rs=Ot.ra+8*er*En+8*Gt,Hn=Ot.Ha,Ot=Ot.Ia+8*er*En+8*Gt;er=sr.ld,0<Gt&&(qi(pr,Ur,Nt,tr+4,pn,er),ma(ya,rs,Hn,Ot,En,tr+4,pn,er)),sr.La&&(Rn(pr,Ur,Nt,tr,pn,er),es(ya,rs,Hn,Ot,En,tr,pn,er)),0<jr&&(Za(pr,Ur,Nt,tr+4,pn,er),zs(ya,rs,Hn,Ot,En,tr+4,pn,er)),sr.La&&(ga(pr,Ur,Nt,tr,pn,er),pa(ya,rs,Hn,Ot,En,tr,pn,er))}}if(ae.ia&&alert("todo:DitherRow"),se.put!=null){if(rt=16*xt,xt=16*(xt+1),Er?(se.y=ae.sa,se.O=ae.ta+St,se.f=ae.qa,se.N=ae.ra+Sr,se.ea=ae.Ha,se.W=ae.Ia+Sr):(rt-=it,se.y=Pe,se.O=He,se.f=Fe,se.N=be,se.ea=ht,se.W=pt),ct||(xt-=it),xt>se.o&&(xt=se.o),se.F=null,se.J=null,ae.Fa!=null&&0<ae.Fa.length&&rt<xt&&(se.J=Is(ae,se,rt,xt-rt),se.F=ae.mb,se.F==null&&se.F.length==0)){ve=Bt(ae,3,"Could not decode alpha data.");break e}rt<se.j&&(it=se.j-rt,rt=se.j,t(!(1&it)),se.O+=ae.R*it,se.N+=ae.B*(it>>1),se.W+=ae.B*(it>>1),se.F!=null&&(se.J+=se.width*it)),rt<xt&&(se.O+=se.v,se.N+=se.v>>1,se.W+=se.v>>1,se.F!=null&&(se.J+=se.v),se.ka=rt-se.j,se.U=se.va-se.v,se.T=xt-rt,ve=se.put(se))}pe+1!=ae.Ic||ct||(a(ae.sa,ae.ta-Ne,Pe,He+16*ae.R,Ne),a(ae.qa,ae.ra-De,Fe,be+8*ae.B,De),a(ae.Ha,ae.Ia-De,ht,pt+8*ae.B,De))}if(!ve)return Bt(oe,6,"Output aborted.")}return 1}(l,u)),u.bc!=null&&u.bc(u),p&=1}return p?(l.cb=0,p):0}function Jr(l,u,p,b,P){P=l[u+p+32*b]+(P>>3),l[u+p+32*b]=-256&P?0>P?0:255:P}function Ba(l,u,p,b,P,E){Jr(l,u,0,p,b+P),Jr(l,u,1,p,b+E),Jr(l,u,2,p,b-E),Jr(l,u,3,p,b-P)}function br(l){return(20091*l>>16)+l}function Ns(l,u,p,b){var P,E=0,F=i(16);for(P=0;4>P;++P){var T=l[u+0]+l[u+8],D=l[u+0]-l[u+8],z=(35468*l[u+4]>>16)-br(l[u+12]),ne=br(l[u+4])+(35468*l[u+12]>>16);F[E+0]=T+ne,F[E+1]=D+z,F[E+2]=D-z,F[E+3]=T-ne,E+=4,u++}for(P=E=0;4>P;++P)T=(l=F[E+0]+4)+F[E+8],D=l-F[E+8],z=(35468*F[E+4]>>16)-br(F[E+12]),Jr(p,b,0,0,T+(ne=br(F[E+4])+(35468*F[E+12]>>16))),Jr(p,b,1,0,D+z),Jr(p,b,2,0,D-z),Jr(p,b,3,0,T-ne),E++,b+=32}function ji(l,u,p,b){var P=l[u+0]+4,E=35468*l[u+4]>>16,F=br(l[u+4]),T=35468*l[u+1]>>16;Ba(p,b,0,P+F,l=br(l[u+1]),T),Ba(p,b,1,P+E,l,T),Ba(p,b,2,P-E,l,T),Ba(p,b,3,P-F,l,T)}function $o(l,u,p,b,P){Ns(l,u,p,b),P&&Ns(l,u+16,p,b+4)}function Si(l,u,p,b){An(l,u+0,p,b,1),An(l,u+32,p,b+128,1)}function Jo(l,u,p,b){var P;for(l=l[u+0]+4,P=0;4>P;++P)for(u=0;4>u;++u)Jr(p,b,u,P,l)}function _i(l,u,p,b){l[u+0]&&gr(l,u+0,p,b),l[u+16]&&gr(l,u+16,p,b+4),l[u+32]&&gr(l,u+32,p,b+128),l[u+48]&&gr(l,u+48,p,b+128+4)}function Ko(l,u,p,b){var P,E=i(16);for(P=0;4>P;++P){var F=l[u+0+P]+l[u+12+P],T=l[u+4+P]+l[u+8+P],D=l[u+4+P]-l[u+8+P],z=l[u+0+P]-l[u+12+P];E[0+P]=F+T,E[8+P]=F-T,E[4+P]=z+D,E[12+P]=z-D}for(P=0;4>P;++P)F=(l=E[0+4*P]+3)+E[3+4*P],T=E[1+4*P]+E[2+4*P],D=E[1+4*P]-E[2+4*P],z=l-E[3+4*P],p[b+0]=F+T>>3,p[b+16]=z+D>>3,p[b+32]=F-T>>3,p[b+48]=z-D>>3,b+=64}function js(l,u,p){var b,P=u-32,E=Cr,F=255-l[P-1];for(b=0;b<p;++b){var T,D=E,z=F+l[u-1];for(T=0;T<p;++T)l[u+T]=D[z+l[P+T]];u+=32}}function Xo(l,u){js(l,u,4)}function Qo(l,u){js(l,u,8)}function Zo(l,u){js(l,u,16)}function Sn(l,u){var p;for(p=0;16>p;++p)a(l,u+32*p,l,u-32,16)}function Ra(l,u){var p;for(p=16;0<p;--p)s(l,u,l[u-1],16),u+=32}function qa(l,u,p){var b;for(b=0;16>b;++b)s(u,p+32*b,l,16)}function ki(l,u){var p,b=16;for(p=0;16>p;++p)b+=l[u-1+32*p]+l[u+p-32];qa(b>>5,l,u)}function or(l,u){var p,b=8;for(p=0;16>p;++p)b+=l[u-1+32*p];qa(b>>4,l,u)}function el(l,u){var p,b=8;for(p=0;16>p;++p)b+=l[u+p-32];qa(b>>4,l,u)}function Li(l,u){qa(128,l,u)}function Je(l,u,p){return l+2*u+p+2>>2}function tl(l,u){var p,b=u-32;for(b=new Uint8Array([Je(l[b-1],l[b+0],l[b+1]),Je(l[b+0],l[b+1],l[b+2]),Je(l[b+1],l[b+2],l[b+3]),Je(l[b+2],l[b+3],l[b+4])]),p=0;4>p;++p)a(l,u+32*p,b,0,b.length)}function rl(l,u){var p=l[u-1],b=l[u-1+32],P=l[u-1+64],E=l[u-1+96];ke(l,u+0,16843009*Je(l[u-1-32],p,b)),ke(l,u+32,16843009*Je(p,b,P)),ke(l,u+64,16843009*Je(b,P,E)),ke(l,u+96,16843009*Je(P,E,E))}function fn(l,u){var p,b=4;for(p=0;4>p;++p)b+=l[u+p-32]+l[u-1+32*p];for(b>>=3,p=0;4>p;++p)s(l,u+32*p,b,4)}function Ai(l,u){var p=l[u-1+0],b=l[u-1+32],P=l[u-1+64],E=l[u-1-32],F=l[u+0-32],T=l[u+1-32],D=l[u+2-32],z=l[u+3-32];l[u+0+96]=Je(b,P,l[u-1+96]),l[u+1+96]=l[u+0+64]=Je(p,b,P),l[u+2+96]=l[u+1+64]=l[u+0+32]=Je(E,p,b),l[u+3+96]=l[u+2+64]=l[u+1+32]=l[u+0+0]=Je(F,E,p),l[u+3+64]=l[u+2+32]=l[u+1+0]=Je(T,F,E),l[u+3+32]=l[u+2+0]=Je(D,T,F),l[u+3+0]=Je(z,D,T)}function Pi(l,u){var p=l[u+1-32],b=l[u+2-32],P=l[u+3-32],E=l[u+4-32],F=l[u+5-32],T=l[u+6-32],D=l[u+7-32];l[u+0+0]=Je(l[u+0-32],p,b),l[u+1+0]=l[u+0+32]=Je(p,b,P),l[u+2+0]=l[u+1+32]=l[u+0+64]=Je(b,P,E),l[u+3+0]=l[u+2+32]=l[u+1+64]=l[u+0+96]=Je(P,E,F),l[u+3+32]=l[u+2+64]=l[u+1+96]=Je(E,F,T),l[u+3+64]=l[u+2+96]=Je(F,T,D),l[u+3+96]=Je(T,D,D)}function za(l,u){var p=l[u-1+0],b=l[u-1+32],P=l[u-1+64],E=l[u-1-32],F=l[u+0-32],T=l[u+1-32],D=l[u+2-32],z=l[u+3-32];l[u+0+0]=l[u+1+64]=E+F+1>>1,l[u+1+0]=l[u+2+64]=F+T+1>>1,l[u+2+0]=l[u+3+64]=T+D+1>>1,l[u+3+0]=D+z+1>>1,l[u+0+96]=Je(P,b,p),l[u+0+64]=Je(b,p,E),l[u+0+32]=l[u+1+96]=Je(p,E,F),l[u+1+32]=l[u+2+96]=Je(E,F,T),l[u+2+32]=l[u+3+96]=Je(F,T,D),l[u+3+32]=Je(T,D,z)}function Ss(l,u){var p=l[u+0-32],b=l[u+1-32],P=l[u+2-32],E=l[u+3-32],F=l[u+4-32],T=l[u+5-32],D=l[u+6-32],z=l[u+7-32];l[u+0+0]=p+b+1>>1,l[u+1+0]=l[u+0+64]=b+P+1>>1,l[u+2+0]=l[u+1+64]=P+E+1>>1,l[u+3+0]=l[u+2+64]=E+F+1>>1,l[u+0+32]=Je(p,b,P),l[u+1+32]=l[u+0+96]=Je(b,P,E),l[u+2+32]=l[u+1+96]=Je(P,E,F),l[u+3+32]=l[u+2+96]=Je(E,F,T),l[u+3+64]=Je(F,T,D),l[u+3+96]=Je(T,D,z)}function nl(l,u){var p=l[u-1+0],b=l[u-1+32],P=l[u-1+64],E=l[u-1+96];l[u+0+0]=p+b+1>>1,l[u+2+0]=l[u+0+32]=b+P+1>>1,l[u+2+32]=l[u+0+64]=P+E+1>>1,l[u+1+0]=Je(p,b,P),l[u+3+0]=l[u+1+32]=Je(b,P,E),l[u+3+32]=l[u+1+64]=Je(P,E,E),l[u+3+64]=l[u+2+64]=l[u+0+96]=l[u+1+96]=l[u+2+96]=l[u+3+96]=E}function al(l,u){var p=l[u-1+0],b=l[u-1+32],P=l[u-1+64],E=l[u-1+96],F=l[u-1-32],T=l[u+0-32],D=l[u+1-32],z=l[u+2-32];l[u+0+0]=l[u+2+32]=p+F+1>>1,l[u+0+32]=l[u+2+64]=b+p+1>>1,l[u+0+64]=l[u+2+96]=P+b+1>>1,l[u+0+96]=E+P+1>>1,l[u+3+0]=Je(T,D,z),l[u+2+0]=Je(F,T,D),l[u+1+0]=l[u+3+32]=Je(p,F,T),l[u+1+32]=l[u+3+64]=Je(b,p,F),l[u+1+64]=l[u+3+96]=Je(P,b,p),l[u+1+96]=Je(E,P,b)}function sl(l,u){var p;for(p=0;8>p;++p)a(l,u+32*p,l,u-32,8)}function _s(l,u){var p;for(p=0;8>p;++p)s(l,u,l[u-1],8),u+=32}function ca(l,u,p){var b;for(b=0;8>b;++b)s(u,p+32*b,l,8)}function Mn(l,u){var p,b=8;for(p=0;8>p;++p)b+=l[u+p-32]+l[u-1+32*p];ca(b>>4,l,u)}function il(l,u){var p,b=4;for(p=0;8>p;++p)b+=l[u+p-32];ca(b>>3,l,u)}function da(l,u){var p,b=4;for(p=0;8>p;++p)b+=l[u-1+32*p];ca(b>>3,l,u)}function ks(l,u){ca(128,l,u)}function Ua(l,u,p){var b=l[u-p],P=l[u+0],E=3*(P-b)+hl[1020+l[u-2*p]-l[u+p]],F=Ui[112+(E+4>>3)];l[u-p]=Cr[255+b+Ui[112+(E+3>>3)]],l[u+0]=Cr[255+P-F]}function Ci(l,u,p,b){var P=l[u+0],E=l[u+p];return qr[255+l[u-2*p]-l[u-p]]>b||qr[255+E-P]>b}function Ei(l,u,p,b){return 4*qr[255+l[u-p]-l[u+0]]+qr[255+l[u-2*p]-l[u+p]]<=b}function Fi(l,u,p,b,P){var E=l[u-3*p],F=l[u-2*p],T=l[u-p],D=l[u+0],z=l[u+p],ne=l[u+2*p],he=l[u+3*p];return 4*qr[255+T-D]+qr[255+F-z]>b?0:qr[255+l[u-4*p]-E]<=P&&qr[255+E-F]<=P&&qr[255+F-T]<=P&&qr[255+he-ne]<=P&&qr[255+ne-z]<=P&&qr[255+z-D]<=P}function Ii(l,u,p,b){var P=2*b+1;for(b=0;16>b;++b)Ei(l,u+b,p,P)&&Ua(l,u+b,p)}function mn(l,u,p,b){var P=2*b+1;for(b=0;16>b;++b)Ei(l,u+b*p,1,P)&&Ua(l,u+b*p,1)}function _n(l,u,p,b){var P;for(P=3;0<P;--P)Ii(l,u+=4*p,p,b)}function ol(l,u,p,b){var P;for(P=3;0<P;--P)mn(l,u+=4,p,b)}function Tn(l,u,p,b,P,E,F,T){for(E=2*E+1;0<P--;){if(Fi(l,u,p,E,F))if(Ci(l,u,p,T))Ua(l,u,p);else{var D=l,z=u,ne=p,he=D[z-2*ne],fe=D[z-ne],oe=D[z+0],we=D[z+ne],pe=D[z+2*ne],ae=27*(ve=hl[1020+3*(oe-fe)+hl[1020+he-we]])+63>>7,se=18*ve+63>>7,ve=9*ve+63>>7;D[z-3*ne]=Cr[255+D[z-3*ne]+ve],D[z-2*ne]=Cr[255+he+se],D[z-ne]=Cr[255+fe+ae],D[z+0]=Cr[255+oe-ae],D[z+ne]=Cr[255+we-se],D[z+2*ne]=Cr[255+pe-ve]}u+=b}}function Kr(l,u,p,b,P,E,F,T){for(E=2*E+1;0<P--;){if(Fi(l,u,p,E,F))if(Ci(l,u,p,T))Ua(l,u,p);else{var D=l,z=u,ne=p,he=D[z-ne],fe=D[z+0],oe=D[z+ne],we=Ui[112+((pe=3*(fe-he))+4>>3)],pe=Ui[112+(pe+3>>3)],ae=we+1>>1;D[z-2*ne]=Cr[255+D[z-2*ne]+ae],D[z-ne]=Cr[255+he+pe],D[z+0]=Cr[255+fe-we],D[z+ne]=Cr[255+oe-ae]}u+=b}}function Ls(l,u,p,b,P,E){Tn(l,u,p,1,16,b,P,E)}function ua(l,u,p,b,P,E){Tn(l,u,1,p,16,b,P,E)}function ll(l,u,p,b,P,E){var F;for(F=3;0<F;--F)Kr(l,u+=4*p,p,1,16,b,P,E)}function Ha(l,u,p,b,P,E){var F;for(F=3;0<F;--F)Kr(l,u+=4,1,p,16,b,P,E)}function cl(l,u,p,b,P,E,F,T){Tn(l,u,P,1,8,E,F,T),Tn(p,b,P,1,8,E,F,T)}function As(l,u,p,b,P,E,F,T){Tn(l,u,1,P,8,E,F,T),Tn(p,b,1,P,8,E,F,T)}function Ps(l,u,p,b,P,E,F,T){Kr(l,u+4*P,P,1,8,E,F,T),Kr(p,b+4*P,P,1,8,E,F,T)}function Mi(l,u,p,b,P,E,F,T){Kr(l,u+4,1,P,8,E,F,T),Kr(p,b+4,1,P,8,E,F,T)}function Wa(){this.ba=new Wr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Cs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Es(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ti(){this.ua=0,this.Wa=new te,this.vb=new te,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new _}function dl(){this.xb=this.a=0,this.l=new Da,this.ca=new Wr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ti,this.ab=0,this.gc=o(4,Es),this.Oc=0}function Va(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Da,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ha(l,u,p,b,P,E,F){for(l=l==null?0:l[u+0],u=0;u<F;++u)P[E+u]=l+p[b+u]&255,l=P[E+u]}function Fs(l,u,p,b,P,E,F){var T;if(l==null)ha(null,null,p,b,P,E,F);else for(T=0;T<F;++T)P[E+T]=l[u+T]+p[b+T]&255}function On(l,u,p,b,P,E,F){if(l==null)ha(null,null,p,b,P,E,F);else{var T,D=l[u+0],z=D,ne=D;for(T=0;T<F;++T)z=ne+(D=l[u+T])-z,ne=p[b+T]+(-256&z?0>z?0:255:z)&255,z=D,P[E+T]=ne}}function Is(l,u,p,b){var P=u.width,E=u.o;if(t(l!=null&&u!=null),0>p||0>=b||p+b>E)return null;if(!l.Cc){if(l.ga==null){var F;if(l.ga=new Va,(F=l.ga==null)||(F=u.width*u.o,t(l.Gb.length==0),l.Gb=i(F),l.Uc=0,l.Gb==null?F=0:(l.mb=l.Gb,l.nb=l.Uc,l.rc=null,F=1),F=!F),!F){F=l.ga;var T=l.Fa,D=l.P,z=l.qc,ne=l.mb,he=l.nb,fe=D+1,oe=z-1,we=F.l;if(t(T!=null&&ne!=null&&u!=null),Un[0]=null,Un[1]=ha,Un[2]=Fs,Un[3]=On,F.ca=ne,F.tb=he,F.c=u.width,F.i=u.height,t(0<F.c&&0<F.i),1>=z)u=0;else if(F.$a=T[D+0]>>0&3,F.Z=T[D+0]>>2&3,F.Lc=T[D+0]>>4&3,D=T[D+0]>>6&3,0>F.$a||1<F.$a||4<=F.Z||1<F.Lc||D)u=0;else if(we.put=ln,we.ac=nr,we.bc=cn,we.ma=F,we.width=u.width,we.height=u.height,we.Da=u.Da,we.v=u.v,we.va=u.va,we.j=u.j,we.o=u.o,F.$a)e:{t(F.$a==1),u=Tr();t:for(;;){if(u==null){u=0;break e}if(t(F!=null),F.mc=u,u.c=F.c,u.i=F.i,u.l=F.l,u.l.ma=F,u.l.width=F.c,u.l.height=F.i,u.a=0,Z(u.m,T,fe,oe),!hn(F.c,F.i,1,u,null)||(u.ab==1&&u.gc[0].hc==3&&jn(u.s)?(F.ic=1,T=u.c*u.i,u.Ta=null,u.Ua=0,u.V=i(T),u.Ba=0,u.V==null?(u.a=1,u=0):u=1):(F.ic=0,u=la(u,F.c)),!u))break t;u=1;break e}F.mc=null,u=0}else u=oe>=F.c*F.i;F=!u}if(F)return null;l.ga.Lc!=1?l.Ga=0:b=E-p}t(l.ga!=null),t(p+b<=E);e:{if(u=(T=l.ga).c,E=T.l.o,T.$a==0){if(fe=l.rc,oe=l.Vc,we=l.Fa,D=l.P+1+p*u,z=l.mb,ne=l.nb+p*u,t(D<=l.P+l.qc),T.Z!=0)for(t(Un[T.Z]!=null),F=0;F<b;++F)Un[T.Z](fe,oe,we,D,z,ne,u),fe=z,oe=ne,ne+=u,D+=u;else for(F=0;F<b;++F)a(z,ne,we,D,u),fe=z,oe=ne,ne+=u,D+=u;l.rc=fe,l.Vc=oe}else{if(t(T.mc!=null),u=p+b,t((F=T.mc)!=null),t(u<=F.i),F.C>=u)u=1;else if(T.ic||ce(),T.ic){T=F.V,fe=F.Ba,oe=F.c;var pe=F.i,ae=(we=1,D=F.$/oe,z=F.$%oe,ne=F.m,he=F.s,F.$),se=oe*pe,ve=oe*u,Ne=he.wc,be=ae<ve?Wt(he,z,D):null;t(ae<=se),t(u<=pe),t(jn(he));t:for(;;){for(;!ne.h&&ae<ve;){if(z&Ne||(be=Wt(he,z,D)),t(be!=null),ee(ne),256>(pe=vr(be.G[0],be.H[0],ne)))T[fe+ae]=pe,++ae,++z>=oe&&(z=0,++D<=u&&!(D%16)&&Yr(F,D));else{if(!(280>pe)){we=0;break t}pe=Vr(pe-256,ne);var De,Pe=vr(be.G[4],be.H[4],ne);if(ee(ne),!(ae>=(Pe=dn(oe,Pe=Vr(Pe,ne)))&&se-ae>=pe)){we=0;break t}for(De=0;De<pe;++De)T[fe+ae+De]=T[fe+ae+De-Pe];for(ae+=pe,z+=pe;z>=oe;)z-=oe,++D<=u&&!(D%16)&&Yr(F,D);ae<ve&&z&Ne&&(be=Wt(he,z,D))}t(ne.h==U(ne))}Yr(F,D>u?u:D);break t}!we||ne.h&&ae<se?(we=0,F.a=ne.h?5:3):F.$=ae,u=we}else u=$r(F,F.V,F.Ba,F.c,F.i,u,Fa);if(!u){b=0;break e}}p+b>=E&&(l.Cc=1),b=1}if(!b)return null;if(l.Cc&&((b=l.ga)!=null&&(b.mc=null),l.ga=null,0<l.Ga))return alert("todo:WebPDequantizeLevels"),null}return l.nb+p*P}function f(l,u,p,b,P,E){for(;0<P--;){var F,T=l,D=u+(p?1:0),z=l,ne=u+(p?0:3);for(F=0;F<b;++F){var he=z[ne+4*F];he!=255&&(he*=32897,T[D+4*F+0]=T[D+4*F+0]*he>>23,T[D+4*F+1]=T[D+4*F+1]*he>>23,T[D+4*F+2]=T[D+4*F+2]*he>>23)}u+=E}}function C(l,u,p,b,P){for(;0<b--;){var E;for(E=0;E<p;++E){var F=l[u+2*E+0],T=15&(z=l[u+2*E+1]),D=4369*T,z=(240&z|z>>4)*D>>16;l[u+2*E+0]=(240&F|F>>4)*D>>16&240|(15&F|F<<4)*D>>16>>4&15,l[u+2*E+1]=240&z|T}u+=P}}function $(l,u,p,b,P,E,F,T){var D,z,ne=255;for(z=0;z<P;++z){for(D=0;D<b;++D){var he=l[u+D];E[F+4*D]=he,ne&=he}u+=p,F+=T}return ne!=255}function re(l,u,p,b,P){var E;for(E=0;E<P;++E)p[b+E]=l[u+E]>>8}function ce(){Rr=f,kt=C,Lt=$,qt=re}function xe(l,u,p){M[l]=function(b,P,E,F,T,D,z,ne,he,fe,oe,we,pe,ae,se,ve,Ne){var be,De=Ne-1>>1,Pe=T[D+0]|z[ne+0]<<16,He=he[fe+0]|oe[we+0]<<16;t(b!=null);var Fe=3*Pe+He+131074>>2;for(u(b[P+0],255&Fe,Fe>>16,pe,ae),E!=null&&(Fe=3*He+Pe+131074>>2,u(E[F+0],255&Fe,Fe>>16,se,ve)),be=1;be<=De;++be){var ht=T[D+be]|z[ne+be]<<16,pt=he[fe+be]|oe[we+be]<<16,ct=Pe+ht+He+pt+524296,it=ct+2*(ht+He)>>3;Fe=it+Pe>>1,Pe=(ct=ct+2*(Pe+pt)>>3)+ht>>1,u(b[P+2*be-1],255&Fe,Fe>>16,pe,ae+(2*be-1)*p),u(b[P+2*be-0],255&Pe,Pe>>16,pe,ae+(2*be-0)*p),E!=null&&(Fe=ct+He>>1,Pe=it+pt>>1,u(E[F+2*be-1],255&Fe,Fe>>16,se,ve+(2*be-1)*p),u(E[F+2*be+0],255&Pe,Pe>>16,se,ve+(2*be+0)*p)),Pe=ht,He=pt}1&Ne||(Fe=3*Pe+He+131074>>2,u(b[P+Ne-1],255&Fe,Fe>>16,pe,ae+(Ne-1)*p),E!=null&&(Fe=3*He+Pe+131074>>2,u(E[F+Ne-1],255&Fe,Fe>>16,se,ve+(Ne-1)*p)))}}function Se(){zr[Hi]=yh,zr[Wi]=Tc,zr[Cc]=vh,zr[Vi]=Oc,zr[Gi]=Dc,zr[fl]=Bc,zr[Ec]=bh,zr[ml]=Tc,zr[gl]=Oc,zr[Yi]=Dc,zr[pl]=Bc}function Oe(l){return l&~wh?0>l?0:255:l>>Rc}function ze(l,u){return Oe((19077*l>>8)+(26149*u>>8)-14234)}function tt(l,u,p){return Oe((19077*l>>8)-(6419*u>>8)-(13320*p>>8)+8708)}function Qe(l,u){return Oe((19077*l>>8)+(33050*u>>8)-17685)}function ot(l,u,p,b,P){b[P+0]=ze(l,p),b[P+1]=tt(l,u,p),b[P+2]=Qe(l,u)}function Et(l,u,p,b,P){b[P+0]=Qe(l,u),b[P+1]=tt(l,u,p),b[P+2]=ze(l,p)}function Tt(l,u,p,b,P){var E=tt(l,u,p);u=E<<3&224|Qe(l,u)>>3,b[P+0]=248&ze(l,p)|E>>5,b[P+1]=u}function Vt(l,u,p,b,P){var E=240&Qe(l,u)|15;b[P+0]=240&ze(l,p)|tt(l,u,p)>>4,b[P+1]=E}function lr(l,u,p,b,P){b[P+0]=255,ot(l,u,p,b,P+1)}function Zt(l,u,p,b,P){Et(l,u,p,b,P),b[P+3]=255}function Xr(l,u,p,b,P){ot(l,u,p,b,P),b[P+3]=255}function Pr(l,u){return 0>l?0:l>u?u:l}function gn(l,u,p){M[l]=function(b,P,E,F,T,D,z,ne,he){for(var fe=ne+(-2&he)*p;ne!=fe;)u(b[P+0],E[F+0],T[D+0],z,ne),u(b[P+1],E[F+0],T[D+0],z,ne+p),P+=2,++F,++D,ne+=2*p;1&he&&u(b[P+0],E[F+0],T[D+0],z,ne)}}function Oi(l,u,p){return p==0?l==0?u==0?6:5:u==0?4:0:p}function Ms(l,u,p,b,P){switch(l>>>30){case 3:An(u,p,b,P,0);break;case 2:Rt(u,p,b,P);break;case 1:gr(u,p,b,P)}}function Ts(l,u){var p,b,P=u.M,E=u.Nb,F=l.oc,T=l.pc+40,D=l.oc,z=l.pc+584,ne=l.oc,he=l.pc+600;for(p=0;16>p;++p)F[T+32*p-1]=129;for(p=0;8>p;++p)D[z+32*p-1]=129,ne[he+32*p-1]=129;for(0<P?F[T-1-32]=D[z-1-32]=ne[he-1-32]=129:(s(F,T-32-1,127,21),s(D,z-32-1,127,9),s(ne,he-32-1,127,9)),b=0;b<l.za;++b){var fe=u.ya[u.aa+b];if(0<b){for(p=-1;16>p;++p)a(F,T+32*p-4,F,T+32*p+12,4);for(p=-1;8>p;++p)a(D,z+32*p-4,D,z+32*p+4,4),a(ne,he+32*p-4,ne,he+32*p+4,4)}var oe=l.Gd,we=l.Hd+b,pe=fe.ad,ae=fe.Hc;if(0<P&&(a(F,T-32,oe[we].y,0,16),a(D,z-32,oe[we].f,0,8),a(ne,he-32,oe[we].ea,0,8)),fe.Za){var se=F,ve=T-32+16;for(0<P&&(b>=l.za-1?s(se,ve,oe[we].y[15],4):a(se,ve,oe[we+1].y,0,4)),p=0;4>p;p++)se[ve+128+p]=se[ve+256+p]=se[ve+384+p]=se[ve+0+p];for(p=0;16>p;++p,ae<<=2)se=F,ve=T+zc[p],Qr[fe.Ob[p]](se,ve),Ms(ae,pe,16*+p,se,ve)}else if(se=Oi(b,P,fe.Ob[0]),zn[se](F,T),ae!=0)for(p=0;16>p;++p,ae<<=2)Ms(ae,pe,16*+p,F,T+zc[p]);for(p=fe.Gc,se=Oi(b,P,fe.Dd),Cn[se](D,z),Cn[se](ne,he),ae=pe,se=D,ve=z,255&(fe=p>>0)&&(170&fe?qs(ae,256,se,ve):Dr(ae,256,se,ve)),fe=ne,ae=he,255&(p>>=8)&&(170&p?qs(pe,320,fe,ae):Dr(pe,320,fe,ae)),P<l.Ub-1&&(a(oe[we].y,0,F,T+480,16),a(oe[we].f,0,D,z+224,8),a(oe[we].ea,0,ne,he+224,8)),p=8*E*l.B,oe=l.sa,we=l.ta+16*b+16*E*l.R,pe=l.qa,fe=l.ra+8*b+p,ae=l.Ha,se=l.Ia+8*b+p,p=0;16>p;++p)a(oe,we+p*l.R,F,T+32*p,16);for(p=0;8>p;++p)a(pe,fe+p*l.B,D,z+32*p,8),a(ae,se+p*l.B,ne,he+32*p,8)}}function Ga(l,u,p,b,P,E,F,T,D){var z=[0],ne=[0],he=0,fe=D!=null?D.kd:0,oe=D??new Cs;if(l==null||12>p)return 7;oe.data=l,oe.w=u,oe.ha=p,u=[u],p=[p],oe.gb=[oe.gb];e:{var we=u,pe=p,ae=oe.gb;if(t(l!=null),t(pe!=null),t(ae!=null),ae[0]=0,12<=pe[0]&&!r(l,we[0],"RIFF")){if(r(l,we[0]+8,"WEBP")){ae=3;break e}var se=Ee(l,we[0]+4);if(12>se||4294967286<se){ae=3;break e}if(fe&&se>pe[0]-8){ae=7;break e}ae[0]=se,we[0]+=12,pe[0]-=12}ae=0}if(ae!=0)return ae;for(se=0<oe.gb[0],p=p[0];;){e:{var ve=l;pe=u,ae=p;var Ne=z,be=ne,De=we=[0];if((Fe=he=[he])[0]=0,8>ae[0])ae=7;else{if(!r(ve,pe[0],"VP8X")){if(Ee(ve,pe[0]+4)!=10){ae=3;break e}if(18>ae[0]){ae=7;break e}var Pe=Ee(ve,pe[0]+8),He=1+Ce(ve,pe[0]+12);if(2147483648<=He*(ve=1+Ce(ve,pe[0]+15))){ae=3;break e}De!=null&&(De[0]=Pe),Ne!=null&&(Ne[0]=He),be!=null&&(be[0]=ve),pe[0]+=18,ae[0]-=18,Fe[0]=1}ae=0}}if(he=he[0],we=we[0],ae!=0)return ae;if(pe=!!(2&we),!se&&he)return 3;if(E!=null&&(E[0]=!!(16&we)),F!=null&&(F[0]=pe),T!=null&&(T[0]=0),F=z[0],we=ne[0],he&&pe&&D==null){ae=0;break}if(4>p){ae=7;break}if(se&&he||!se&&!he&&!r(l,u[0],"ALPH")){p=[p],oe.na=[oe.na],oe.P=[oe.P],oe.Sa=[oe.Sa];e:{Pe=l,ae=u,se=p;var Fe=oe.gb;Ne=oe.na,be=oe.P,De=oe.Sa,He=22,t(Pe!=null),t(se!=null),ve=ae[0];var ht=se[0];for(t(Ne!=null),t(De!=null),Ne[0]=null,be[0]=null,De[0]=0;;){if(ae[0]=ve,se[0]=ht,8>ht){ae=7;break e}var pt=Ee(Pe,ve+4);if(4294967286<pt){ae=3;break e}var ct=8+pt+1&-2;if(He+=ct,0<Fe&&He>Fe){ae=3;break e}if(!r(Pe,ve,"VP8 ")||!r(Pe,ve,"VP8L")){ae=0;break e}if(ht[0]<ct){ae=7;break e}r(Pe,ve,"ALPH")||(Ne[0]=Pe,be[0]=ve+8,De[0]=pt),ve+=ct,ht-=ct}}if(p=p[0],oe.na=oe.na[0],oe.P=oe.P[0],oe.Sa=oe.Sa[0],ae!=0)break}p=[p],oe.Ja=[oe.Ja],oe.xa=[oe.xa];e:if(Fe=l,ae=u,se=p,Ne=oe.gb[0],be=oe.Ja,De=oe.xa,Pe=ae[0],ve=!r(Fe,Pe,"VP8 "),He=!r(Fe,Pe,"VP8L"),t(Fe!=null),t(se!=null),t(be!=null),t(De!=null),8>se[0])ae=7;else{if(ve||He){if(Fe=Ee(Fe,Pe+4),12<=Ne&&Fe>Ne-12){ae=3;break e}if(fe&&Fe>se[0]-8){ae=7;break e}be[0]=Fe,ae[0]+=8,se[0]-=8,De[0]=He}else De[0]=5<=se[0]&&Fe[Pe+0]==47&&!(Fe[Pe+4]>>5),be[0]=se[0];ae=0}if(p=p[0],oe.Ja=oe.Ja[0],oe.xa=oe.xa[0],u=u[0],ae!=0)break;if(4294967286<oe.Ja)return 3;if(T==null||pe||(T[0]=oe.xa?2:1),F=[F],we=[we],oe.xa){if(5>p){ae=7;break}T=F,fe=we,pe=E,l==null||5>p?l=0:5<=p&&l[u+0]==47&&!(l[u+4]>>5)?(se=[0],Fe=[0],Ne=[0],Z(be=new k,l,u,p),We(be,se,Fe,Ne)?(T!=null&&(T[0]=se[0]),fe!=null&&(fe[0]=Fe[0]),pe!=null&&(pe[0]=Ne[0]),l=1):l=0):l=0}else{if(10>p){ae=7;break}T=we,l==null||10>p||!bi(l,u+3,p-3)?l=0:(fe=l[u+0]|l[u+1]<<8|l[u+2]<<16,pe=16383&(l[u+7]<<8|l[u+6]),l=16383&(l[u+9]<<8|l[u+8]),1&fe||3<(fe>>1&7)||!(fe>>4&1)||fe>>5>=oe.Ja||!pe||!l?l=0:(F&&(F[0]=pe),T&&(T[0]=l),l=1))}if(!l||(F=F[0],we=we[0],he&&(z[0]!=F||ne[0]!=we)))return 3;D!=null&&(D[0]=oe,D.offset=u-D.w,t(4294967286>u-D.w),t(D.offset==D.ha-p));break}return ae==0||ae==7&&he&&D==null?(E!=null&&(E[0]|=oe.na!=null&&0<oe.na.length),b!=null&&(b[0]=F),P!=null&&(P[0]=we),0):ae}function Os(l,u,p){var b=u.width,P=u.height,E=0,F=0,T=b,D=P;if(u.Da=l!=null&&0<l.Da,u.Da&&(T=l.cd,D=l.bd,E=l.v,F=l.j,11>p||(E&=-2,F&=-2),0>E||0>F||0>=T||0>=D||E+T>b||F+D>P))return 0;if(u.v=E,u.j=F,u.va=E+T,u.o=F+D,u.U=T,u.T=D,u.da=l!=null&&0<l.da,u.da){if(!et(T,D,p=[l.ib],E=[l.hb]))return 0;u.ib=p[0],u.hb=E[0]}return u.ob=l!=null&&l.ob,u.Kb=l==null||!l.Sd,u.da&&(u.ob=u.ib<3*b/4&&u.hb<3*P/4,u.Kb=0),1}function Ds(l){if(l==null)return 2;if(11>l.S){var u=l.f.RGBA;u.fb+=(l.height-1)*u.A,u.A=-u.A}else u=l.f.kb,l=l.height,u.O+=(l-1)*u.fa,u.fa=-u.fa,u.N+=(l-1>>1)*u.Ab,u.Ab=-u.Ab,u.W+=(l-1>>1)*u.Db,u.Db=-u.Db,u.F!=null&&(u.J+=(l-1)*u.lb,u.lb=-u.lb);return 0}function Ya(l,u,p,b){if(b==null||0>=l||0>=u)return 2;if(p!=null){if(p.Da){var P=p.cd,E=p.bd,F=-2&p.v,T=-2&p.j;if(0>F||0>T||0>=P||0>=E||F+P>l||T+E>u)return 2;l=P,u=E}if(p.da){if(!et(l,u,P=[p.ib],E=[p.hb]))return 2;l=P[0],u=E[0]}}b.width=l,b.height=u;e:{var D=b.width,z=b.height;if(l=b.S,0>=D||0>=z||!(l>=Hi&&13>l))l=2;else{if(0>=b.Rd&&b.sd==null){F=E=P=u=0;var ne=(T=D*Uc[l])*z;if(11>l||(E=(z+1)/2*(u=(D+1)/2),l==12&&(F=(P=D)*z)),(z=i(ne+2*E+F))==null){l=1;break e}b.sd=z,11>l?((D=b.f.RGBA).eb=z,D.fb=0,D.A=T,D.size=ne):((D=b.f.kb).y=z,D.O=0,D.fa=T,D.Fd=ne,D.f=z,D.N=0+ne,D.Ab=u,D.Cd=E,D.ea=z,D.W=0+ne+E,D.Db=u,D.Ed=E,l==12&&(D.F=z,D.J=0+ne+2*E),D.Tc=F,D.lb=P)}if(u=1,P=b.S,E=b.width,F=b.height,P>=Hi&&13>P)if(11>P)l=b.f.RGBA,u&=(T=Math.abs(l.A))*(F-1)+E<=l.size,u&=T>=E*Uc[P],u&=l.eb!=null;else{l=b.f.kb,T=(E+1)/2,ne=(F+1)/2,D=Math.abs(l.fa),z=Math.abs(l.Ab);var he=Math.abs(l.Db),fe=Math.abs(l.lb),oe=fe*(F-1)+E;u&=D*(F-1)+E<=l.Fd,u&=z*(ne-1)+T<=l.Cd,u=(u&=he*(ne-1)+T<=l.Ed)&D>=E&z>=T&he>=T,u&=l.y!=null,u&=l.f!=null,u&=l.ea!=null,P==12&&(u&=fe>=E,u&=oe<=l.Tc,u&=l.F!=null)}else u=0;l=u?0:2}}return l!=0||p!=null&&p.fd&&(l=Ds(b)),l}var ar=64,$a=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ja=24,Ka=32,Bs=8,wr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ae("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(l){return l},M.Predictor2=function(l,u,p){return u[p+0]},M.Predictor3=function(l,u,p){return u[p+1]},M.Predictor4=function(l,u,p){return u[p-1]},M.Predictor5=function(l,u,p){return Ie(Ie(l,u[p+1]),u[p+0])},M.Predictor6=function(l,u,p){return Ie(l,u[p-1])},M.Predictor7=function(l,u,p){return Ie(l,u[p+0])},M.Predictor8=function(l,u,p){return Ie(u[p-1],u[p+0])},M.Predictor9=function(l,u,p){return Ie(u[p+0],u[p+1])},M.Predictor10=function(l,u,p){return Ie(Ie(l,u[p-1]),Ie(u[p+0],u[p+1]))},M.Predictor11=function(l,u,p){var b=u[p+0];return 0>=nt(b>>24&255,l>>24&255,(u=u[p-1])>>24&255)+nt(b>>16&255,l>>16&255,u>>16&255)+nt(b>>8&255,l>>8&255,u>>8&255)+nt(255&b,255&l,255&u)?b:l},M.Predictor12=function(l,u,p){var b=u[p+0];return(qe((l>>24&255)+(b>>24&255)-((u=u[p-1])>>24&255))<<24|qe((l>>16&255)+(b>>16&255)-(u>>16&255))<<16|qe((l>>8&255)+(b>>8&255)-(u>>8&255))<<8|qe((255&l)+(255&b)-(255&u)))>>>0},M.Predictor13=function(l,u,p){var b=u[p-1];return(Ke((l=Ie(l,u[p+0]))>>24&255,b>>24&255)<<24|Ke(l>>16&255,b>>16&255)<<16|Ke(l>>8&255,b>>8&255)<<8|Ke(l>>0&255,b>>0&255))>>>0};var ul=M.PredictorAdd0;M.PredictorAdd1=at,Ae("Predictor2","PredictorAdd2"),Ae("Predictor3","PredictorAdd3"),Ae("Predictor4","PredictorAdd4"),Ae("Predictor5","PredictorAdd5"),Ae("Predictor6","PredictorAdd6"),Ae("Predictor7","PredictorAdd7"),Ae("Predictor8","PredictorAdd8"),Ae("Predictor9","PredictorAdd9"),Ae("Predictor10","PredictorAdd10"),Ae("Predictor11","PredictorAdd11"),Ae("Predictor12","PredictorAdd12"),Ae("Predictor13","PredictorAdd13");var Rs=M.PredictorAdd2;st("ColorIndexInverseTransform","MapARGB","32b",function(l){return l>>8&255},function(l){return l}),st("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(l){return l},function(l){return l>>8&255});var Di,Or=M.ColorIndexInverseTransform,Xa=M.MapARGB,Bi=M.VP8LColorIndexInverseTransformAlpha,Ri=M.MapAlpha,Dn=M.VP8LPredictorsAdd=[];Dn.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var fa,Nr,mr,Bn,kn,Ln,Qa,An,Rt,qs,gr,Dr,Za,qi,zs,ma,ga,Rn,pa,es,xa,qn,Us,Br,Rr,kt,Lt,qt,Jt=i(511),Pn=i(2041),Hs=i(225),ts=i(767),zi=0,hl=Pn,Ui=Hs,Cr=ts,qr=Jt,Hi=0,Wi=1,Cc=2,Vi=3,Gi=4,fl=5,Ec=6,ml=7,gl=8,Yi=9,pl=10,ah=[2,3,7],sh=[3,3,11],Fc=[280,256,256,256,40],ih=[0,1,1,1,0],oh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],lh=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ch=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],dh=8,xl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],yl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ws=null,uh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],hh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ic=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],fh=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],mh=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],gh=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ph=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],zn=[],Qr=[],Cn=[],xh=1,Mc=2,Un=[],zr=[];xe("UpsampleRgbLinePair",ot,3),xe("UpsampleBgrLinePair",Et,3),xe("UpsampleRgbaLinePair",Xr,4),xe("UpsampleBgraLinePair",Zt,4),xe("UpsampleArgbLinePair",lr,4),xe("UpsampleRgba4444LinePair",Vt,2),xe("UpsampleRgb565LinePair",Tt,2);var yh=M.UpsampleRgbLinePair,vh=M.UpsampleBgrLinePair,Tc=M.UpsampleRgbaLinePair,Oc=M.UpsampleBgraLinePair,Dc=M.UpsampleArgbLinePair,Bc=M.UpsampleRgba4444LinePair,bh=M.UpsampleRgb565LinePair,$i=16,Ji=1<<$i-1,Vs=-227,vl=482,Rc=6,wh=(256<<Rc)-1,qc=0,Nh=i(256),jh=i(256),Sh=i(256),_h=i(256),kh=i(vl-Vs),Lh=i(vl-Vs);gn("YuvToRgbRow",ot,3),gn("YuvToBgrRow",Et,3),gn("YuvToRgbaRow",Xr,4),gn("YuvToBgraRow",Zt,4),gn("YuvToArgbRow",lr,4),gn("YuvToRgba4444Row",Vt,2),gn("YuvToRgb565Row",Tt,2);var zc=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ki=[0,2,8],Ah=[8,7,6,4,4,2,2,2,1,1,1,1],Ph=1;this.WebPDecodeRGBA=function(l,u,p,b,P){var E=Wi,F=new Wa,T=new Wr;F.ba=T,T.S=E,T.width=[T.width],T.height=[T.height];var D=T.width,z=T.height,ne=new Nn;if(ne==null||l==null)var he=2;else t(ne!=null),he=Ga(l,u,p,ne.width,ne.height,ne.Pd,ne.Qd,ne.format,null);if(he!=0?D=0:(D!=null&&(D[0]=ne.width[0]),z!=null&&(z[0]=ne.height[0]),D=1),D){T.width=T.width[0],T.height=T.height[0],b!=null&&(b[0]=T.width),P!=null&&(P[0]=T.height);e:{if(b=new Da,(P=new Cs).data=l,P.w=u,P.ha=p,P.kd=1,u=[0],t(P!=null),((l=Ga(P.data,P.w,P.ha,null,null,null,u,null,P))==0||l==7)&&u[0]&&(l=4),(u=l)==0){if(t(F!=null),b.data=P.data,b.w=P.w+P.offset,b.ha=P.ha-P.offset,b.put=ln,b.ac=nr,b.bc=cn,b.ma=F,P.xa){if((l=Tr())==null){F=1;break e}if(function(fe,oe){var we=[0],pe=[0],ae=[0];t:for(;;){if(fe==null)return 0;if(oe==null)return fe.a=2,0;if(fe.l=oe,fe.a=0,Z(fe.m,oe.data,oe.w,oe.ha),!We(fe.m,we,pe,ae)){fe.a=3;break t}if(fe.xb=Mc,oe.width=we[0],oe.height=pe[0],!hn(we[0],pe[0],1,fe,null))break t;return 1}return t(fe.a!=0),0}(l,b)){if(b=(u=Ya(b.width,b.height,F.Oa,F.ba))==0){t:{b=l;r:for(;;){if(b==null){b=0;break t}if(t(b.s.yc!=null),t(b.s.Ya!=null),t(0<b.s.Wb),t((p=b.l)!=null),t((P=p.ma)!=null),b.xb!=0){if(b.ca=P.ba,b.tb=P.tb,t(b.ca!=null),!Os(P.Oa,p,Vi)){b.a=2;break r}if(!la(b,p.width)||p.da)break r;if((p.da||mt(b.ca.S))&&ce(),11>b.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),b.ca.f.kb.F!=null&&ce()),b.Pb&&0<b.s.ua&&b.s.vb.X==null&&!Ve(b.s.vb,b.s.Wa.Xa)){b.a=1;break r}b.xb=0}if(!$r(b,b.V,b.Ba,b.c,b.i,p.o,Ea))break r;P.Dc=b.Ma,b=1;break t}t(b.a!=0),b=0}b=!b}b&&(u=l.a)}else u=l.a}else{if((l=new Go)==null){F=1;break e}if(l.Fa=P.na,l.P=P.P,l.qc=P.Sa,wi(l,b)){if((u=Ya(b.width,b.height,F.Oa,F.ba))==0){if(l.Aa=0,p=F.Oa,t((P=l)!=null),p!=null){if(0<(D=0>(D=p.Md)?0:100<D?255:255*D/100)){for(z=ne=0;4>z;++z)12>(he=P.pb[z]).lc&&(he.ia=D*Ah[0>he.lc?0:he.lc]>>3),ne|=he.ia;ne&&(alert("todo:VP8InitRandom"),P.ia=1)}P.Ga=p.Id,100<P.Ga?P.Ga=100:0>P.Ga&&(P.Ga=0)}Yo(l,b)||(u=l.a)}}else u=l.a}u==0&&F.Oa!=null&&F.Oa.fd&&(u=Ds(F.ba))}F=u}E=F!=0?null:11>E?T.f.RGBA.eb:T.f.kb.y}else E=null;return E};var Uc=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(M,G){for(var J="",A=0;A<4;A++)J+=String.fromCharCode(M[G++]);return J}function g(M,G){return(M[G+0]<<0|M[G+1]<<8|M[G+2]<<16)>>>0}function x(M,G){return(M[G+0]<<0|M[G+1]<<8|M[G+2]<<16|M[G+3]<<24)>>>0}new d;var y=[0],m=[0],v=[],N=new d,L=e,w=function(M,G){var J={},A=0,_=!1,q=0,H=0;if(J.frames=[],!function(B,U,X,ee){for(var de=0;de<ee;de++)if(B[U+de]!=X.charCodeAt(de))return!0;return!1}(M,G,"RIFF",4)){var le,Y;for(x(M,G+=4),G+=8;G<M.length;){var V=h(M,G),Z=x(M,G+=4);G+=4;var Q=Z+(1&Z);switch(V){case"VP8 ":case"VP8L":J.frames[A]===void 0&&(J.frames[A]={}),(k=J.frames[A]).src_off=_?H:G-8,k.src_size=q+Z+8,A++,_&&(_=!1,q=0,H=0);break;case"VP8X":(k=J.header={}).feature_flags=M[G];var ie=G+4;k.canvas_width=1+g(M,ie),ie+=3,k.canvas_height=1+g(M,ie),ie+=3;break;case"ALPH":_=!0,q=Q+8,H=G-8;break;case"ANIM":(k=J.header).bgcolor=x(M,G),ie=G+4,k.loop_count=(le=M)[(Y=ie)+0]<<0|le[Y+1]<<8,ie+=2;break;case"ANMF":var ge,k;(k=J.frames[A]={}).offset_x=2*g(M,G),G+=3,k.offset_y=2*g(M,G),G+=3,k.width=1+g(M,G),G+=3,k.height=1+g(M,G),G+=3,k.duration=g(M,G),G+=3,ge=M[G++],k.dispose=1&ge,k.blend=ge>>1&1}V!="ANMF"&&(G+=Q)}return J}}(L,0);w.response=L,w.rgbaoutput=!0,w.dataurl=!1;var j=w.header?w.header:null,S=w.frames?w.frames:null;if(j){j.loop_counter=j.loop_count,y=[j.canvas_height],m=[j.canvas_width];for(var I=0;I<S.length&&S[I].blend!=0;I++);}var R=S[0],K=N.WebPDecodeRGBA(L,R.src_off,R.src_size,m,y);R.rgba=K,R.imgwidth=m[0],R.imgheight=y[0];for(var O=0;O<m[0]*y[0]*4;O++)v[O]=K[O];return this.width=m,this.height=y,this.data=v,this}(function(e){var t=function(){return typeof tc=="function"},r=function(y,m,v,N){var L=4,w=o;switch(N){case e.image_compression.FAST:L=1,w=i;break;case e.image_compression.MEDIUM:L=6,w=c;break;case e.image_compression.SLOW:L=9,w=d}y=a(y,m,v,w);var j=tc(y,{level:L});return e.__addimage__.arrayBufferToBinaryString(j)},a=function(y,m,v,N){for(var L,w,j,S=y.length/m,I=new Uint8Array(y.length+S),R=g(),K=0;K<S;K+=1){if(j=K*m,L=y.subarray(j,j+m),N)I.set(N(L,v,w),j+K);else{for(var O,M=R.length,G=[];O<M;O+=1)G[O]=R[O](L,v,w);var J=x(G.concat());I.set(G[J],j+K)}w=L}return I},s=function(y){var m=Array.apply([],y);return m.unshift(0),m},i=function(y,m){var v,N=[],L=y.length;N[0]=1;for(var w=0;w<L;w+=1)v=y[w-m]||0,N[w+1]=y[w]-v+256&255;return N},o=function(y,m,v){var N,L=[],w=y.length;L[0]=2;for(var j=0;j<w;j+=1)N=v&&v[j]||0,L[j+1]=y[j]-N+256&255;return L},c=function(y,m,v){var N,L,w=[],j=y.length;w[0]=3;for(var S=0;S<j;S+=1)N=y[S-m]||0,L=v&&v[S]||0,w[S+1]=y[S]+256-(N+L>>>1)&255;return w},d=function(y,m,v){var N,L,w,j,S=[],I=y.length;S[0]=4;for(var R=0;R<I;R+=1)N=y[R-m]||0,L=v&&v[R]||0,w=v&&v[R-m]||0,j=h(N,L,w),S[R+1]=y[R]-j+256&255;return S},h=function(y,m,v){if(y===m&&m===v)return y;var N=Math.abs(m-v),L=Math.abs(y-v),w=Math.abs(y+m-v-v);return N<=L&&N<=w?y:L<=w?m:v},g=function(){return[s,i,o,c,d]},x=function(y){var m=y.map(function(v){return v.reduce(function(N,L){return N+Math.abs(L)},0)});return m.indexOf(Math.min.apply(null,m))};e.processPNG=function(y,m,v,N){var L,w,j,S,I,R,K,O,M,G,J,A,_,q,H,le=this.decode.FLATE_DECODE,Y="";if(this.__addimage__.isArrayBuffer(y)&&(y=new Uint8Array(y)),this.__addimage__.isArrayBufferView(y)){if(y=(j=new W0(y)).imgData,w=j.bits,L=j.colorSpace,I=j.colors,[4,6].indexOf(j.colorType)!==-1){if(j.bits===8){M=(O=j.pixelBitlength==32?new Uint32Array(j.decodePixels().buffer):j.pixelBitlength==16?new Uint16Array(j.decodePixels().buffer):new Uint8Array(j.decodePixels().buffer)).length,J=new Uint8Array(M*j.colors),G=new Uint8Array(M);var V,Z=j.pixelBitlength-j.bits;for(q=0,H=0;q<M;q++){for(_=O[q],V=0;V<Z;)J[H++]=_>>>V&255,V+=j.bits;G[q]=_>>>V&255}}if(j.bits===16){M=(O=new Uint32Array(j.decodePixels().buffer)).length,J=new Uint8Array(M*(32/j.pixelBitlength)*j.colors),G=new Uint8Array(M*(32/j.pixelBitlength)),A=j.colors>1,q=0,H=0;for(var Q=0;q<M;)_=O[q++],J[H++]=_>>>0&255,A&&(J[H++]=_>>>16&255,_=O[q++],J[H++]=_>>>0&255),G[Q++]=_>>>16&255;w=8}N!==e.image_compression.NONE&&t()?(y=r(J,j.width*j.colors,j.colors,N),K=r(G,j.width,1,N)):(y=J,K=G,le=void 0)}if(j.colorType===3&&(L=this.color_spaces.INDEXED,R=j.palette,j.transparency.indexed)){var ie=j.transparency.indexed,ge=0;for(q=0,M=ie.length;q<M;++q)ge+=ie[q];if((ge/=255)===M-1&&ie.indexOf(0)!==-1)S=[ie.indexOf(0)];else if(ge!==M){for(O=j.decodePixels(),G=new Uint8Array(O.length),q=0,M=O.length;q<M;q++)G[q]=ie[O[q]];K=r(G,j.width,1)}}var k=function(B){var U;switch(B){case e.image_compression.FAST:U=11;break;case e.image_compression.MEDIUM:U=13;break;case e.image_compression.SLOW:U=14;break;default:U=12}return U}(N);return le===this.decode.FLATE_DECODE&&(Y="/Predictor "+k+" "),Y+="/Colors "+I+" /BitsPerComponent "+w+" /Columns "+j.width,(this.__addimage__.isArrayBuffer(y)||this.__addimage__.isArrayBufferView(y))&&(y=this.__addimage__.arrayBufferToBinaryString(y)),(K&&this.__addimage__.isArrayBuffer(K)||this.__addimage__.isArrayBufferView(K))&&(K=this.__addimage__.arrayBufferToBinaryString(K)),{alias:v,data:y,index:m,filter:le,decodeParameters:Y,transparency:S,palette:R,sMask:K,predictor:k,width:j.width,height:j.height,bitsPerComponent:w,colorSpace:L}}}})(Ue.API),function(e){e.processGIF89A=function(t,r,a,s){var i=new V0(t),o=i.width,c=i.height,d=[];i.decodeAndBlitFrameRGBA(0,d);var h={data:d,width:o,height:c},g=new Rl(100).encode(h,100);return e.processJPEG.call(this,g,r,a,s)},e.processGIF87A=e.processGIF89A}(Ue.API),tn.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},tn.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){_t.log("bit decode error:"+r)}},tn.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var d=this.palette[i>>7-c&1];this.data[o+4*c]=d.blue,this.data[o+4*c+1]=d.green,this.data[o+4*c+2]=d.red,this.data[o+4*c+3]=255}r!==0&&(this.pos+=4-r)}},tn.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*s*4,c=i>>4,d=15&i,h=this.palette[c];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*s+1>=this.width)break;h=this.palette[d],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},tn.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},tn.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,c=(i>>5&t)/t*255|0,d=(i>>10&t)/t*255|0,h=i>>15?255:0,g=a*this.width*4+4*s;this.data[g]=d,this.data[g+1]=c,this.data[g+2]=o,this.data[g+3]=h}this.pos+=e}},tn.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&t)/t*255|0,d=(o>>5&r)/r*255|0,h=(o>>11)/t*255|0,g=s*this.width*4+4*i;this.data[g]=h,this.data[g+1]=d,this.data[g+2]=c,this.data[g+3]=255}this.pos+=e}},tn.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},tn.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=t*this.width*4+4*r;this.data[c]=i,this.data[c+1]=s,this.data[c+2]=a,this.data[c+3]=o}},tn.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,s){var i=new tn(t,!1),o=i.width,c=i.height,d={data:i.getData(),width:o,height:c},h=new Rl(100).encode(d,100);return e.processJPEG.call(this,h,r,a,s)}}(Ue.API),_d.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,s){var i=new _d(t),o=i.width,c=i.height,d={data:i.getData(),width:o,height:c},h=new Rl(100).encode(d,100);return e.processJPEG.call(this,h,r,a,s)}}(Ue.API),Ue.API.processRGBA=function(e,t,r){for(var a=e.data,s=a.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),c=0,d=0,h=0;h<s;h+=4){var g=a[h],x=a[h+1],y=a[h+2],m=a[h+3];i[c++]=g,i[c++]=x,i[c++]=y,o[d++]=m}var v=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ue.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},os=Ue.API,uo=os.getCharWidthsArray=function(e,t){var r,a,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),c=t.widths?t.widths:s.metadata.Unicode.widths,d=c.fof?c.fof:1,h=t.kerning?t.kerning:s.metadata.Unicode.kerning,g=h.fof?h.fof:1,x=t.doKerning!==!1,y=0,m=e.length,v=0,N=c[0]||d,L=[];for(r=0;r<m;r++)a=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?L.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a))+o*(1e3/i)||0)/1e3):(y=x&&vt(h[a])==="object"&&!isNaN(parseInt(h[a][v],10))?h[a][v]/g:0,L.push((c[a]||N)/d+y)),v=a;return L},wd=os.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return os.processArabic&&(e=os.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,s)/r:uo.apply(this,arguments).reduce(function(i,o){return i+o},0)},Nd=function(e,t,r,a){for(var s=[],i=0,o=e.length,c=0;i!==o&&c+t[i]<r;)c+=t[i],i++;s.push(e.slice(0,i));var d=i;for(c=0;i!==o;)c+t[i]>a&&(s.push(e.slice(d,i)),c=0,d=i),c+=t[i],i++;return d!==i&&s.push(e.slice(d,i)),s},jd=function(e,t,r){r||(r={});var a,s,i,o,c,d,h,g=[],x=[g],y=r.textIndent||0,m=0,v=0,N=e.split(" "),L=uo.apply(this,[" ",r])[0];if(d=r.lineIndent===-1?N[0].length+2:r.lineIndent||0){var w=Array(d).join(" "),j=[];N.map(function(I){(I=I.split(/\s*\n/)).length>1?j=j.concat(I.map(function(R,K){return(K&&R.length?`
`:"")+R})):j.push(I[0])}),N=j,d=wd.apply(this,[w,r])}for(i=0,o=N.length;i<o;i++){var S=0;if(a=N[i],d&&a[0]==`
`&&(a=a.substr(1),S=1),y+m+(v=(s=uo.apply(this,[a,r])).reduce(function(I,R){return I+R},0))>t||S){if(v>t){for(c=Nd.apply(this,[a,s,t-(y+m),t]),g.push(c.shift()),g=[c.pop()];c.length;)x.push([c.shift()]);v=s.slice(a.length-(g[0]?g[0].length:0)).reduce(function(I,R){return I+R},0)}else g=[a];x.push(g),y=v+d,m=L}else g.push(a),y+=m+v,m=L}return h=d?function(I,R){return(R?w:"")+I.join(" ")}:function(I){return I.join(" ")},x.map(h)},os.splitTextToSize=function(e,t,r){var a,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(g){if(g.widths&&g.kerning)return{widths:g.widths,kerning:g.kerning};var x=this.internal.getFont(g.fontName,g.fontStyle);return x.metadata.Unicode?{widths:x.metadata.Unicode.widths||{0:1},kerning:x.metadata.Unicode.kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var c,d,h=[];for(c=0,d=a.length;c<d;c++)h=h.concat(jd.apply(this,[a[c],o,i]));return h},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},a={},s=0;s<t.length;s++)r[t[s]]="0123456789abcdef"[s],a["0123456789abcdef"[s]]=t[s];var i=function(x){return"0x"+parseInt(x,10).toString(16)},o=e.__fontmetrics__.compress=function(x){var y,m,v,N,L=["{"];for(var w in x){if(y=x[w],isNaN(parseInt(w,10))?m="'"+w+"'":(w=parseInt(w,10),m=(m=i(w).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof y=="number")y<0?(v=i(y).slice(3),N="-"):(v=i(y).slice(2),N=""),v=N+v.slice(0,-1)+a[v.slice(-1)];else{if(vt(y)!=="object")throw new Error("Don't know what to do with value type "+vt(y)+".");v=o(y)}L.push(m+v)}return L.push("}"),L.join("")},c=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var y,m,v,N,L={},w=1,j=L,S=[],I="",R="",K=x.length-1,O=1;O<K;O+=1)(N=x[O])=="'"?y?(v=y.join(""),y=void 0):y=[]:y?y.push(N):N=="{"?(S.push([j,v]),j={},v=void 0):N=="}"?((m=S.pop())[0][m[1]]=j,v=void 0,j=m[0]):N=="-"?w=-1:v===void 0?r.hasOwnProperty(N)?(I+=r[N],v=parseInt(I,16)*w,w=1,I=""):I+=N:r.hasOwnProperty(N)?(R+=r[N],j[v]=parseInt(R,16)*w,w=1,v=void 0,R=""):R+=N;return L},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},g={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var y=x.font,m=g.Unicode[y.postScriptName];m&&(y.metadata.Unicode={},y.metadata.Unicode.widths=m.widths,y.metadata.Unicode.kerning=m.kerning);var v=h.Unicode[y.postScriptName];v&&(y.metadata.Unicode.encoding=v,y.encoding=v.codePages[0])}])}(Ue.API),function(e){var t=function(r){for(var a=r.length,s=new Uint8Array(a),i=0;i<a;i++)s[i]=r.charCodeAt(i);return s};e.API.events.push(["addFont",function(r){var a=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(a=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?t(c):t(ti(c)),o.metadata=e.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,a)}}])}(Ue),function(e){function t(){return(Ge.canvg?Promise.resolve(Ge.canvg):Jl(()=>import("./index.es-DKFWfxCa.js"),__vite__mapDeps([0,1,2,3]))).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Ue.API.addSvgAsImage=function(r,a,s,i,o,c,d,h){if(isNaN(a)||isNaN(s))throw _t.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw _t.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var g=document.createElement("canvas");g.width=i,g.height=o;var x=g.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,g.width,g.height);var y={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return t().then(function(v){return v.fromString(x,r,y)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(y)}).then(function(){m.addImage(g.toDataURL("image/jpeg",1),a,s,i,o,d,h)})}}(),Ue.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var s=0;s<this.internal.pages[a].length;s++)this.internal.pages[a][s]=this.internal.pages[a][s].replace(t,r);return this},Ue.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),d=[],h=0,g=0,x=0;function y(v,N){var L,w=!1;for(L=0;L<v.length;L+=1)v[L]===N&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=c.length;for(x=0;x<m;x+=1)r[c[x]].value=r[c[x]].defaultValue,r[c[x]].explicitSet=!1}if(vt(e)==="object"){for(s in e)if(i=e[s],y(c,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&y(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(h=0;h<i.length;h+=1)if(a=!0,i[h].length===1&&typeof i[h][0]=="number")d.push(String(i[h]-1));else if(i[h].length>1){for(g=0;g<i[h].length;g+=1)typeof i[h][g]!="number"&&(a=!1);a===!0&&d.push([i[h][0]-1,i[h][1]-1].join(" "))}r[s].value="["+d.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,N=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?N.push("/"+v+" /"+r[v].value):N.push("/"+v+" "+r[v].value));N.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+N.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),h=i.length+o.length+c.length+s.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+c+d),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ue.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var c,d=o.metadata.Unicode.widths,h=["","0","00","000","0000"],g=[""],x=0,y=i.length;x<y;++x){if(c=o.metadata.characterToGlyph(i.charCodeAt(x)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=i.charCodeAt(x),d.indexOf(c)==-1&&(d.push(c),d.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return g.join("");c=c.toString(16),g.push(h[4-c.length],c)}return g.join("")},a=function(i){var o,c,d,h,g,x,y;for(g=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],x=0,y=(c=Object.keys(i).sort(function(m,v){return m-v})).length;x<y;x++)o=c[x],d.length>=100&&(g+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(h=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),d.push("<"+o+"><"+h+">"));return d.length&&(g+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),g+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var c=o.font,d=o.out,h=o.newObject,g=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var x=c.metadata.Unicode.widths,y=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),m="",v=0;v<y.length;v++)m+=String.fromCharCode(y[v]);var N=h();g({data:m,addLength1:!0,objectId:N}),d("endobj");var L=h();g({data:a(c.metadata.toUnicode),addLength1:!0,objectId:L}),d("endobj");var w=h();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+us(c.fontName)),d("/FontFile2 "+N+" 0 R"),d("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),d("/Flags "+c.metadata.flags),d("/StemV "+c.metadata.stemV),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d(">>"),d("endobj");var j=h();d("<<"),d("/Type /Font"),d("/BaseFont /"+us(c.fontName)),d("/FontDescriptor "+w+" 0 R"),d("/W "+e.API.PDFObject.convert(x)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+c.encoding+")"),d(">>"),d(">>"),d("endobj"),c.objectNumber=h(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+L+" 0 R"),d("/BaseFont /"+us(c.fontName)),d("/Encoding /"+c.encoding),d("/DescendantFonts ["+j+" 0 R]"),d(">>"),d("endobj"),c.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var c=o.font,d=o.out,h=o.newObject,g=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var x=c.metadata.rawData,y="",m=0;m<x.length;m++)y+=String.fromCharCode(x[m]);var v=h();g({data:y,addLength1:!0,objectId:v}),d("endobj");var N=h();g({data:a(c.metadata.toUnicode),addLength1:!0,objectId:N}),d("endobj");var L=h();d("<<"),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d("/StemV "+c.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+v+" 0 R"),d("/Flags 96"),d("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),d("/FontName /"+us(c.fontName)),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d(">>"),d("endobj"),c.objectNumber=h();for(var w=0;w<c.metadata.hmtx.widths.length;w++)c.metadata.hmtx.widths[w]=parseInt(c.metadata.hmtx.widths[w]*(1e3/c.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+N+" 0 R/BaseFont/"+us(c.fontName)+"/FontDescriptor "+L+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),d("endobj"),c.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,c=i.text||"",d=i.x,h=i.y,g=i.options||{},x=i.mutex||{},y=x.pdfEscape,m=x.activeFontKey,v=x.fonts,N=m,L="",w=0,j="",S=v[N].encoding;if(v[N].encoding!=="Identity-H")return{text:c,x:d,y:h,options:g,mutex:x};for(j=c,N=m,Array.isArray(c)&&(j=c[0]),w=0;w<j.length;w+=1)v[N].metadata.hasOwnProperty("cmap")&&(o=v[N].metadata.cmap.unicode.codeMap[j[w].charCodeAt(0)]),o||j[w].charCodeAt(0)<256&&v[N].metadata.hasOwnProperty("Unicode")?L+=j[w]:L+="";var I="";return parseInt(N.slice(1))<14||S==="WinAnsiEncoding"?I=y(L,N).split("").map(function(R){return R.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(I=r(L,v[N])),x.isHex=!0,{text:I,x:d,y:h,options:g,mutex:x}};t.events.push(["postProcessText",function(i){var o=i.text||"",c=[],d={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?c.push([s(Object.assign({},d,{text:o[h][0]})).text,o[h][1],o[h][2]]):c.push(s(Object.assign({},d,{text:o[h]})).text);i.text=c}else i.text=s(Object.assign({},d,{text:o})).text}])}(Ue),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ue.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var s,i,o,c,d,h,g,x=t,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},N={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},L=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),j=!1,S=0;this.__bidiEngine__={};var I=function(A){var _=A.charCodeAt(),q=_>>8,H=N[q];return H!==void 0?x[256*H+(255&_)]:q===252||q===253?"AL":w.test(q)?"L":q===8?"R":"N"},R=function(A){for(var _,q=0;q<A.length;q++){if((_=I(A.charAt(q)))==="L")return!1;if(_==="R")return!0}return!1},K=function(A,_,q,H){var le,Y,V,Z,Q=_[H];switch(Q){case"L":case"R":j=!1;break;case"N":case"AN":break;case"EN":j&&(Q="AN");break;case"AL":j=!0,Q="R";break;case"WS":Q="N";break;case"CS":H<1||H+1>=_.length||(le=q[H-1])!=="EN"&&le!=="AN"||(Y=_[H+1])!=="EN"&&Y!=="AN"?Q="N":j&&(Y="AN"),Q=Y===le?Y:"N";break;case"ES":Q=(le=H>0?q[H-1]:"B")==="EN"&&H+1<_.length&&_[H+1]==="EN"?"EN":"N";break;case"ET":if(H>0&&q[H-1]==="EN"){Q="EN";break}if(j){Q="N";break}for(V=H+1,Z=_.length;V<Z&&_[V]==="ET";)V++;Q=V<Z&&_[V]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(Z=_.length,V=H+1;V<Z&&_[V]==="NSM";)V++;if(V<Z){var ie=A[H],ge=ie>=1425&&ie<=2303||ie===64286;if(le=_[V],ge&&(le==="R"||le==="AL")){Q="R";break}}}Q=H<1||(le=_[H-1])==="B"?"N":q[H-1];break;case"B":j=!1,s=!0,Q=S;break;case"S":i=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":j=!1;break;case"BN":Q="N"}return Q},O=function(A,_,q){var H=A.split("");return q&&M(H,q,{hiLevel:S}),H.reverse(),_&&_.reverse(),H.join("")},M=function(A,_,q){var H,le,Y,V,Z,Q=-1,ie=A.length,ge=0,k=[],B=S?m:y,U=[];for(j=!1,s=!1,i=!1,le=0;le<ie;le++)U[le]=I(A[le]);for(Y=0;Y<ie;Y++){if(Z=ge,k[Y]=K(A,U,k,Y),H=240&(ge=B[Z][v[k[Y]]]),ge&=15,_[Y]=V=B[ge][5],H>0)if(H===16){for(le=Q;le<Y;le++)_[le]=1;Q=-1}else Q=-1;if(B[ge][6])Q===-1&&(Q=Y);else if(Q>-1){for(le=Q;le<Y;le++)_[le]=V;Q=-1}U[Y]==="B"&&(_[Y]=0),q.hiLevel|=V}i&&function(X,ee,de){for(var ue=0;ue<de;ue++)if(X[ue]==="S"){ee[ue]=S;for(var me=ue-1;me>=0&&X[me]==="WS";me--)ee[me]=S}}(U,_,ie)},G=function(A,_,q,H,le){if(!(le.hiLevel<A)){if(A===1&&S===1&&!s)return _.reverse(),void(q&&q.reverse());for(var Y,V,Z,Q,ie=_.length,ge=0;ge<ie;){if(H[ge]>=A){for(Z=ge+1;Z<ie&&H[Z]>=A;)Z++;for(Q=ge,V=Z-1;Q<V;Q++,V--)Y=_[Q],_[Q]=_[V],_[V]=Y,q&&(Y=q[Q],q[Q]=q[V],q[V]=Y);ge=Z}ge++}}},J=function(A,_,q){var H=A.split(""),le={hiLevel:S};return q||(q=[]),M(H,q,le),function(Y,V,Z){if(Z.hiLevel!==0&&g)for(var Q,ie=0;ie<Y.length;ie++)V[ie]===1&&(Q=L.indexOf(Y[ie]))>=0&&(Y[ie]=L[Q+1])}(H,q,le),G(2,H,_,q,le),G(1,H,_,q,le),H.join("")};return this.__bidiEngine__.doBidiReorder=function(A,_,q){if(function(le,Y){if(Y)for(var V=0;V<le.length;V++)Y[V]=V;c===void 0&&(c=R(le)),h===void 0&&(h=R(le))}(A,_),o||!d||h)if(o&&d&&c^h)S=c?1:0,A=O(A,_,q);else if(!o&&d&&h)S=c?1:0,A=J(A,_,q),A=O(A,_);else if(!o||c||d||h){if(o&&!d&&c^h)A=O(A,_),c?(S=0,A=J(A,_,q)):(S=1,A=J(A,_,q),A=O(A,_));else if(o&&c&&!d&&h)S=1,A=J(A,_,q),A=O(A,_);else if(!o&&!d&&c^h){var H=g;c?(S=1,A=J(A,_,q),S=0,g=!1,A=J(A,_,q),g=H):(S=0,A=J(A,_,q),A=O(A,_),S=1,g=!1,A=J(A,_,q),g=H,A=O(A,_))}}else S=0,A=J(A,_,q);else S=c?1:0,A=J(A,_,q);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,d=A.isOutputVisual,c=A.isInputRtl,h=A.isOutputRtl,g=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var s=a.text,i=(a.x,a.y,a.options||{}),o=(a.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(o=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?o.push([r.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):o.push([r.doBidiReorder(s[c])]);a.text=o}else a.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Ue),Ue.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new aa(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new im(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new G0(this.contents),this.head=new $0(this),this.name=new Z0(this),this.cmap=new vu(this),this.toUnicode={},this.hhea=new J0(this),this.maxp=new em(this),this.hmtx=new tm(this),this.post=new X0(this),this.os2=new K0(this),this.loca=new sm(this),this.glyf=new rm(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,d,h;for(h=[],o=0,c=(d=this.bbox).length;o<c;o++)t=d[o],h.push(Math.round(t*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(a=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var s,i,o,c;for(o=0,i=0,c=(t=""+t).length;0<=c?i<c:i>c;i=0<=c?++i:--i)s=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var an,aa=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,s;for(s=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,s,i,o,c,d;return t=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),d=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^c)+(255^d)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*s+16777216*i+65536*o+256*c+d},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,s,i;for(i=[],a=0,s=t.length;a<s;a++)r=t[a],i.push(this.writeByte(r));return i},e}(),G0=function(){var e;function t(r){var a,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,s,i,o,c,d,h,g,x,y,m,v,N;for(N in m=Object.keys(r).length,d=Math.log(2),x=16*Math.floor(Math.log(m)/d),o=Math.floor(x/d),g=16*m-x,(s=new aa).writeInt(this.scalarType),s.writeShort(m),s.writeShort(x),s.writeShort(o),s.writeShort(g),i=16*m,h=s.pos+i,c=null,v=[],r)for(y=r[N],s.writeString(N),s.writeInt(e(y)),s.writeInt(h),s.writeInt(y.length),v=v.concat(y),N==="head"&&(c=h),h+=y.length;h%4;)v.push(0),h++;return s.write(v),a=2981146554-e(s.data),s.pos=c+8,s.writeUInt32(a),s.data},e=function(r){var a,s,i,o;for(r=bu.call(r);r.length%4;)r.push(0);for(i=new aa(r),s=0,a=0,o=r.length;a<o;a=a+=4)s+=i.readUInt32();return 4294967295&s},t}(),Y0={}.hasOwnProperty,bn=function(e,t){for(var r in t)Y0.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};an=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var $0=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var a;return(a=new aa).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},t}(),kd=function(){function e(t,r){var a,s,i,o,c,d,h,g,x,y,m,v,N,L,w,j,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),x=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=t.readByte();break;case 4:for(m=t.readUInt16(),y=m/2,t.pos+=6,i=function(){var I,R;for(R=[],d=I=0;0<=y?I<y:I>y;d=0<=y?++I:--I)R.push(t.readUInt16());return R}(),t.pos+=2,N=function(){var I,R;for(R=[],d=I=0;0<=y?I<y:I>y;d=0<=y?++I:--I)R.push(t.readUInt16());return R}(),h=function(){var I,R;for(R=[],d=I=0;0<=y?I<y:I>y;d=0<=y?++I:--I)R.push(t.readUInt16());return R}(),g=function(){var I,R;for(R=[],d=I=0;0<=y?I<y:I>y;d=0<=y?++I:--I)R.push(t.readUInt16());return R}(),s=(this.length-t.pos+this.offset)/2,c=function(){var I,R;for(R=[],d=I=0;0<=s?I<s:I>s;d=0<=s?++I:--I)R.push(t.readUInt16());return R}(),d=w=0,S=i.length;w<S;d=++w)for(L=i[d],a=j=v=N[d];v<=L?j<=L:j>=L;a=v<=L?++j:--j)g[d]===0?o=a+h[d]:(o=c[g[d]/2+(a-v)-(y-d)]||0)!==0&&(o+=h[d]),this.codeMap[a]=65535&o}t.pos=x}return e.encode=function(t,r){var a,s,i,o,c,d,h,g,x,y,m,v,N,L,w,j,S,I,R,K,O,M,G,J,A,_,q,H,le,Y,V,Z,Q,ie,ge,k,B,U,X,ee,de,ue,me,ke,_e,Ce;switch(H=new aa,o=Object.keys(t).sort(function(Ee,Ve){return Ee-Ve}),r){case"macroman":for(N=0,L=function(){var Ee=[];for(v=0;v<256;++v)Ee.push(0);return Ee}(),j={0:0},i={},le=0,Q=o.length;le<Q;le++)j[me=t[s=o[le]]]==null&&(j[me]=++N),i[s]={old:t[s],new:j[t[s]]},L[s]=j[t[s]];return H.writeUInt16(1),H.writeUInt16(0),H.writeUInt32(12),H.writeUInt16(0),H.writeUInt16(262),H.writeUInt16(0),H.write(L),{charMap:i,subtable:H.data,maxGlyphID:N+1};case"unicode":for(_=[],x=[],S=0,j={},a={},w=h=null,Y=0,ie=o.length;Y<ie;Y++)j[R=t[s=o[Y]]]==null&&(j[R]=++S),a[s]={old:R,new:j[R]},c=j[R]-s,w!=null&&c===h||(w&&x.push(w),_.push(s),h=c),w=s;for(w&&x.push(w),x.push(65535),_.push(65535),J=2*(G=_.length),M=2*Math.pow(Math.log(G)/Math.LN2,2),y=Math.log(M/2)/Math.LN2,O=2*G-M,d=[],K=[],m=[],v=V=0,ge=_.length;V<ge;v=++V){if(A=_[v],g=x[v],A===65535){d.push(0),K.push(0);break}if(A-(q=a[A].new)>=32768)for(d.push(0),K.push(2*(m.length+G-v)),s=Z=A;A<=g?Z<=g:Z>=g;s=A<=g?++Z:--Z)m.push(a[s].new);else d.push(q-A),K.push(0)}for(H.writeUInt16(3),H.writeUInt16(1),H.writeUInt32(12),H.writeUInt16(4),H.writeUInt16(16+8*G+2*m.length),H.writeUInt16(0),H.writeUInt16(J),H.writeUInt16(M),H.writeUInt16(y),H.writeUInt16(O),de=0,k=x.length;de<k;de++)s=x[de],H.writeUInt16(s);for(H.writeUInt16(0),ue=0,B=_.length;ue<B;ue++)s=_[ue],H.writeUInt16(s);for(ke=0,U=d.length;ke<U;ke++)c=d[ke],H.writeUInt16(c);for(_e=0,X=K.length;_e<X;_e++)I=K[_e],H.writeUInt16(I);for(Ce=0,ee=m.length;Ce<ee;Ce++)N=m[Ce],H.writeUInt16(N);return{charMap:a,subtable:H.data,maxGlyphID:S+1}}},e}(),vu=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="cmap",t.prototype.parse=function(r){var a,s,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)a=new kd(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(r,a){var s,i;return a==null&&(a="macroman"),s=kd.encode(r,a),(i=new aa).writeUInt16(0),i.writeUInt16(1),s.table=i.data.concat(s.subtable),s},t}(),J0=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),K0=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var a,s;for(s=[],a=0;a<10;++a)s.push(r.readByte());return s}(),this.charRange=function(){var a,s;for(s=[],a=0;a<4;++a)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var a,s;for(s=[],a=0;a<2;a=++a)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),X0=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="post",t.prototype.parse=function(r){var a,s,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(s=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)a=r.readByte(),i.push(this.names.push(r.readString(a)));return i;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var c,d,h;for(h=[],o=c=0,d=this.file.maxp.numGlyphs;0<=d?c<d:c>d;o=0<=d?++c:--c)h.push(r.readUInt32());return h}).call(this)}},t}(),Q0=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Z0=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="name",t.prototype.parse=function(r){var a,s,i,o,c,d,h,g,x,y,m;for(r.pos=this.offset,r.readShort(),a=r.readShort(),d=r.readShort(),s=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+d+r.readShort()});for(h={},o=x=0,y=s.length;x<y;o=++x)i=s[o],r.pos=i.offset,g=r.readString(i.length),c=new Q0(g,i),h[m=i.nameID]==null&&(h[m]=[]),h[i.nameID].push(c);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},t}(),em=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),tm=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="hmtx",t.prototype.parse=function(r){var a,s,i,o,c,d,h;for(r.pos=this.offset,this.metrics=[],a=0,d=this.file.hhea.numberOfMetrics;0<=d?a<d:a>d;a=0<=d?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var g,x;for(x=[],a=g=0;0<=i?g<i:g>i;a=0<=i?++g:--g)x.push(r.readInt16());return x}(),this.widths=(function(){var g,x,y,m;for(m=[],g=0,x=(y=this.metrics).length;g<x;g++)o=y[g],m.push(o.advance);return m}).call(this),s=this.widths[this.widths.length-1],h=[],a=c=0;0<=i?c<i:c>i;a=0<=i?++c:--c)h.push(this.widths.push(s));return h},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),bu=[].slice,rm=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var a,s,i,o,c,d,h,g,x,y;return r in this.cache?this.cache[r]:(o=this.file.loca,a=this.file.contents,s=o.indexOf(r),(i=o.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+s,c=(d=new aa(a.read(i))).readShort(),g=d.readShort(),y=d.readShort(),h=d.readShort(),x=d.readShort(),this.cache[r]=c===-1?new am(d,g,y,h,x):new nm(d,c,g,y,h,x),this.cache[r]))},t.prototype.encode=function(r,a,s){var i,o,c,d,h;for(c=[],o=[],d=0,h=a.length;d<h;d++)i=r[a[d]],o.push(c.length),i&&(c=c.concat(i.encode(s)));return o.push(c.length),{table:c,offsets:o}},t}(),nm=function(){function e(t,r,a,s,i,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),am=function(){function e(t,r,a,s,i){var o,c;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new aa(bu.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),sm=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return bn(t,an),t.prototype.tag="loca",t.prototype.parse=function(r){var a,s;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,o;for(o=[],s=0,i=this.length;s<i;s+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],s=0,i=this.length;s<i;s+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,a){for(var s=new Uint32Array(this.offsets.length),i=0,o=0,c=0;c<s.length;++c)if(s[c]=i,o<a.length&&a[o]==c){++o,s[c]=i;var d=this.offsets[c],h=this.offsets[c+1]-d;h>0&&(i+=h)}for(var g=new Array(4*s.length),x=0;x<s.length;++x)g[4*x+3]=255&s[x],g[4*x+2]=(65280&s[x])>>8,g[4*x+1]=(16711680&s[x])>>16,g[4*x]=(4278190080&s[x])>>24;return g},t}(),im=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,s,i;for(r in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[r],t[r]=s[a];return t},e.prototype.glyphsFor=function(t){var r,a,s,i,o,c,d;for(s={},o=0,c=t.length;o<c;o++)s[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(a=s[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in d=this.glyphsFor(r))a=d[i],s[i]=a;return s},e.prototype.encode=function(t,r){var a,s,i,o,c,d,h,g,x,y,m,v,N,L,w;for(s in a=vu.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),m={0:0},w=a.charMap)m[(d=w[s]).old]=d.new;for(v in y=a.maxGlyphID,o)v in m||(m[v]=y++);return g=function(j){var S,I;for(S in I={},j)I[j[S]]=S;return I}(m),x=Object.keys(g).sort(function(j,S){return j-S}),N=function(){var j,S,I;for(I=[],j=0,S=x.length;j<S;j++)c=x[j],I.push(g[c]);return I}(),i=this.font.glyf.encode(o,N,m),h=this.font.loca.encode(i.offsets,N),L={cmap:this.font.cmap.raw(),glyf:i.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(L["OS/2"]=this.font.os2.raw()),this.font.directory.encode(L)},e}();Ue.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,s,i,o;if(Array.isArray(r))return"["+function(){var c,d,h;for(h=[],c=0,d=r.length;c<d;c++)a=r[c],h.push(t.convert(a));return h}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();const om=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:B0,AcroFormAppearance:Be,AcroFormButton:Kt,AcroFormCheckBox:ai,AcroFormChoiceField:Na,AcroFormComboBox:Sa,AcroFormEditBox:ri,AcroFormListBox:ja,AcroFormPasswordField:si,AcroFormPushButton:ni,AcroFormRadioButton:_a,AcroFormTextField:ea,GState:ci,ShadingPattern:Xn,TilingPattern:wa,default:Ue,jsPDF:Ue},Symbol.toStringTag,{value:"Module"}));var lm={exports:{}};const cm=Vh(om);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(a,s){e.exports=s(function(){try{return cm}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Pl<"u"?Pl:typeof window<"u"?window:typeof self<"u"?self:Pl,function(r){return function(){var a={172:function(c,d){var h=this&&this.__extends||function(){var y=function(m,v){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,L){N.__proto__=L}||function(N,L){for(var w in L)Object.prototype.hasOwnProperty.call(L,w)&&(N[w]=L[w])},y(m,v)};return function(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");y(m,v);function N(){this.constructor=m}m.prototype=v===null?Object.create(v):(N.prototype=v.prototype,new N)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.CellHookData=d.HookData=void 0;var g=function(){function y(m,v,N){this.table=v,this.pageNumber=v.pageNumber,this.pageCount=this.pageNumber,this.settings=v.settings,this.cursor=N,this.doc=m.getDocument()}return y}();d.HookData=g;var x=function(y){h(m,y);function m(v,N,L,w,j,S){var I=y.call(this,v,N,S)||this;return I.cell=L,I.row=w,I.column=j,I.section=w.section,I}return m}(g);d.CellHookData=x},340:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0});var g=h(4),x=h(136),y=h(744),m=h(776),v=h(664),N=h(972);function L(w){w.API.autoTable=function(){for(var j=[],S=0;S<arguments.length;S++)j[S]=arguments[S];var I;j.length===1?I=j[0]:(console.error("Use of deprecated autoTable initiation"),I=j[2]||{},I.columns=j[0],I.body=j[1]);var R=(0,m.parseInput)(this,I),K=(0,N.createTable)(this,R);return(0,v.drawTable)(this,K),this},w.API.lastAutoTable=!1,w.API.previousAutoTable=!1,w.API.autoTable.previous=!1,w.API.autoTableText=function(j,S,I,R){(0,x.default)(j,S,I,R,this)},w.API.autoTableSetDefaults=function(j){return y.DocHandler.setDefaults(j,this),this},w.autoTableSetDefaults=function(j,S){y.DocHandler.setDefaults(j,S)},w.API.autoTableHtmlToJson=function(j,S){var I;if(S===void 0&&(S=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var R=new y.DocHandler(this),K=(0,g.parseHtml)(R,j,window,S,!1),O=K.head,M=K.body,G=((I=O[0])===null||I===void 0?void 0:I.map(function(J){return J.content}))||[];return{columns:G,rows:M,data:M}},w.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var j=this.lastAutoTable;return j&&j.finalY?j.finalY:0},w.API.autoTableAddPageContent=function(j){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),w.API.autoTable.globalDefaults||(w.API.autoTable.globalDefaults={}),w.API.autoTable.globalDefaults.addPageContent=j,this},w.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}d.default=L},136:function(c,d){Object.defineProperty(d,"__esModule",{value:!0});function h(g,x,y,m,v){m=m||{};var N=1.15,L=v.internal.scaleFactor,w=v.internal.getFontSize()/L,j=v.getLineHeightFactor?v.getLineHeightFactor():N,S=w*j,I=/\r\n|\r|\n/g,R="",K=1;if((m.valign==="middle"||m.valign==="bottom"||m.halign==="center"||m.halign==="right")&&(R=typeof g=="string"?g.split(I):g,K=R.length||1),y+=w*(2-N),m.valign==="middle"?y-=K/2*S:m.valign==="bottom"&&(y-=K*S),m.halign==="center"||m.halign==="right"){var O=w;if(m.halign==="center"&&(O*=.5),R&&K>=1){for(var M=0;M<R.length;M++)v.text(R[M],x-v.getStringUnitWidth(R[M])*O,y),y+=S;return v}x-=v.getStringUnitWidth(g)*O}return m.halign==="justify"?v.text(g,x,y,{maxWidth:m.maxWidth||100,align:"justify"}):v.text(g,x,y),v}d.default=h},420:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.getPageAvailableWidth=d.parseSpacing=d.getFillStyle=d.addTableBorder=d.getStringWidth=void 0;function h(v,N,L){L.applyStyles(N,!0);var w=Array.isArray(v)?v:[v],j=w.map(function(S){return L.getTextWidth(S)}).reduce(function(S,I){return Math.max(S,I)},0);return j}d.getStringWidth=h;function g(v,N,L,w){var j=N.settings.tableLineWidth,S=N.settings.tableLineColor;v.applyStyles({lineWidth:j,lineColor:S});var I=x(j,!1);I&&v.rect(L.x,L.y,N.getWidth(v.pageSize().width),w.y-L.y,I)}d.addTableBorder=g;function x(v,N){var L=v>0,w=N||N===0;return L&&w?"DF":L?"S":w?"F":null}d.getFillStyle=x;function y(v,N){var L,w,j,S;if(v=v||N,Array.isArray(v)){if(v.length>=4)return{top:v[0],right:v[1],bottom:v[2],left:v[3]};if(v.length===3)return{top:v[0],right:v[1],bottom:v[2],left:v[1]};if(v.length===2)return{top:v[0],right:v[1],bottom:v[0],left:v[1]};v.length===1?v=v[0]:v=N}return typeof v=="object"?(typeof v.vertical=="number"&&(v.top=v.vertical,v.bottom=v.vertical),typeof v.horizontal=="number"&&(v.right=v.horizontal,v.left=v.horizontal),{left:(L=v.left)!==null&&L!==void 0?L:N,top:(w=v.top)!==null&&w!==void 0?w:N,right:(j=v.right)!==null&&j!==void 0?j:N,bottom:(S=v.bottom)!==null&&S!==void 0?S:N}):(typeof v!="number"&&(v=N),{top:v,right:v,bottom:v,left:v})}d.parseSpacing=y;function m(v,N){var L=y(N.settings.margin,0);return v.pageSize().width-(L.left+L.right)}d.getPageAvailableWidth=m},796:function(c,d){var h=this&&this.__extends||function(){var m=function(v,N){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,w){L.__proto__=w}||function(L,w){for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(L[j]=w[j])},m(v,N)};return function(v,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");m(v,N);function L(){this.constructor=v}v.prototype=N===null?Object.create(N):(L.prototype=N.prototype,new L)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.getTheme=d.defaultStyles=d.HtmlRowInput=void 0;var g=function(m){h(v,m);function v(N){var L=m.call(this)||this;return L._element=N,L}return v}(Array);d.HtmlRowInput=g;function x(m){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/m,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}d.defaultStyles=x;function y(m){var v={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return v[m]}d.getTheme=y},903:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.parseCss=void 0;var g=h(420);function x(L,w,j,S,I){var R={},K=1.3333333333333333,O=m(w,function(Q){return I.getComputedStyle(Q).backgroundColor});O!=null&&(R.fillColor=O);var M=m(w,function(Q){return I.getComputedStyle(Q).color});M!=null&&(R.textColor=M);var G=N(S,j);G&&(R.cellPadding=G);var J="borderTopColor",A=K*j,_=S.borderTopWidth;if(S.borderBottomWidth===_&&S.borderRightWidth===_&&S.borderLeftWidth===_){var q=(parseFloat(_)||0)/A;q&&(R.lineWidth=q)}else R.lineWidth={top:(parseFloat(S.borderTopWidth)||0)/A,right:(parseFloat(S.borderRightWidth)||0)/A,bottom:(parseFloat(S.borderBottomWidth)||0)/A,left:(parseFloat(S.borderLeftWidth)||0)/A},R.lineWidth.top||(R.lineWidth.right?J="borderRightColor":R.lineWidth.bottom?J="borderBottomColor":R.lineWidth.left&&(J="borderLeftColor"));var H=m(w,function(Q){return I.getComputedStyle(Q)[J]});H!=null&&(R.lineColor=H);var le=["left","right","center","justify"];le.indexOf(S.textAlign)!==-1&&(R.halign=S.textAlign),le=["middle","bottom","top"],le.indexOf(S.verticalAlign)!==-1&&(R.valign=S.verticalAlign);var Y=parseInt(S.fontSize||"");isNaN(Y)||(R.fontSize=Y/K);var V=y(S);V&&(R.fontStyle=V);var Z=(S.fontFamily||"").toLowerCase();return L.indexOf(Z)!==-1&&(R.font=Z),R}d.parseCss=x;function y(L){var w="";return(L.fontWeight==="bold"||L.fontWeight==="bolder"||parseInt(L.fontWeight)>=700)&&(w="bold"),(L.fontStyle==="italic"||L.fontStyle==="oblique")&&(w+="italic"),w}function m(L,w){var j=v(L,w);if(!j)return null;var S=j.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!S||!Array.isArray(S))return null;var I=[parseInt(S[1]),parseInt(S[2]),parseInt(S[3])],R=parseInt(S[4]);return R===0||isNaN(I[0])||isNaN(I[1])||isNaN(I[2])?null:I}function v(L,w){var j=w(L);return j==="rgba(0, 0, 0, 0)"||j==="transparent"||j==="initial"||j==="inherit"?L.parentElement==null?null:v(L.parentElement,w):j}function N(L,w){var j=[L.paddingTop,L.paddingRight,L.paddingBottom,L.paddingLeft],S=96/(72/w),I=(parseInt(L.lineHeight)-parseInt(L.fontSize))/w/2,R=j.map(function(O){return parseInt(O||"0")/S}),K=(0,g.parseSpacing)(R,0);return I>K.top&&(K.top=I),I>K.bottom&&(K.bottom=I),K}},744:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.DocHandler=void 0;var h={},g=function(){function x(y){this.jsPDFDocument=y,this.userStyles={textColor:y.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:y.internal.getFontSize(),fontStyle:y.internal.getFont().fontStyle,font:y.internal.getFont().fontName,lineWidth:y.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:y.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return x.setDefaults=function(y,m){m===void 0&&(m=null),m?m.__autoTableDocumentDefaults=y:h=y},x.unifyColor=function(y){return Array.isArray(y)?y:typeof y=="number"?[y,y,y]:typeof y=="string"?[y]:null},x.prototype.applyStyles=function(y,m){var v,N,L;m===void 0&&(m=!1),y.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(y.fontStyle);var w=this.jsPDFDocument.internal.getFont(),j=w.fontStyle,S=w.fontName;if(y.font&&(S=y.font),y.fontStyle){j=y.fontStyle;var I=this.getFontList()[S];I&&I.indexOf(j)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(I[0]),j=I[0])}if(this.jsPDFDocument.setFont(S,j),y.fontSize&&this.jsPDFDocument.setFontSize(y.fontSize),!m){var R=x.unifyColor(y.fillColor);R&&(v=this.jsPDFDocument).setFillColor.apply(v,R),R=x.unifyColor(y.textColor),R&&(N=this.jsPDFDocument).setTextColor.apply(N,R),R=x.unifyColor(y.lineColor),R&&(L=this.jsPDFDocument).setDrawColor.apply(L,R),typeof y.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(y.lineWidth)}},x.prototype.splitTextToSize=function(y,m,v){return this.jsPDFDocument.splitTextToSize(y,m,v)},x.prototype.rect=function(y,m,v,N,L){return this.jsPDFDocument.rect(y,m,v,N,L)},x.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},x.prototype.getTextWidth=function(y){return this.jsPDFDocument.getTextWidth(y)},x.prototype.getDocument=function(){return this.jsPDFDocument},x.prototype.setPage=function(y){this.jsPDFDocument.setPage(y)},x.prototype.addPage=function(){return this.jsPDFDocument.addPage()},x.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},x.prototype.getGlobalOptions=function(){return h||{}},x.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},x.prototype.pageSize=function(){var y=this.jsPDFDocument.internal.pageSize;return y.width==null&&(y={width:y.getWidth(),height:y.getHeight()}),y},x.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},x.prototype.getLineHeightFactor=function(){var y=this.jsPDFDocument;return y.getLineHeightFactor?y.getLineHeightFactor():1.15},x.prototype.getLineHeight=function(y){return y/this.scaleFactor()*this.getLineHeightFactor()},x.prototype.pageNumber=function(){var y=this.jsPDFDocument.internal.getCurrentPageInfo();return y?y.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},x}();d.DocHandler=g},4:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.parseHtml=void 0;var g=h(903),x=h(796);function y(N,L,w,j,S){var I,R;j===void 0&&(j=!1),S===void 0&&(S=!1);var K;typeof L=="string"?K=w.document.querySelector(L):K=L;var O=Object.keys(N.getFontList()),M=N.scaleFactor(),G=[],J=[],A=[];if(!K)return console.error("Html table could not be found with input: ",L),{head:G,body:J,foot:A};for(var _=0;_<K.rows.length;_++){var q=K.rows[_],H=(R=(I=q==null?void 0:q.parentElement)===null||I===void 0?void 0:I.tagName)===null||R===void 0?void 0:R.toLowerCase(),le=m(O,M,w,q,j,S);le&&(H==="thead"?G.push(le):H==="tfoot"?A.push(le):J.push(le))}return{head:G,body:J,foot:A}}d.parseHtml=y;function m(N,L,w,j,S,I){for(var R=new x.HtmlRowInput(j),K=0;K<j.cells.length;K++){var O=j.cells[K],M=w.getComputedStyle(O);if(S||M.display!=="none"){var G=void 0;I&&(G=(0,g.parseCss)(N,O,L,M,w)),R.push({rowSpan:O.rowSpan,colSpan:O.colSpan,styles:G,_element:O,content:v(O)})}}var J=w.getComputedStyle(j);if(R.length>0&&(S||J.display!=="none"))return R}function v(N){var L=N.cloneNode(!0);return L.innerHTML=L.innerHTML.replace(/\n/g,"").replace(/ +/g," "),L.innerHTML=L.innerHTML.split(/<br.*?>/).map(function(w){return w.trim()}).join(`
`),L.innerText||L.textContent||""}},776:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.parseInput=void 0;var g=h(4),x=h(356),y=h(420),m=h(744),v=h(792);function N(K,O){var M=new m.DocHandler(K),G=M.getDocumentOptions(),J=M.getGlobalOptions();(0,v.default)(M,J,G,O);var A=(0,x.assign)({},J,G,O),_;typeof window<"u"&&(_=window);var q=L(J,G,O),H=w(J,G,O),le=j(M,A),Y=I(M,A,_);return{id:O.tableId,content:Y,hooks:H,styles:q,settings:le}}d.parseInput=N;function L(K,O,M){for(var G={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},J=function(H){if(H==="columnStyles"){var le=K[H],Y=O[H],V=M[H];G.columnStyles=(0,x.assign)({},le,Y,V)}else{var Z=[K,O,M],Q=Z.map(function(ie){return ie[H]||{}});G[H]=(0,x.assign)({},Q[0],Q[1],Q[2])}},A=0,_=Object.keys(G);A<_.length;A++){var q=_[A];J(q)}return G}function w(K,O,M){for(var G=[K,O,M],J={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},A=0,_=G;A<_.length;A++){var q=_[A];q.didParseCell&&J.didParseCell.push(q.didParseCell),q.willDrawCell&&J.willDrawCell.push(q.willDrawCell),q.didDrawCell&&J.didDrawCell.push(q.didDrawCell),q.willDrawPage&&J.willDrawPage.push(q.willDrawPage),q.didDrawPage&&J.didDrawPage.push(q.didDrawPage)}return J}function j(K,O){var M,G,J,A,_,q,H,le,Y,V,Z,Q,ie=(0,y.parseSpacing)(O.margin,40/K.scaleFactor()),ge=(M=S(K,O.startY))!==null&&M!==void 0?M:ie.top,k;O.showFoot===!0?k="everyPage":O.showFoot===!1?k="never":k=(G=O.showFoot)!==null&&G!==void 0?G:"everyPage";var B;O.showHead===!0?B="everyPage":O.showHead===!1?B="never":B=(J=O.showHead)!==null&&J!==void 0?J:"everyPage";var U=(A=O.useCss)!==null&&A!==void 0?A:!1,X=O.theme||(U?"plain":"striped"),ee=!!O.horizontalPageBreak,de=(_=O.horizontalPageBreakRepeat)!==null&&_!==void 0?_:null;return{includeHiddenHtml:(q=O.includeHiddenHtml)!==null&&q!==void 0?q:!1,useCss:U,theme:X,startY:ge,margin:ie,pageBreak:(H=O.pageBreak)!==null&&H!==void 0?H:"auto",rowPageBreak:(le=O.rowPageBreak)!==null&&le!==void 0?le:"auto",tableWidth:(Y=O.tableWidth)!==null&&Y!==void 0?Y:"auto",showHead:B,showFoot:k,tableLineWidth:(V=O.tableLineWidth)!==null&&V!==void 0?V:0,tableLineColor:(Z=O.tableLineColor)!==null&&Z!==void 0?Z:200,horizontalPageBreak:ee,horizontalPageBreakRepeat:de,horizontalPageBreakBehaviour:(Q=O.horizontalPageBreakBehaviour)!==null&&Q!==void 0?Q:"afterAllRows"}}function S(K,O){var M=K.getLastAutoTable(),G=K.scaleFactor(),J=K.pageNumber(),A=!1;if(M&&M.startPageNumber){var _=M.startPageNumber+M.pageNumber-1;A=_===J}return typeof O=="number"?O:(O==null||O===!1)&&A&&(M==null?void 0:M.finalY)!=null?M.finalY+20/G:null}function I(K,O,M){var G=O.head||[],J=O.body||[],A=O.foot||[];if(O.html){var _=O.includeHiddenHtml;if(M){var q=(0,g.parseHtml)(K,O.html,M,_,O.useCss)||{};G=q.head||G,J=q.body||G,A=q.foot||G}else console.error("Cannot parse html in non browser environment")}var H=O.columns||R(G,J,A);return{columns:H,head:G,body:J,foot:A}}function R(K,O,M){var G=K[0]||O[0]||M[0]||[],J=[];return Object.keys(G).filter(function(A){return A!=="_element"}).forEach(function(A){var _=1,q;Array.isArray(G)?q=G[parseInt(A)]:q=G[A],typeof q=="object"&&!Array.isArray(q)&&(_=(q==null?void 0:q.colSpan)||1);for(var H=0;H<_;H++){var le=void 0;Array.isArray(G)?le=J.length:le=A+(H>0?"_".concat(H):"");var Y={dataKey:le};J.push(Y)}}),J}},792:function(c,d){Object.defineProperty(d,"__esModule",{value:!0});function h(x,y,m,v){for(var N=function(S){S&&typeof S!="object"&&console.error("The options parameter should be of type object, is: "+typeof S),typeof S.extendWidth<"u"&&(S.tableWidth=S.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof S.margins<"u"&&(typeof S.margin>"u"&&(S.margin=S.margins),console.error("Use of deprecated option: margins, use margin instead.")),S.startY&&typeof S.startY!="number"&&(console.error("Invalid value for startY option",S.startY),delete S.startY),!S.didDrawPage&&(S.afterPageContent||S.beforePageContent||S.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),S.didDrawPage=function(A){x.applyStyles(x.userStyles),S.beforePageContent&&S.beforePageContent(A),x.applyStyles(x.userStyles),S.afterPageContent&&S.afterPageContent(A),x.applyStyles(x.userStyles),S.afterPageAdd&&A.pageNumber>1&&A.afterPageAdd(A),x.applyStyles(x.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(A){S[A]&&console.error('The "'.concat(A,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(A){var _=A[0],q=A[1];S[q]&&(console.error("Use of deprecated option ".concat(q,". Use ").concat(_," instead")),S[_]=S[q])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(A){var _=typeof A=="string"?A:A[0],q=typeof A=="string"?A:A[1];typeof S[_]<"u"&&(typeof S.styles[q]>"u"&&(S.styles[q]=S[_]),console.error("Use of deprecated option: "+_+", use the style "+q+" instead."))});for(var I=0,R=["styles","bodyStyles","headStyles","footStyles"];I<R.length;I++){var K=R[I];g(S[K]||{})}for(var O=S.columnStyles||{},M=0,G=Object.keys(O);M<G.length;M++){var J=G[M];g(O[J]||{})}},L=0,w=[y,m,v];L<w.length;L++){var j=w[L];N(j)}}d.default=h;function g(x){x.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),x.minCellHeight||(x.minCellHeight=x.rowHeight)):x.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),x.cellWidth||(x.cellWidth=x.columnWidth))}},260:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.Column=d.Cell=d.Row=d.Table=void 0;var g=h(796),x=h(172),y=h(420),m=function(){function w(j,S){this.pageNumber=1,this.pageCount=1,this.id=j.id,this.settings=j.settings,this.styles=j.styles,this.hooks=j.hooks,this.columns=S.columns,this.head=S.head,this.body=S.body,this.foot=S.foot}return w.prototype.getHeadHeight=function(j){return this.head.reduce(function(S,I){return S+I.getMaxCellHeight(j)},0)},w.prototype.getFootHeight=function(j){return this.foot.reduce(function(S,I){return S+I.getMaxCellHeight(j)},0)},w.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},w.prototype.callCellHooks=function(j,S,I,R,K,O){for(var M=0,G=S;M<G.length;M++){var J=G[M],A=new x.CellHookData(j,this,I,R,K,O),_=J(A)===!1;if(I.text=Array.isArray(I.text)?I.text:[I.text],_)return!1}return!0},w.prototype.callEndPageHooks=function(j,S){j.applyStyles(j.userStyles);for(var I=0,R=this.hooks.didDrawPage;I<R.length;I++){var K=R[I];K(new x.HookData(j,this,S))}},w.prototype.callWillDrawPageHooks=function(j,S){for(var I=0,R=this.hooks.willDrawPage;I<R.length;I++){var K=R[I];K(new x.HookData(j,this,S))}},w.prototype.getWidth=function(j){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var S=this.columns.reduce(function(R,K){return R+K.wrappedWidth},0);return S}else{var I=this.settings.margin;return j-I.left-I.right}},w}();d.Table=m;var v=function(){function w(j,S,I,R,K){K===void 0&&(K=!1),this.height=0,this.raw=j,j instanceof g.HtmlRowInput&&(this.raw=j._element,this.element=j._element),this.index=S,this.section=I,this.cells=R,this.spansMultiplePages=K}return w.prototype.getMaxCellHeight=function(j){var S=this;return j.reduce(function(I,R){var K;return Math.max(I,((K=S.cells[R.index])===null||K===void 0?void 0:K.height)||0)},0)},w.prototype.hasRowSpan=function(j){var S=this;return j.filter(function(I){var R=S.cells[I.index];return R?R.rowSpan>1:!1}).length>0},w.prototype.canEntireRowFit=function(j,S){return this.getMaxCellHeight(S)<=j},w.prototype.getMinimumRowHeight=function(j,S){var I=this;return j.reduce(function(R,K){var O=I.cells[K.index];if(!O)return 0;var M=S.getLineHeight(O.styles.fontSize),G=O.padding("vertical"),J=G+M;return J>R?J:R},0)},w}();d.Row=v;var N=function(){function w(j,S,I){var R,K;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=S,this.section=I,this.raw=j;var O=j;j!=null&&typeof j=="object"&&!Array.isArray(j)?(this.rowSpan=j.rowSpan||1,this.colSpan=j.colSpan||1,O=(K=(R=j.content)!==null&&R!==void 0?R:j.title)!==null&&K!==void 0?K:j,j._element&&(this.raw=j._element)):(this.rowSpan=1,this.colSpan=1);var M=O!=null?""+O:"",G=/\r\n|\r|\n/g;this.text=M.split(G)}return w.prototype.getTextPos=function(){var j;if(this.styles.valign==="top")j=this.y+this.padding("top");else if(this.styles.valign==="bottom")j=this.y+this.height-this.padding("bottom");else{var S=this.height-this.padding("vertical");j=this.y+S/2+this.padding("top")}var I;if(this.styles.halign==="right")I=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var R=this.width-this.padding("horizontal");I=this.x+R/2+this.padding("left")}else I=this.x+this.padding("left");return{x:I,y:j}},w.prototype.getContentHeight=function(j,S){S===void 0&&(S=1.15);var I=Array.isArray(this.text)?this.text.length:1,R=this.styles.fontSize/j*S,K=I*R+this.padding("vertical");return Math.max(K,this.styles.minCellHeight)},w.prototype.padding=function(j){var S=(0,y.parseSpacing)(this.styles.cellPadding,0);return j==="vertical"?S.top+S.bottom:j==="horizontal"?S.left+S.right:S[j]},w}();d.Cell=N;var L=function(){function w(j,S,I){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=j,this.raw=S,this.index=I}return w.prototype.getMaxCustomCellWidth=function(j){for(var S=0,I=0,R=j.allRows();I<R.length;I++){var K=R[I],O=K.cells[this.index];O&&typeof O.styles.cellWidth=="number"&&(S=Math.max(S,O.styles.cellWidth))}return S},w}();d.Column=L},356:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.assign=void 0;function h(g,x,y,m,v){if(g==null)throw new TypeError("Cannot convert undefined or null to object");for(var N=Object(g),L=1;L<arguments.length;L++){var w=arguments[L];if(w!=null)for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(N[j]=w[j])}return N}d.assign=h},972:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.createTable=void 0;var g=h(744),x=h(260),y=h(324),m=h(796),v=h(356);function N(K,O){var M=new g.DocHandler(K),G=L(O,M.scaleFactor()),J=new x.Table(O,G);return(0,y.calculateWidths)(M,J),M.applyStyles(M.userStyles),J}d.createTable=N;function L(K,O){var M=K.content,G=I(M.columns);if(M.head.length===0){var J=j(G,"head");J&&M.head.push(J)}if(M.foot.length===0){var J=j(G,"foot");J&&M.foot.push(J)}var A=K.settings.theme,_=K.styles;return{columns:G,head:w("head",M.head,G,_,A,O),body:w("body",M.body,G,_,A,O),foot:w("foot",M.foot,G,_,A,O)}}function w(K,O,M,G,J,A){var _={},q=O.map(function(H,le){for(var Y=0,V={},Z=0,Q=0,ie=0,ge=M;ie<ge.length;ie++){var k=ge[ie];if(_[k.index]==null||_[k.index].left===0)if(Q===0){var B=void 0;Array.isArray(H)?B=H[k.index-Z-Y]:B=H[k.dataKey];var U={};typeof B=="object"&&!Array.isArray(B)&&(U=(B==null?void 0:B.styles)||{});var X=R(K,k,le,J,G,A,U),ee=new x.Cell(B,X,K);V[k.dataKey]=ee,V[k.index]=ee,Q=ee.colSpan-1,_[k.index]={left:ee.rowSpan-1,times:Q}}else Q--,Z++;else _[k.index].left--,Q=_[k.index].times,Y++}return new x.Row(H,le,K,V)});return q}function j(K,O){var M={};return K.forEach(function(G){if(G.raw!=null){var J=S(O,G.raw);J!=null&&(M[G.dataKey]=J)}}),Object.keys(M).length>0?M:null}function S(K,O){if(K==="head"){if(typeof O=="object")return O.header||O.title||null;if(typeof O=="string"||typeof O=="number")return O}else if(K==="foot"&&typeof O=="object")return O.footer;return null}function I(K){return K.map(function(O,M){var G,J,A;return typeof O=="object"?A=(J=(G=O.dataKey)!==null&&G!==void 0?G:O.key)!==null&&J!==void 0?J:M:A=M,new x.Column(A,O,M)})}function R(K,O,M,G,J,A,_){var q=(0,m.getTheme)(G),H;K==="head"?H=J.headStyles:K==="body"?H=J.bodyStyles:K==="foot"&&(H=J.footStyles);var le=(0,v.assign)({},q.table,q[K],J.styles,H),Y=J.columnStyles[O.dataKey]||J.columnStyles[O.index]||{},V=K==="body"?Y:{},Z=K==="body"&&M%2===0?(0,v.assign)({},q.alternateRow,J.alternateRowStyles):{},Q=(0,m.defaultStyles)(A),ie=(0,v.assign)({},Q,le,Z,V);return(0,v.assign)(ie,_)}},664:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.addPage=d.drawTable=void 0;var g=h(420),x=h(260),y=h(744),m=h(356),v=h(136),N=h(224);function L(Y,V){var Z=V.settings,Q=Z.startY,ie=Z.margin,ge={x:ie.left,y:Q},k=V.getHeadHeight(V.columns)+V.getFootHeight(V.columns),B=Q+ie.bottom+k;if(Z.pageBreak==="avoid"){var U=V.body,X=U.reduce(function(ue,me){return ue+me.height},0);B+=X}var ee=new y.DocHandler(Y);(Z.pageBreak==="always"||Z.startY!=null&&B>ee.pageSize().height)&&(le(ee),ge.y=ie.top),V.callWillDrawPageHooks(ee,ge);var de=(0,m.assign)({},ge);V.startPageNumber=ee.pageNumber(),Z.horizontalPageBreak?w(ee,V,de,ge):(ee.applyStyles(ee.userStyles),(Z.showHead==="firstPage"||Z.showHead==="everyPage")&&V.head.forEach(function(ue){return J(ee,V,ue,ge,V.columns)}),ee.applyStyles(ee.userStyles),V.body.forEach(function(ue,me){var ke=me===V.body.length-1;G(ee,V,ue,ke,de,ge,V.columns)}),ee.applyStyles(ee.userStyles),(Z.showFoot==="lastPage"||Z.showFoot==="everyPage")&&V.foot.forEach(function(ue){return J(ee,V,ue,ge,V.columns)})),(0,g.addTableBorder)(ee,V,de,ge),V.callEndPageHooks(ee,ge),V.finalY=ge.y,Y.lastAutoTable=V,Y.previousAutoTable=V,Y.autoTable&&(Y.autoTable.previous=V),ee.applyStyles(ee.userStyles)}d.drawTable=L;function w(Y,V,Z,Q){var ie=(0,N.calculateAllColumnsCanFitInPage)(Y,V),ge=V.settings;if(ge.horizontalPageBreakBehaviour==="afterAllRows")ie.forEach(function(X,ee){Y.applyStyles(Y.userStyles),ee>0?H(Y,V,Z,Q,X.columns,!0):j(Y,V,Q,X.columns),S(Y,V,Z,Q,X.columns),R(Y,V,Q,X.columns)});else for(var k=-1,B=ie[0],U=function(){var X=k;if(B){Y.applyStyles(Y.userStyles);var ee=B.columns;k>=0?H(Y,V,Z,Q,ee,!0):j(Y,V,Q,ee),X=I(Y,V,k+1,Q,ee),R(Y,V,Q,ee)}var de=X-k;ie.slice(1).forEach(function(ue){Y.applyStyles(Y.userStyles),H(Y,V,Z,Q,ue.columns,!0),I(Y,V,k+1,Q,ue.columns,de),R(Y,V,Q,ue.columns)}),k=X};k<V.body.length-1;)U()}function j(Y,V,Z,Q){var ie=V.settings;Y.applyStyles(Y.userStyles),(ie.showHead==="firstPage"||ie.showHead==="everyPage")&&V.head.forEach(function(ge){return J(Y,V,ge,Z,Q)})}function S(Y,V,Z,Q,ie){Y.applyStyles(Y.userStyles),V.body.forEach(function(ge,k){var B=k===V.body.length-1;G(Y,V,ge,B,Z,Q,ie)})}function I(Y,V,Z,Q,ie,ge){Y.applyStyles(Y.userStyles),ge=ge??V.body.length;var k=Math.min(Z+ge,V.body.length),B=-1;return V.body.slice(Z,k).forEach(function(U,X){var ee=Z+X===V.body.length-1,de=q(Y,V,ee,Q);U.canEntireRowFit(de,ie)&&(J(Y,V,U,Q,ie),B=Z+X)}),B}function R(Y,V,Z,Q){var ie=V.settings;Y.applyStyles(Y.userStyles),(ie.showFoot==="lastPage"||ie.showFoot==="everyPage")&&V.foot.forEach(function(ge){return J(Y,V,ge,Z,Q)})}function K(Y,V,Z){var Q=Z.getLineHeight(Y.styles.fontSize),ie=Y.padding("vertical"),ge=Math.floor((V-ie)/Q);return Math.max(0,ge)}function O(Y,V,Z,Q){var ie={};Y.spansMultiplePages=!0,Y.height=0;for(var ge=0,k=0,B=Z.columns;k<B.length;k++){var U=B[k],X=Y.cells[U.index];if(X){Array.isArray(X.text)||(X.text=[X.text]);var ee=new x.Cell(X.raw,X.styles,X.section);ee=(0,m.assign)(ee,X),ee.text=[];var de=K(X,V,Q);X.text.length>de&&(ee.text=X.text.splice(de,X.text.length));var ue=Q.scaleFactor(),me=Q.getLineHeightFactor();X.contentHeight=X.getContentHeight(ue,me),X.contentHeight>=V&&(X.contentHeight=V,ee.styles.minCellHeight-=V),X.contentHeight>Y.height&&(Y.height=X.contentHeight),ee.contentHeight=ee.getContentHeight(ue,me),ee.contentHeight>ge&&(ge=ee.contentHeight),ie[U.index]=ee}}var ke=new x.Row(Y.raw,-1,Y.section,ie,!0);ke.height=ge;for(var _e=0,Ce=Z.columns;_e<Ce.length;_e++){var U=Ce[_e],ee=ke.cells[U.index];ee&&(ee.height=ke.height);var X=Y.cells[U.index];X&&(X.height=Y.height)}return ke}function M(Y,V,Z,Q){var ie=Y.pageSize().height,ge=Q.settings.margin,k=ge.top+ge.bottom,B=ie-k;V.section==="body"&&(B-=Q.getHeadHeight(Q.columns)+Q.getFootHeight(Q.columns));var U=V.getMinimumRowHeight(Q.columns,Y),X=U<Z;if(U>B)return console.error("Will not be able to print row ".concat(V.index," correctly since it's minimum height is larger than page height")),!0;if(!X)return!1;var ee=V.hasRowSpan(Q.columns),de=V.getMaxCellHeight(Q.columns)>B;return de?(ee&&console.error("The content of row ".concat(V.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(ee||Q.settings.rowPageBreak==="avoid")}function G(Y,V,Z,Q,ie,ge,k){var B=q(Y,V,Q,ge);if(Z.canEntireRowFit(B,k))J(Y,V,Z,ge,k);else if(M(Y,Z,B,V)){var U=O(Z,B,V,Y);J(Y,V,Z,ge,k),H(Y,V,ie,ge,k),G(Y,V,U,Q,ie,ge,k)}else H(Y,V,ie,ge,k),G(Y,V,Z,Q,ie,ge,k)}function J(Y,V,Z,Q,ie){Q.x=V.settings.margin.left;for(var ge=0,k=ie;ge<k.length;ge++){var B=k[ge],U=Z.cells[B.index];if(!U){Q.x+=B.width;continue}Y.applyStyles(U.styles),U.x=Q.x,U.y=Q.y;var X=V.callCellHooks(Y,V.hooks.willDrawCell,U,Z,B,Q);if(X===!1){Q.x+=B.width;continue}A(Y,U,Q);var ee=U.getTextPos();(0,v.default)(U.text,ee.x,ee.y,{halign:U.styles.halign,valign:U.styles.valign,maxWidth:Math.ceil(U.width-U.padding("left")-U.padding("right"))},Y.getDocument()),V.callCellHooks(Y,V.hooks.didDrawCell,U,Z,B,Q),Q.x+=B.width}Q.y+=Z.height}function A(Y,V,Z){var Q=V.styles;if(Y.getDocument().setFillColor(Y.getDocument().getFillColor()),typeof Q.lineWidth=="number"){var ie=(0,g.getFillStyle)(Q.lineWidth,Q.fillColor);ie&&Y.rect(V.x,Z.y,V.width,V.height,ie)}else typeof Q.lineWidth=="object"&&(Q.fillColor&&Y.rect(V.x,Z.y,V.width,V.height,"F"),_(Y,V,Z,Q.lineWidth))}function _(Y,V,Z,Q){var ie,ge,k,B;Q.top&&(ie=Z.x,ge=Z.y,k=Z.x+V.width,B=Z.y,Q.right&&(k+=.5*Q.right),Q.left&&(ie-=.5*Q.left),U(Q.top,ie,ge,k,B)),Q.bottom&&(ie=Z.x,ge=Z.y+V.height,k=Z.x+V.width,B=Z.y+V.height,Q.right&&(k+=.5*Q.right),Q.left&&(ie-=.5*Q.left),U(Q.bottom,ie,ge,k,B)),Q.left&&(ie=Z.x,ge=Z.y,k=Z.x,B=Z.y+V.height,Q.top&&(ge-=.5*Q.top),Q.bottom&&(B+=.5*Q.bottom),U(Q.left,ie,ge,k,B)),Q.right&&(ie=Z.x+V.width,ge=Z.y,k=Z.x+V.width,B=Z.y+V.height,Q.top&&(ge-=.5*Q.top),Q.bottom&&(B+=.5*Q.bottom),U(Q.right,ie,ge,k,B));function U(X,ee,de,ue,me){Y.getDocument().setLineWidth(X),Y.getDocument().line(ee,de,ue,me,"S")}}function q(Y,V,Z,Q){var ie=V.settings.margin.bottom,ge=V.settings.showFoot;return(ge==="everyPage"||ge==="lastPage"&&Z)&&(ie+=V.getFootHeight(V.columns)),Y.pageSize().height-Q.y-ie}function H(Y,V,Z,Q,ie,ge){ie===void 0&&(ie=[]),ge===void 0&&(ge=!1),Y.applyStyles(Y.userStyles),V.settings.showFoot==="everyPage"&&!ge&&V.foot.forEach(function(B){return J(Y,V,B,Q,ie)}),V.callEndPageHooks(Y,Q);var k=V.settings.margin;(0,g.addTableBorder)(Y,V,Z,Q),le(Y),V.pageNumber++,V.pageCount++,Q.x=k.left,Q.y=k.top,Z.y=k.top,V.callWillDrawPageHooks(Y,Q),V.settings.showHead==="everyPage"&&(V.head.forEach(function(B){return J(Y,V,B,Q,ie)}),Y.applyStyles(Y.userStyles))}d.addPage=H;function le(Y){var V=Y.pageNumber();Y.setPage(V+1);var Z=Y.pageNumber();return Z===V?(Y.addPage(),!0):!1}},224:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.calculateAllColumnsCanFitInPage=void 0;var g=h(420);function x(m,v,N){var L;N===void 0&&(N={});var w=(0,g.getPageAvailableWidth)(m,v),j=new Map,S=[],I=[],R=[];v.settings.horizontalPageBreakRepeat,Array.isArray(v.settings.horizontalPageBreakRepeat)?R=v.settings.horizontalPageBreakRepeat:(typeof v.settings.horizontalPageBreakRepeat=="string"||typeof v.settings.horizontalPageBreakRepeat=="number")&&(R=[v.settings.horizontalPageBreakRepeat]),R.forEach(function(G){var J=v.columns.find(function(A){return A.dataKey===G||A.index===G});J&&!j.has(J.index)&&(j.set(J.index,!0),S.push(J.index),I.push(v.columns[J.index]),w-=J.wrappedWidth)});for(var K=!0,O=(L=N==null?void 0:N.start)!==null&&L!==void 0?L:0;O<v.columns.length;){if(j.has(O)){O++;continue}var M=v.columns[O].wrappedWidth;if(K||w>=M)K=!1,S.push(O),I.push(v.columns[O]),w-=M;else break;O++}return{colIndexes:S,columns:I,lastIndex:O-1}}function y(m,v){for(var N=[],L=0;L<v.columns.length;L++){var w=x(m,v,{start:L});w.columns.length&&(N.push(w),L=w.lastIndex)}return N}d.calculateAllColumnsCanFitInPage=y},324:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.ellipsize=d.resizeColumns=d.calculateWidths=void 0;var g=h(420);function x(S,I){y(S,I);var R=[],K=0;I.columns.forEach(function(M){var G=M.getMaxCustomCellWidth(I);G?M.width=G:(M.width=M.wrappedWidth,R.push(M)),K+=M.width});var O=I.getWidth(S.pageSize().width)-K;O&&(O=m(R,O,function(M){return Math.max(M.minReadableWidth,M.minWidth)})),O&&(O=m(R,O,function(M){return M.minWidth})),O=Math.abs(O),!I.settings.horizontalPageBreak&&O>.1/S.scaleFactor()&&(O=O<1?O:Math.round(O),console.warn("Of the table content, ".concat(O," units width could not fit page"))),N(I),L(I,S),v(I)}d.calculateWidths=x;function y(S,I){var R=S.scaleFactor(),K=I.settings.horizontalPageBreak,O=(0,g.getPageAvailableWidth)(S,I);I.allRows().forEach(function(M){for(var G=0,J=I.columns;G<J.length;G++){var A=J[G],_=M.cells[A.index];if(_){var q=I.hooks.didParseCell;I.callCellHooks(S,q,_,M,A,null);var H=_.padding("horizontal");_.contentWidth=(0,g.getStringWidth)(_.text,_.styles,S)+H;var le=(0,g.getStringWidth)(_.text.join(" ").split(/[^\S\u00A0]+/),_.styles,S);if(_.minReadableWidth=le+_.padding("horizontal"),typeof _.styles.cellWidth=="number")_.minWidth=_.styles.cellWidth,_.wrappedWidth=_.styles.cellWidth;else if(_.styles.cellWidth==="wrap"||K===!0)_.contentWidth>O?(_.minWidth=O,_.wrappedWidth=O):(_.minWidth=_.contentWidth,_.wrappedWidth=_.contentWidth);else{var Y=10/R;_.minWidth=_.styles.minCellWidth||Y,_.wrappedWidth=_.contentWidth,_.minWidth>_.wrappedWidth&&(_.wrappedWidth=_.minWidth)}}}}),I.allRows().forEach(function(M){for(var G=0,J=I.columns;G<J.length;G++){var A=J[G],_=M.cells[A.index];if(_&&_.colSpan===1)A.wrappedWidth=Math.max(A.wrappedWidth,_.wrappedWidth),A.minWidth=Math.max(A.minWidth,_.minWidth),A.minReadableWidth=Math.max(A.minReadableWidth,_.minReadableWidth);else{var q=I.styles.columnStyles[A.dataKey]||I.styles.columnStyles[A.index]||{},H=q.cellWidth||q.minCellWidth;H&&typeof H=="number"&&(A.minWidth=H,A.wrappedWidth=H)}_&&(_.colSpan>1&&!A.minWidth&&(A.minWidth=_.minWidth),_.colSpan>1&&!A.wrappedWidth&&(A.wrappedWidth=_.minWidth))}})}function m(S,I,R){for(var K=I,O=S.reduce(function(Y,V){return Y+V.wrappedWidth},0),M=0;M<S.length;M++){var G=S[M],J=G.wrappedWidth/O,A=K*J,_=G.width+A,q=R(G),H=_<q?q:_;I-=H-G.width,G.width=H}if(I=Math.round(I*1e10)/1e10,I){var le=S.filter(function(Y){return I<0?Y.width>R(Y):!0});le.length&&(I=m(le,I,R))}return I}d.resizeColumns=m;function v(S){for(var I={},R=1,K=S.allRows(),O=0;O<K.length;O++)for(var M=K[O],G=0,J=S.columns;G<J.length;G++){var A=J[G],_=I[A.index];if(R>1)R--,delete M.cells[A.index];else if(_)_.cell.height+=M.height,R=_.cell.colSpan,delete M.cells[A.index],_.left--,_.left<=1&&delete I[A.index];else{var q=M.cells[A.index];if(!q)continue;if(q.height=M.height,q.rowSpan>1){var H=K.length-O,le=q.rowSpan>H?H:q.rowSpan;I[A.index]={cell:q,left:le,row:M}}}}}function N(S){for(var I=S.allRows(),R=0;R<I.length;R++)for(var K=I[R],O=null,M=0,G=0,J=0;J<S.columns.length;J++){var A=S.columns[J];if(G-=1,G>1&&S.columns[J+1])M+=A.width,delete K.cells[A.index];else if(O){var _=O;delete K.cells[A.index],O=null,_.width=A.width+M}else{var _=K.cells[A.index];if(!_)continue;if(G=_.colSpan,M=0,_.colSpan>1){O=_,M+=A.width;continue}_.width=A.width+M}}}function L(S,I){for(var R={count:0,height:0},K=0,O=S.allRows();K<O.length;K++){for(var M=O[K],G=0,J=S.columns;G<J.length;G++){var A=J[G],_=M.cells[A.index];if(_){I.applyStyles(_.styles,!0);var q=_.width-_.padding("horizontal");if(_.styles.overflow==="linebreak")_.text=I.splitTextToSize(_.text,q+1/I.scaleFactor(),{fontSize:_.styles.fontSize});else if(_.styles.overflow==="ellipsize")_.text=w(_.text,q,_.styles,I,"...");else if(_.styles.overflow==="hidden")_.text=w(_.text,q,_.styles,I,"");else if(typeof _.styles.overflow=="function"){var H=_.styles.overflow(_.text,q);typeof H=="string"?_.text=[H]:_.text=H}_.contentHeight=_.getContentHeight(I.scaleFactor(),I.getLineHeightFactor());var le=_.contentHeight/_.rowSpan;_.rowSpan>1&&R.count*R.height<le*_.rowSpan?R={height:le,count:_.rowSpan}:R&&R.count>0&&R.height>le&&(le=R.height),le>M.height&&(M.height=le)}}R.count--}}function w(S,I,R,K,O){return S.map(function(M){return j(M,I,R,K,O)})}d.ellipsize=w;function j(S,I,R,K,O){var M=1e4*K.scaleFactor();if(I=Math.ceil(I*M)/M,I>=(0,g.getStringWidth)(S,R,K))return S;for(;I<(0,g.getStringWidth)(S+O,R,K)&&!(S.length<=1);)S=S.substring(0,S.length-1);return S.trim()+O}},964:function(c){if(typeof r>"u"){var d=new Error("Cannot find module 'undefined'");throw d.code="MODULE_NOT_FOUND",d}c.exports=r}},s={};function i(c){var d=s[c];if(d!==void 0)return d.exports;var h=s[c]={exports:{}};return a[c].call(h.exports,h,h.exports,i),h.exports}var o={};return function(){var c=o;Object.defineProperty(c,"__esModule",{value:!0}),c.Cell=c.Column=c.Row=c.Table=c.CellHookData=c.__drawTable=c.__createTable=c.applyPlugin=void 0;var d=i(340),h=i(776),g=i(664),x=i(972),y=i(260);Object.defineProperty(c,"Table",{enumerable:!0,get:function(){return y.Table}});var m=i(172);Object.defineProperty(c,"CellHookData",{enumerable:!0,get:function(){return m.CellHookData}});var v=i(260);Object.defineProperty(c,"Cell",{enumerable:!0,get:function(){return v.Cell}}),Object.defineProperty(c,"Column",{enumerable:!0,get:function(){return v.Column}}),Object.defineProperty(c,"Row",{enumerable:!0,get:function(){return v.Row}});function N(I){(0,d.default)(I)}c.applyPlugin=N;function L(I,R){var K=(0,h.parseInput)(I,R),O=(0,x.createTable)(I,K);(0,g.drawTable)(I,O)}function w(I,R){var K=(0,h.parseInput)(I,R);return(0,x.createTable)(I,K)}c.__createTable=w;function j(I,R){(0,g.drawTable)(I,R)}c.__drawTable=j;try{var S=i(964);S.jsPDF&&(S=S.jsPDF),N(S)}catch{}c.default=L}(),o}()})})(lm);const ft={header:{marginTop:15,marginLeft:20,marginRight:20,brandNameSize:16,subtitleSize:10},colors:{gray:[128,128,128],separator:[229,231,235]},table:{headStyles:{fillColor:[63,81,181],textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8,cellPadding:2},alternateRowStyles:{fillColor:[245,245,245]},columnWidths:{details:.5,status:.15,dueDate:.15,progress:.15}}};function dm(e){try{return e.setFontSize(ft.header.brandNameSize),e.setFont("helvetica","bold"),e.text("Leumasware®",ft.header.marginLeft,ft.header.marginTop),e.setFontSize(ft.header.subtitleSize),e.setFont("helvetica","normal"),e.setTextColor(...ft.colors.gray),e.text("ISO 9001:2015 Company",ft.header.marginLeft,ft.header.marginTop+8),e.setTextColor(0,0,0),e.setDrawColor(...ft.colors.separator),e.line(ft.header.marginLeft,ft.header.marginTop+12,e.internal.pageSize.width-ft.header.marginLeft,ft.header.marginTop+12),{startY:ft.header.marginTop+25}}catch(t){return console.error("Header generation error:",t),{startY:ft.header.marginTop+10}}}function um(e,t,r){var s;e.setFontSize(11);const a=[`PO Number: ${t.po_number}`,`Product: ${((s=t.product)==null?void 0:s.name)||"N/A"}`,`Order Type: ${t.order_type}`,`Quantity: ${t.quantity}`,`Priority: ${t.is_priority?"Yes":"No"}`,t.organization?`Brand: ${t.organization.name}`:null].filter(Boolean);return a.forEach((i,o)=>{i&&e.text(i,ft.header.marginLeft,r+o*6)}),r+a.length*6}function wu(e){return`${Math.round(e)}%`}function hm(e,t,r){const a=Ao(t),s=150,i=10,o=ft.header.marginLeft;return e.setFontSize(11),e.text(`Overall Progress: ${wu(a)}`,o,r),e.setFillColor(245,245,245),e.rect(o,r+5,s,i,"F"),e.setFillColor(39,174,96),e.rect(o,r+5,s*a/100,i,"F"),r+i+15}function sn(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ka(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const Nu=6048e5,fm=864e5;let mm={};function Io(){return mm}function di(e,t){var c,d,h,g;const r=Io(),a=(t==null?void 0:t.weekStartsOn)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.weekStartsOn)??0,s=sn(e),i=s.getDay(),o=(i<a?7:0)+i-a;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function xo(e){return di(e,{weekStartsOn:1})}function ju(e){const t=sn(e),r=t.getFullYear(),a=ka(e,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const s=xo(a),i=ka(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=xo(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function Ld(e){const t=sn(e);return t.setHours(0,0,0,0),t}function Ad(e){const t=sn(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function gm(e,t){const r=Ld(e),a=Ld(t),s=+r-Ad(r),i=+a-Ad(a);return Math.round((s-i)/fm)}function pm(e){const t=ju(e),r=ka(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),xo(r)}function xm(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ym(e){if(!xm(e)&&typeof e!="number")return!1;const t=sn(e);return!isNaN(Number(t))}function vm(e){const t=sn(e),r=ka(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const bm={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},wm=(e,t,r)=>{let a;const s=bm[e];return typeof s=="string"?a=s:t===1?a=s.one:a=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function ql(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Nm={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},jm={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Sm={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_m={date:ql({formats:Nm,defaultWidth:"full"}),time:ql({formats:jm,defaultWidth:"full"}),dateTime:ql({formats:Sm,defaultWidth:"full"})},km={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Lm=(e,t,r,a)=>km[e];function Zs(e){return(t,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let s;if(a==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=r!=null&&r.width?String(r.width):o;s=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[c]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const Am={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Pm={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Cm={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Em={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Fm={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Im={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Mm=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Tm={ordinalNumber:Mm,era:Zs({values:Am,defaultWidth:"wide"}),quarter:Zs({values:Pm,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Zs({values:Cm,defaultWidth:"wide"}),day:Zs({values:Em,defaultWidth:"wide"}),dayPeriod:Zs({values:Fm,defaultWidth:"wide",formattingValues:Im,defaultFormattingWidth:"wide"})};function ei(e){return(t,r={})=>{const a=r.width,s=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],c=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(c)?Dm(c,x=>x.test(o)):Om(c,x=>x.test(o));let h;h=e.valueCallback?e.valueCallback(d):d,h=r.valueCallback?r.valueCallback(h):h;const g=t.slice(o.length);return{value:h,rest:g}}}function Om(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Dm(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Bm(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const s=a[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=t.slice(s.length);return{value:o,rest:c}}}const Rm=/^(\d+)(th|st|nd|rd)?/i,qm=/\d+/i,zm={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Um={any:[/^b/i,/^(a|c)/i]},Hm={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Wm={any:[/1/i,/2/i,/3/i,/4/i]},Vm={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Gm={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ym={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$m={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Jm={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Km={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Xm={ordinalNumber:Bm({matchPattern:Rm,parsePattern:qm,valueCallback:e=>parseInt(e,10)}),era:ei({matchPatterns:zm,defaultMatchWidth:"wide",parsePatterns:Um,defaultParseWidth:"any"}),quarter:ei({matchPatterns:Hm,defaultMatchWidth:"wide",parsePatterns:Wm,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ei({matchPatterns:Vm,defaultMatchWidth:"wide",parsePatterns:Gm,defaultParseWidth:"any"}),day:ei({matchPatterns:Ym,defaultMatchWidth:"wide",parsePatterns:$m,defaultParseWidth:"any"}),dayPeriod:ei({matchPatterns:Jm,defaultMatchWidth:"any",parsePatterns:Km,defaultParseWidth:"any"})},Qm={code:"en-US",formatDistance:wm,formatLong:_m,formatRelative:Lm,localize:Tm,match:Xm,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Zm(e){const t=sn(e);return gm(t,vm(t))+1}function e1(e){const t=sn(e),r=+xo(t)-+pm(t);return Math.round(r/Nu)+1}function Su(e,t){var g,x,y,m;const r=sn(e),a=r.getFullYear(),s=Io(),i=(t==null?void 0:t.firstWeekContainsDate)??((x=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(y=s.locale)==null?void 0:y.options)==null?void 0:m.firstWeekContainsDate)??1,o=ka(e,0);o.setFullYear(a+1,0,i),o.setHours(0,0,0,0);const c=di(o,t),d=ka(e,0);d.setFullYear(a,0,i),d.setHours(0,0,0,0);const h=di(d,t);return r.getTime()>=c.getTime()?a+1:r.getTime()>=h.getTime()?a:a-1}function t1(e,t){var c,d,h,g;const r=Io(),a=(t==null?void 0:t.firstWeekContainsDate)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,s=Su(e,t),i=ka(e,0);return i.setFullYear(s,0,a),i.setHours(0,0,0,0),di(i,t)}function r1(e,t){const r=sn(e),a=+di(r,t)-+t1(r,t);return Math.round(a/Nu)+1}function yt(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const Kn={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return yt(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):yt(r+1,2)},d(e,t){return yt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return yt(e.getHours()%12||12,t.length)},H(e,t){return yt(e.getHours(),t.length)},m(e,t){return yt(e.getMinutes(),t.length)},s(e,t){return yt(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),s=Math.trunc(a*Math.pow(10,r-3));return yt(s,t.length)}},ls={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Pd={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),s=a>0?a:1-a;return r.ordinalNumber(s,{unit:"year"})}return Kn.y(e,t)},Y:function(e,t,r,a){const s=Su(e,a),i=s>0?s:1-s;if(t==="YY"){const o=i%100;return yt(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):yt(i,t.length)},R:function(e,t){const r=ju(e);return yt(r,t.length)},u:function(e,t){const r=e.getFullYear();return yt(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return yt(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return yt(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return Kn.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return yt(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const s=r1(e,a);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):yt(s,t.length)},I:function(e,t,r){const a=e1(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):yt(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Kn.d(e,t)},D:function(e,t,r){const a=Zm(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):yt(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const s=e.getDay(),i=(s-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return yt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const s=e.getDay(),i=(s-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return yt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),s=a===0?7:a;switch(t){case"i":return String(s);case"ii":return yt(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let s;switch(a===12?s=ls.noon:a===0?s=ls.midnight:s=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let s;switch(a>=17?s=ls.evening:a>=12?s=ls.afternoon:a>=4?s=ls.morning:s=ls.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Kn.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Kn.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):yt(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):yt(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Kn.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Kn.s(e,t)},S:function(e,t){return Kn.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return Ed(a);case"XXXX":case"XX":return ba(a);case"XXXXX":case"XXX":default:return ba(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return Ed(a);case"xxxx":case"xx":return ba(a);case"xxxxx":case"xxx":default:return ba(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Cd(a,":");case"OOOO":default:return"GMT"+ba(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Cd(a,":");case"zzzz":default:return"GMT"+ba(a,":")}},t:function(e,t,r){const a=Math.trunc(e.getTime()/1e3);return yt(a,t.length)},T:function(e,t,r){const a=e.getTime();return yt(a,t.length)}};function Cd(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),s=Math.trunc(a/60),i=a%60;return i===0?r+String(s):r+String(s)+t+yt(i,2)}function Ed(e,t){return e%60===0?(e>0?"-":"+")+yt(Math.abs(e)/60,2):ba(e,t)}function ba(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),s=yt(Math.trunc(a/60),2),i=yt(a%60,2);return r+s+t+i}const Fd=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},_u=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},n1=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],s=r[2];if(!s)return Fd(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Fd(a,t)).replace("{{time}}",_u(s,t))},a1={p:_u,P:n1},s1=/^D+$/,i1=/^Y+$/,o1=["D","DD","YY","YYYY"];function l1(e){return s1.test(e)}function c1(e){return i1.test(e)}function d1(e,t,r){const a=u1(e,t,r);if(console.warn(a),o1.includes(e))throw new RangeError(a)}function u1(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const h1=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,f1=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,m1=/^'([^]*?)'?$/,g1=/''/g,p1=/[a-zA-Z]/;function x1(e,t,r){var g,x,y,m;const a=Io(),s=a.locale??Qm,i=a.firstWeekContainsDate??((x=(g=a.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)??1,o=a.weekStartsOn??((m=(y=a.locale)==null?void 0:y.options)==null?void 0:m.weekStartsOn)??0,c=sn(e);if(!ym(c))throw new RangeError("Invalid time value");let d=t.match(f1).map(v=>{const N=v[0];if(N==="p"||N==="P"){const L=a1[N];return L(v,s.formatLong)}return v}).join("").match(h1).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const N=v[0];if(N==="'")return{isToken:!1,value:y1(v)};if(Pd[N])return{isToken:!0,value:v};if(N.match(p1))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(d=s.localize.preprocessor(c,d));const h={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return d.map(v=>{if(!v.isToken)return v.value;const N=v.value;(c1(N)||l1(N))&&d1(N,t,String(e));const L=Pd[N[0]];return L(c,N,s.localize,h)}).join("")}function y1(e){const t=e.match(m1);return t?t[1].replace(g1,"'"):e}function v1(e){if(!e)return"Not set";try{return x1(new Date(e),"MMM d, yyyy")}catch(t){return console.error("Error formatting date:",t),"Invalid date"}}function b1(e,t,r,a){try{const s=e.internal.pageSize.width,i=ft.header.marginLeft+ft.header.marginRight,o=s-i,c={details:Math.floor(o*.55),status:Math.floor(o*.15),dueDate:Math.floor(o*.15),progress:Math.floor(o*.15)};e.autoTable({startY:r,head:[["Task Details","Status","Due Date","Progress"]],body:t.map(d=>[d.details,d.status.replace(/_/g," "),v1(d.due_date),wu(Ao([d]))]),headStyles:ft.table.headStyles,bodyStyles:ft.table.bodyStyles,alternateRowStyles:ft.table.alternateRowStyles,margin:{left:ft.header.marginLeft},columnStyles:{0:{cellWidth:c.details},1:{cellWidth:c.status},2:{cellWidth:c.dueDate},3:{cellWidth:c.progress}},didDrawPage:d=>{e.setFontSize(8),e.setTextColor(128),e.text(`${a.po_number} - Page ${d.pageNumber}`,ft.header.marginLeft,e.internal.pageSize.height-10)}})}catch(s){throw console.error("Error adding tasks table:",s),new Error("Failed to add tasks table to PDF")}}function w1(e){var t;if(!e)throw new Error("Order is required for PDF export");try{const r=new Ue({orientation:"portrait",unit:"mm",format:"a4"}),{startY:a}=dm(r);r.setFontSize(14),r.text("Production Order Details",ft.header.marginLeft,a);let i=um(r,e,a+10)+10;(t=e.tasks)!=null&&t.length&&(i=hm(r,e.tasks,i),b1(r,e.tasks,i+5,e)),r.save(`${e.po_number}_details.pdf`)}catch(r){throw console.error("Error generating PDF:",r),new Error("Failed to generate PDF. Please try again.")}}function N1({order:e}){const[t,r]=W.useState(!1),a=async()=>{if(!t){r(!0);try{w1(e)}catch(s){console.error("Error exporting order:",s)}finally{r(!1)}}};return n.jsx("button",{onClick:a,disabled:t,className:`
        p-2 rounded-full transition-colors
        ${t?"bg-gray-100 cursor-wait":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}
      `,title:"Export to PDF",children:n.jsx(If,{className:`h-5 w-5 ${t?"animate-pulse":""}`})})}function j1(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null),c=async()=>{try{s(!0),o(null);const{data:h,error:g}=await je.from("batch_records").select("*").eq("production_order_id",e).maybeSingle();if(g)throw g;r(h)}catch(h){o(h instanceof Error?h:new Error("Error loading batch record"))}finally{s(!1)}};return W.useEffect(()=>{c()},[e]),{data:t,isLoading:a,error:i,updateBatchRecord:async h=>{try{if(s(!0),o(null),t){const{error:g}=await je.from("batch_records").update({details:h}).eq("id",t.id);if(g)throw g}else{const{error:g}=await je.from("batch_records").insert({production_order_id:e,details:h});if(g)throw g}await c()}catch(g){const x=g instanceof Error?g:new Error("Failed to update batch record");throw o(x),x}finally{s(!1)}}}}function vs({onClick:e,isLoading:t}){return n.jsx("button",{onClick:e,disabled:t,className:"px-3 py-1 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700 disabled:opacity-50",children:t?"Saving...":"Save Changes"})}var gi={},S1=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},ku={},Mr={};let vc;const _1=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Mr.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};Mr.getSymbolTotalCodewords=function(t){return _1[t]};Mr.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};Mr.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');vc=t};Mr.isKanjiModeEnabled=function(){return typeof vc<"u"};Mr.toSJIS=function(t){return vc(t)};var Mo={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,s){if(e.isValid(a))return a;try{return t(a)}catch{return s}}})(Mo);function Lu(){this.buffer=[],this.length=0}Lu.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var k1=Lu;function pi(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}pi.prototype.set=function(e,t,r,a){const s=e*this.size+t;this.data[s]=r,a&&(this.reservedBit[s]=!0)};pi.prototype.get=function(e,t){return this.data[e*this.size+t]};pi.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};pi.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var L1=pi,Au={};(function(e){const t=Mr.getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const s=Math.floor(a/7)+2,i=t(a),o=i===145?26:Math.ceil((i-13)/(2*s-2))*2,c=[i-7];for(let d=1;d<s-1;d++)c[d]=c[d-1]-o;return c.push(6),c.reverse()},e.getPositions=function(a){const s=[],i=e.getRowColCoords(a),o=i.length;for(let c=0;c<o;c++)for(let d=0;d<o;d++)c===0&&d===0||c===0&&d===o-1||c===o-1&&d===0||s.push([i[c],i[d]]);return s}})(Au);var Pu={};const A1=Mr.getSymbolSize,Id=7;Pu.getPositions=function(t){const r=A1(t);return[[0,0],[r-Id,0],[0,r-Id]]};var Cu={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},e.from=function(s){return e.isValid(s)?parseInt(s,10):void 0},e.getPenaltyN1=function(s){const i=s.size;let o=0,c=0,d=0,h=null,g=null;for(let x=0;x<i;x++){c=d=0,h=g=null;for(let y=0;y<i;y++){let m=s.get(x,y);m===h?c++:(c>=5&&(o+=t.N1+(c-5)),h=m,c=1),m=s.get(y,x),m===g?d++:(d>=5&&(o+=t.N1+(d-5)),g=m,d=1)}c>=5&&(o+=t.N1+(c-5)),d>=5&&(o+=t.N1+(d-5))}return o},e.getPenaltyN2=function(s){const i=s.size;let o=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=s.get(c,d)+s.get(c,d+1)+s.get(c+1,d)+s.get(c+1,d+1);(h===4||h===0)&&o++}return o*t.N2},e.getPenaltyN3=function(s){const i=s.size;let o=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let g=0;g<i;g++)c=c<<1&2047|s.get(h,g),g>=10&&(c===1488||c===93)&&o++,d=d<<1&2047|s.get(g,h),g>=10&&(d===1488||d===93)&&o++}return o*t.N3},e.getPenaltyN4=function(s){let i=0;const o=s.data.length;for(let d=0;d<o;d++)i+=s.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function r(a,s,i){switch(a){case e.Patterns.PATTERN000:return(s+i)%2===0;case e.Patterns.PATTERN001:return s%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(s+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return s*i%2+s*i%3===0;case e.Patterns.PATTERN110:return(s*i%2+s*i%3)%2===0;case e.Patterns.PATTERN111:return(s*i%3+(s+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(s,i){const o=i.size;for(let c=0;c<o;c++)for(let d=0;d<o;d++)i.isReserved(d,c)||i.xor(d,c,r(s,d,c))},e.getBestMask=function(s,i){const o=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<o;h++){i(h),e.applyMask(h,s);const g=e.getPenaltyN1(s)+e.getPenaltyN2(s)+e.getPenaltyN3(s)+e.getPenaltyN4(s);e.applyMask(h,s),g<d&&(d=g,c=h)}return c}})(Cu);var To={};const Zn=Mo,ho=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],fo=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];To.getBlocksCount=function(t,r){switch(r){case Zn.L:return ho[(t-1)*4+0];case Zn.M:return ho[(t-1)*4+1];case Zn.Q:return ho[(t-1)*4+2];case Zn.H:return ho[(t-1)*4+3];default:return}};To.getTotalCodewordsCount=function(t,r){switch(r){case Zn.L:return fo[(t-1)*4+0];case Zn.M:return fo[(t-1)*4+1];case Zn.Q:return fo[(t-1)*4+2];case Zn.H:return fo[(t-1)*4+3];default:return}};var Eu={},Oo={};const ii=new Uint8Array(512),yo=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)ii[r]=t,yo[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)ii[r]=ii[r-255]})();Oo.log=function(t){if(t<1)throw new Error("log("+t+")");return yo[t]};Oo.exp=function(t){return ii[t]};Oo.mul=function(t,r){return t===0||r===0?0:ii[yo[t]+yo[r]]};(function(e){const t=Oo;e.mul=function(a,s){const i=new Uint8Array(a.length+s.length-1);for(let o=0;o<a.length;o++)for(let c=0;c<s.length;c++)i[o+c]^=t.mul(a[o],s[c]);return i},e.mod=function(a,s){let i=new Uint8Array(a);for(;i.length-s.length>=0;){const o=i[0];for(let d=0;d<s.length;d++)i[d]^=t.mul(s[d],o);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(a){let s=new Uint8Array([1]);for(let i=0;i<a;i++)s=e.mul(s,new Uint8Array([1,t.exp(i)]));return s}})(Eu);const Fu=Eu;function bc(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}bc.prototype.initialize=function(t){this.degree=t,this.genPoly=Fu.generateECPolynomial(this.degree)};bc.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const a=Fu.mod(r,this.genPoly),s=this.degree-a.length;if(s>0){const i=new Uint8Array(this.degree);return i.set(a,s),i}return a};var P1=bc,Iu={},sa={},wc={};wc.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var wn={};const Mu="[0-9]+",C1="[A-Z $%*+\\-./:]+";let ui="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ui=ui.replace(/u/g,"\\u");const E1="(?:(?![A-Z0-9 $%*+\\-./:]|"+ui+`)(?:.|[\r
]))+`;wn.KANJI=new RegExp(ui,"g");wn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");wn.BYTE=new RegExp(E1,"g");wn.NUMERIC=new RegExp(Mu,"g");wn.ALPHANUMERIC=new RegExp(C1,"g");const F1=new RegExp("^"+ui+"$"),I1=new RegExp("^"+Mu+"$"),M1=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");wn.testKanji=function(t){return F1.test(t)};wn.testNumeric=function(t){return I1.test(t)};wn.testAlphanumeric=function(t){return M1.test(t)};(function(e){const t=wc,r=wn;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return r.testNumeric(i)?e.NUMERIC:r.testAlphanumeric(i)?e.ALPHANUMERIC:r.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function a(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+s)}}e.from=function(i,o){if(e.isValid(i))return i;try{return a(i)}catch{return o}}})(sa);(function(e){const t=Mr,r=To,a=Mo,s=sa,i=wc,o=7973,c=t.getBCHDigit(o);function d(y,m,v){for(let N=1;N<=40;N++)if(m<=e.getCapacity(N,v,y))return N}function h(y,m){return s.getCharCountIndicator(y,m)+4}function g(y,m){let v=0;return y.forEach(function(N){const L=h(N.mode,m);v+=L+N.getBitsLength()}),v}function x(y,m){for(let v=1;v<=40;v++)if(g(y,v)<=e.getCapacity(v,m,s.MIXED))return v}e.from=function(m,v){return i.isValid(m)?parseInt(m,10):v},e.getCapacity=function(m,v,N){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof N>"u"&&(N=s.BYTE);const L=t.getSymbolTotalCodewords(m),w=r.getTotalCodewordsCount(m,v),j=(L-w)*8;if(N===s.MIXED)return j;const S=j-h(N,m);switch(N){case s.NUMERIC:return Math.floor(S/10*3);case s.ALPHANUMERIC:return Math.floor(S/11*2);case s.KANJI:return Math.floor(S/13);case s.BYTE:default:return Math.floor(S/8)}},e.getBestVersionForData=function(m,v){let N;const L=a.from(v,a.M);if(Array.isArray(m)){if(m.length>1)return x(m,L);if(m.length===0)return 1;N=m[0]}else N=m;return d(N.mode,N.getLength(),L)},e.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let v=m<<12;for(;t.getBCHDigit(v)-c>=0;)v^=o<<t.getBCHDigit(v)-c;return m<<12|v}})(Iu);var Tu={};const lc=Mr,Ou=1335,T1=21522,Md=lc.getBCHDigit(Ou);Tu.getEncodedBits=function(t,r){const a=t.bit<<3|r;let s=a<<10;for(;lc.getBCHDigit(s)-Md>=0;)s^=Ou<<lc.getBCHDigit(s)-Md;return(a<<10|s)^T1};var Du={};const O1=sa;function fs(e){this.mode=O1.NUMERIC,this.data=e.toString()}fs.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};fs.prototype.getLength=function(){return this.data.length};fs.prototype.getBitsLength=function(){return fs.getBitsLength(this.data.length)};fs.prototype.write=function(t){let r,a,s;for(r=0;r+3<=this.data.length;r+=3)a=this.data.substr(r,3),s=parseInt(a,10),t.put(s,10);const i=this.data.length-r;i>0&&(a=this.data.substr(r),s=parseInt(a,10),t.put(s,i*3+1))};var D1=fs;const B1=sa,zl=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ms(e){this.mode=B1.ALPHANUMERIC,this.data=e}ms.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};ms.prototype.getLength=function(){return this.data.length};ms.prototype.getBitsLength=function(){return ms.getBitsLength(this.data.length)};ms.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let a=zl.indexOf(this.data[r])*45;a+=zl.indexOf(this.data[r+1]),t.put(a,11)}this.data.length%2&&t.put(zl.indexOf(this.data[r]),6)};var R1=ms;const q1=sa;function gs(e){this.mode=q1.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}gs.getBitsLength=function(t){return t*8};gs.prototype.getLength=function(){return this.data.length};gs.prototype.getBitsLength=function(){return gs.getBitsLength(this.data.length)};gs.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var z1=gs;const U1=sa,H1=Mr;function ps(e){this.mode=U1.KANJI,this.data=e}ps.getBitsLength=function(t){return t*13};ps.prototype.getLength=function(){return this.data.length};ps.prototype.getBitsLength=function(){return ps.getBitsLength(this.data.length)};ps.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=H1.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var W1=ps,Bu={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,a,s){var i={},o={};o[a]=0;var c=t.PriorityQueue.make();c.push(a,0);for(var d,h,g,x,y,m,v,N,L;!c.empty();){d=c.pop(),h=d.value,x=d.cost,y=r[h]||{};for(g in y)y.hasOwnProperty(g)&&(m=y[g],v=x+m,N=o[g],L=typeof o[g]>"u",(L||N>v)&&(o[g]=v,c.push(g,v),i[g]=h))}if(typeof s<"u"&&typeof o[s]>"u"){var w=["Could not find a path from ",a," to ",s,"."].join("");throw new Error(w)}return i},extract_shortest_path_from_predecessor_list:function(r,a){for(var s=[],i=a;i;)s.push(i),r[i],i=r[i];return s.reverse(),s},find_path:function(r,a,s){var i=t.single_source_shortest_paths(r,a,s);return t.extract_shortest_path_from_predecessor_list(i,s)},PriorityQueue:{make:function(r){var a=t.PriorityQueue,s={},i;r=r||{};for(i in a)a.hasOwnProperty(i)&&(s[i]=a[i]);return s.queue=[],s.sorter=r.sorter||a.default_sorter,s},default_sorter:function(r,a){return r.cost-a.cost},push:function(r,a){var s={value:r,cost:a};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Bu);var V1=Bu.exports;(function(e){const t=sa,r=D1,a=R1,s=z1,i=W1,o=wn,c=Mr,d=V1;function h(w){return unescape(encodeURIComponent(w)).length}function g(w,j,S){const I=[];let R;for(;(R=w.exec(S))!==null;)I.push({data:R[0],index:R.index,mode:j,length:R[0].length});return I}function x(w){const j=g(o.NUMERIC,t.NUMERIC,w),S=g(o.ALPHANUMERIC,t.ALPHANUMERIC,w);let I,R;return c.isKanjiModeEnabled()?(I=g(o.BYTE,t.BYTE,w),R=g(o.KANJI,t.KANJI,w)):(I=g(o.BYTE_KANJI,t.BYTE,w),R=[]),j.concat(S,I,R).sort(function(O,M){return O.index-M.index}).map(function(O){return{data:O.data,mode:O.mode,length:O.length}})}function y(w,j){switch(j){case t.NUMERIC:return r.getBitsLength(w);case t.ALPHANUMERIC:return a.getBitsLength(w);case t.KANJI:return i.getBitsLength(w);case t.BYTE:return s.getBitsLength(w)}}function m(w){return w.reduce(function(j,S){const I=j.length-1>=0?j[j.length-1]:null;return I&&I.mode===S.mode?(j[j.length-1].data+=S.data,j):(j.push(S),j)},[])}function v(w){const j=[];for(let S=0;S<w.length;S++){const I=w[S];switch(I.mode){case t.NUMERIC:j.push([I,{data:I.data,mode:t.ALPHANUMERIC,length:I.length},{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.ALPHANUMERIC:j.push([I,{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.KANJI:j.push([I,{data:I.data,mode:t.BYTE,length:h(I.data)}]);break;case t.BYTE:j.push([{data:I.data,mode:t.BYTE,length:h(I.data)}])}}return j}function N(w,j){const S={},I={start:{}};let R=["start"];for(let K=0;K<w.length;K++){const O=w[K],M=[];for(let G=0;G<O.length;G++){const J=O[G],A=""+K+G;M.push(A),S[A]={node:J,lastCount:0},I[A]={};for(let _=0;_<R.length;_++){const q=R[_];S[q]&&S[q].node.mode===J.mode?(I[q][A]=y(S[q].lastCount+J.length,J.mode)-y(S[q].lastCount,J.mode),S[q].lastCount+=J.length):(S[q]&&(S[q].lastCount=J.length),I[q][A]=y(J.length,J.mode)+4+t.getCharCountIndicator(J.mode,j))}}R=M}for(let K=0;K<R.length;K++)I[R[K]].end=0;return{map:I,table:S}}function L(w,j){let S;const I=t.getBestModeForData(w);if(S=t.from(j,I),S!==t.BYTE&&S.bit<I.bit)throw new Error('"'+w+'" cannot be encoded with mode '+t.toString(S)+`.
 Suggested mode is: `+t.toString(I));switch(S===t.KANJI&&!c.isKanjiModeEnabled()&&(S=t.BYTE),S){case t.NUMERIC:return new r(w);case t.ALPHANUMERIC:return new a(w);case t.KANJI:return new i(w);case t.BYTE:return new s(w)}}e.fromArray=function(j){return j.reduce(function(S,I){return typeof I=="string"?S.push(L(I,null)):I.data&&S.push(L(I.data,I.mode)),S},[])},e.fromString=function(j,S){const I=x(j,c.isKanjiModeEnabled()),R=v(I),K=N(R,S),O=d.find_path(K.map,"start","end"),M=[];for(let G=1;G<O.length-1;G++)M.push(K.table[O[G]].node);return e.fromArray(m(M))},e.rawSplit=function(j){return e.fromArray(x(j,c.isKanjiModeEnabled()))}})(Du);const Do=Mr,Ul=Mo,G1=k1,Y1=L1,$1=Au,J1=Pu,cc=Cu,dc=To,K1=P1,vo=Iu,X1=Tu,Q1=sa,Hl=Du;function Z1(e,t){const r=e.size,a=J1.getPositions(t);for(let s=0;s<a.length;s++){const i=a[s][0],o=a[s][1];for(let c=-1;c<=7;c++)if(!(i+c<=-1||r<=i+c))for(let d=-1;d<=7;d++)o+d<=-1||r<=o+d||(c>=0&&c<=6&&(d===0||d===6)||d>=0&&d<=6&&(c===0||c===6)||c>=2&&c<=4&&d>=2&&d<=4?e.set(i+c,o+d,!0,!0):e.set(i+c,o+d,!1,!0))}}function eg(e){const t=e.size;for(let r=8;r<t-8;r++){const a=r%2===0;e.set(r,6,a,!0),e.set(6,r,a,!0)}}function tg(e,t){const r=$1.getPositions(t);for(let a=0;a<r.length;a++){const s=r[a][0],i=r[a][1];for(let o=-2;o<=2;o++)for(let c=-2;c<=2;c++)o===-2||o===2||c===-2||c===2||o===0&&c===0?e.set(s+o,i+c,!0,!0):e.set(s+o,i+c,!1,!0)}}function rg(e,t){const r=e.size,a=vo.getEncodedBits(t);let s,i,o;for(let c=0;c<18;c++)s=Math.floor(c/3),i=c%3+r-8-3,o=(a>>c&1)===1,e.set(s,i,o,!0),e.set(i,s,o,!0)}function Wl(e,t,r){const a=e.size,s=X1.getEncodedBits(t,r);let i,o;for(i=0;i<15;i++)o=(s>>i&1)===1,i<6?e.set(i,8,o,!0):i<8?e.set(i+1,8,o,!0):e.set(a-15+i,8,o,!0),i<8?e.set(8,a-i-1,o,!0):i<9?e.set(8,15-i-1+1,o,!0):e.set(8,15-i-1,o,!0);e.set(a-8,8,1,!0)}function ng(e,t){const r=e.size;let a=-1,s=r-1,i=7,o=0;for(let c=r-1;c>0;c-=2)for(c===6&&c--;;){for(let d=0;d<2;d++)if(!e.isReserved(s,c-d)){let h=!1;o<t.length&&(h=(t[o]>>>i&1)===1),e.set(s,c-d,h),i--,i===-1&&(o++,i=7)}if(s+=a,s<0||r<=s){s-=a,a=-a;break}}}function ag(e,t,r){const a=new G1;r.forEach(function(d){a.put(d.mode.bit,4),a.put(d.getLength(),Q1.getCharCountIndicator(d.mode,e)),d.write(a)});const s=Do.getSymbolTotalCodewords(e),i=dc.getTotalCodewordsCount(e,t),o=(s-i)*8;for(a.getLengthInBits()+4<=o&&a.put(0,4);a.getLengthInBits()%8!==0;)a.putBit(0);const c=(o-a.getLengthInBits())/8;for(let d=0;d<c;d++)a.put(d%2?17:236,8);return sg(a,e,t)}function sg(e,t,r){const a=Do.getSymbolTotalCodewords(t),s=dc.getTotalCodewordsCount(t,r),i=a-s,o=dc.getBlocksCount(t,r),c=a%o,d=o-c,h=Math.floor(a/o),g=Math.floor(i/o),x=g+1,y=h-g,m=new K1(y);let v=0;const N=new Array(o),L=new Array(o);let w=0;const j=new Uint8Array(e.buffer);for(let O=0;O<o;O++){const M=O<d?g:x;N[O]=j.slice(v,v+M),L[O]=m.encode(N[O]),v+=M,w=Math.max(w,M)}const S=new Uint8Array(a);let I=0,R,K;for(R=0;R<w;R++)for(K=0;K<o;K++)R<N[K].length&&(S[I++]=N[K][R]);for(R=0;R<y;R++)for(K=0;K<o;K++)S[I++]=L[K][R];return S}function ig(e,t,r,a){let s;if(Array.isArray(e))s=Hl.fromArray(e);else if(typeof e=="string"){let h=t;if(!h){const g=Hl.rawSplit(e);h=vo.getBestVersionForData(g,r)}s=Hl.fromString(e,h||40)}else throw new Error("Invalid data");const i=vo.getBestVersionForData(s,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=ag(t,r,s),c=Do.getSymbolSize(t),d=new Y1(c);return Z1(d,t),eg(d),tg(d,t),Wl(d,r,0),t>=7&&rg(d,t),ng(d,o),isNaN(a)&&(a=cc.getBestMask(d,Wl.bind(null,d,r))),cc.applyMask(a,d),Wl(d,r,a),{modules:d,version:t,errorCorrectionLevel:r,maskPattern:a,segments:s}}ku.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let a=Ul.M,s,i;return typeof r<"u"&&(a=Ul.from(r.errorCorrectionLevel,Ul.M),s=vo.from(r.version),i=cc.from(r.maskPattern),r.toSJISFunc&&Do.setToSJISFunction(r.toSJISFunc)),ig(t,s,a,i)};var Ru={},Nc={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let a=r.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+r);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const s=parseInt(a.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const s=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,o=a.scale||4;return{width:i,scale:i?4:o,margin:s,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,s){return s.width&&s.width>=a+s.margin*2?s.width/(a+s.margin*2):s.scale},e.getImageWidth=function(a,s){const i=e.getScale(a,s);return Math.floor((a+s.margin*2)*i)},e.qrToImageData=function(a,s,i){const o=s.modules.size,c=s.modules.data,d=e.getScale(o,i),h=Math.floor((o+i.margin*2)*d),g=i.margin*d,x=[i.color.light,i.color.dark];for(let y=0;y<h;y++)for(let m=0;m<h;m++){let v=(y*h+m)*4,N=i.color.light;if(y>=g&&m>=g&&y<h-g&&m<h-g){const L=Math.floor((y-g)/d),w=Math.floor((m-g)/d);N=x[c[L*o+w]?1:0]}a[v++]=N.r,a[v++]=N.g,a[v++]=N.b,a[v]=N.a}}})(Nc);(function(e){const t=Nc;function r(s,i,o){s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,o,c){let d=c,h=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(h=a()),d=t.getOptions(d);const g=t.getImageWidth(i.modules.size,d),x=h.getContext("2d"),y=x.createImageData(g,g);return t.qrToImageData(y.data,i,d),r(x,h,g),x.putImageData(y,0,0),h},e.renderToDataURL=function(i,o,c){let d=c;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const h=e.render(i,o,d),g=d.type||"image/png",x=d.rendererOpts||{};return h.toDataURL(g,x.quality)}})(Ru);var qu={};const og=Nc;function Td(e,t){const r=e.a/255,a=t+'="'+e.hex+'"';return r<1?a+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':a}function Vl(e,t,r){let a=e+t;return typeof r<"u"&&(a+=" "+r),a}function lg(e,t,r){let a="",s=0,i=!1,o=0;for(let c=0;c<e.length;c++){const d=Math.floor(c%t),h=Math.floor(c/t);!d&&!i&&(i=!0),e[c]?(o++,c>0&&d>0&&e[c-1]||(a+=i?Vl("M",d+r,.5+h+r):Vl("m",s,0),s=0,i=!1),d+1<t&&e[c+1]||(a+=Vl("h",o),o=0)):s++}return a}qu.render=function(t,r,a){const s=og.getOptions(r),i=t.modules.size,o=t.modules.data,c=i+s.margin*2,d=s.color.light.a?"<path "+Td(s.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",h="<path "+Td(s.color.dark,"stroke")+' d="'+lg(o,i,s.margin)+'"/>',g='viewBox="0 0 '+c+" "+c+'"',y='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+g+' shape-rendering="crispEdges">'+d+h+`</svg>
`;return typeof a=="function"&&a(null,y),y};const cg=S1,uc=ku,zu=Ru,dg=qu;function jc(e,t,r,a,s){const i=[].slice.call(arguments,1),o=i.length,c=typeof i[o-1]=="function";if(!c&&!cg())throw new Error("Callback required as last argument");if(c){if(o<2)throw new Error("Too few arguments provided");o===2?(s=r,r=t,t=a=void 0):o===3&&(t.getContext&&typeof s>"u"?(s=a,a=void 0):(s=a,a=r,r=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=t,t=a=void 0):o===2&&!t.getContext&&(a=r,r=t,t=void 0),new Promise(function(d,h){try{const g=uc.create(r,a);d(e(g,t,a))}catch(g){h(g)}})}try{const d=uc.create(r,a);s(null,e(d,t,a))}catch(d){s(d)}}gi.create=uc.create;gi.toCanvas=jc.bind(null,zu.render);gi.toDataURL=jc.bind(null,zu.renderToDataURL);gi.toString=jc.bind(null,function(e,t,r){return dg.render(e,r)});const cs=[[10,0],[20,20],[16,20],[10,8],[4,20],[0,20]];function ug(e,t,r,a=20){try{if(!e||typeof t!="number"||typeof r!="number")throw new Error("Invalid parameters for side up icon");e.saveGraphicsState();const s=a/20;e.setFillColor(0),e.setDrawColor(0),e.triangle(t+cs[0][0]*s,r+cs[0][1]*s,t+cs[1][0]*s,r+cs[1][1]*s,t+cs[5][0]*s,r+cs[5][1]*s,"F"),e.setFontSize(8),e.setFont("helvetica","bold"),e.text("THIS SIDE UP",t+a/2,r+a+8,{align:"center"}),e.restoreGraphicsState()}catch(s){console.error("Error adding side up icon:",s)}}const Od=5,hs=30,Gl=20,hg=10,Dd=15;async function fg(e){try{return await gi.toDataURL(e,{width:hs*4,margin:0})}catch(t){throw console.error("Error generating QR code:",t),new Error("Failed to generate QR code")}}async function mg(e,t,r,a){var y,m;const s=e.internal.pageSize.width,i=ft.header.marginLeft;e.setFontSize(ft.header.brandNameSize),e.setFont("helvetica","bold"),e.text("Leumasware®",i,a+6),e.setFontSize(ft.header.subtitleSize),e.setFont("helvetica","normal"),e.setTextColor(...ft.colors.gray),e.text("ISO 9001:2015 Company",i,a+12),e.setTextColor(0),ug(e,s-Gl-hs-Dd-10,a+6,Dd),e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Batch Record",i,a+22),e.setFont("helvetica","normal"),e.setFontSize(10),[`PO Number: ${t.po_number}`,`Product: ${((y=t.product)==null?void 0:y.name)||"N/A"}`,`Quantity: ${t.quantity}`].forEach((v,N)=>{e.text(v,i,a+32+N*5)});const c=JSON.stringify({po:t.po_number,product:(m=t.product)==null?void 0:m.name,quantity:t.quantity}),d=await fg(c);e.addImage(d,"PNG",s-Gl-hs,a+6,hs,hs),e.setFontSize(10);const h=s-i-Gl-hs-10,g=r.replace(/<\/?p>/g,"").split(`
`).map(v=>v.trim()).filter(v=>v.length>0);let x=a+50;return g.forEach(v=>{e.splitTextToSize(v,h).forEach(L=>{e.text(L,i,x),x+=5})}),Math.max(x+hg,a+80)}async function gg(e,t){try{const r=new Ue({orientation:"portrait",unit:"mm",format:"a4"});let a=20;for(let s=0;s<Od;s++)s>0&&a>r.internal.pageSize.height-100&&(r.addPage(),a=20),a=await mg(r,e,t,a),s<Od-1&&(r.setDrawColor(...ft.colors.separator),r.line(ft.header.marginLeft,a-5,r.internal.pageSize.width-ft.header.marginLeft,a-5));r.save(`batch_record_${e.po_number}.pdf`)}catch(r){throw console.error("Error generating batch record PDF:",r),new Error("Failed to generate batch record PDF")}}function pg({order:e,isOpen:t,onClose:r}){const{data:a,isLoading:s,error:i,updateBatchRecord:o}=j1(e.id),[c,d]=W.useState((a==null?void 0:a.details)||""),{isAdmin:h,isManager:g}=At(),x=h||g;ta.useEffect(()=>{a!=null&&a.details&&d(a.details)},[a]);const y=async()=>{try{await o(c)}catch(v){console.error("Error saving batch record:",v)}},m=()=>{c&&gg(e,c)};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Batch Record"}),n.jsxs("p",{className:"text-sm text-gray-500",children:["PO: ",e.po_number]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:m,disabled:!c,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50",children:"Export PDF"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Batch Record Details"}),x&&c!==(a==null?void 0:a.details)&&n.jsx(vs,{onClick:y,isLoading:s})]}),n.jsx(Zd,{content:c,onChange:d,disabled:!x||s})]})]})}):null}function xg({tasks:e}){const t=Ao(e);return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${t}%`}})}),n.jsxs("span",{className:"text-sm text-gray-500 min-w-[3rem] text-right",children:[t,"%"]})]})}function bo(...e){return e.flat().filter(Boolean).map(t=>typeof t=="string"?t:typeof t=="object"?Object.entries(t).filter(([r,a])=>!!a).map(([r])=>r).join(" "):"").join(" ").trim()}function yg({isSplit:e,onClick:t,className:r,disabled:a}){return n.jsx("button",{onClick:t,disabled:a||e,className:bo("p-2 rounded-full transition-all duration-300",e&&["bg-indigo-100 text-indigo-600","animate-[pulse_2s_ease-in-out_infinite]","hover:bg-indigo-200"],!e&&!a&&"text-gray-500 hover:text-gray-700 hover:bg-gray-100",a&&"opacity-50 cursor-not-allowed",r),title:a?"Only Leumas staff can split orders":e?"Split Order":"Split this order",children:n.jsx(Tf,{className:bo("h-5 w-5 transition-transform duration-300",e&&"rotate-180")})})}function vg({order:e,isOpen:t,onClose:r,onSuccess:a}){const[s,i]=W.useState([0]),[o,c]=W.useState(""),[d,h]=W.useState(!1),[g,x]=W.useState(null),y=s.reduce((j,S)=>j+S,0),m=y>0&&y<e.quantity,v=()=>{i([...s,0])},N=j=>{i(s.filter((S,I)=>I!==j))},L=(j,S)=>{i(s.map((I,R)=>R===j?S:I))},w=async j=>{if(j.preventDefault(),!!m){h(!0),x(null);try{const{error:S}=await je.rpc("split_production_order",{order_id:e.id,new_quantities:s,split_reason:o});if(S)throw S;a==null||a(),r()}catch(S){console.error("Error splitting order:",S),x(S instanceof Error?S.message:"Failed to split order")}finally{h(!1)}}};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsxs("h2",{className:"text-xl font-semibold",children:["Split Order ",e.po_number]}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),g&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:g}),n.jsxs("form",{onSubmit:w,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Split Quantities"}),n.jsx("button",{type:"button",onClick:v,className:"text-indigo-600 hover:text-indigo-700",children:n.jsx(Qt,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"space-y-2",children:s.map((j,S)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"number",min:"1",max:e.quantity-1,value:j,onChange:I=>L(S,parseInt(I.target.value)||0),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:d}),s.length>1&&n.jsx("button",{type:"button",onClick:()=>N(S),className:"text-red-600 hover:text-red-700",children:n.jsx(ko,{className:"h-5 w-5"})})]},S))}),n.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Original quantity: ",e.quantity,n.jsx("br",{}),"Remaining quantity: ",e.quantity-y]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Split Reason"}),n.jsx("textarea",{value:o,onChange:j=>c(j.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:d})]}),n.jsxs("div",{className:"flex justify-end gap-4",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:!m||d,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:d?"Splitting...":"Split Order"})]})]})]})}):null}function bg(){const{isAdmin:e,isManager:t,isStaff:r}=At();return e||t||r}function wg(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return{deleteOrder:async o=>{if(!s)throw new Error("Insufficient permissions");t(!0);try{const{error:c}=await je.from("production_orders").delete().eq("id",o);if(c)throw c}catch(c){throw console.error("Error deleting order:",c),c}finally{t(!1)}},isLoading:e,canDelete:s}}function Sc({onDelete:e,isLoading:t,confirmMessage:r="Are you sure you want to delete this item?",className:a=""}){const s=()=>{window.confirm(r)&&e()};return n.jsx("button",{onClick:s,disabled:t,className:`text-red-600 hover:text-red-800 disabled:opacity-50 ${a}`,title:"Delete",children:n.jsx(ys,{className:"h-5 w-5"})})}function Ng({orderId:e,onDelete:t}){const{deleteOrder:r,isLoading:a,canDelete:s}=wg();if(!s)return null;const i=async()=>{try{await r(e),t==null||t()}catch(o){console.error("Failed to delete order:",o)}};return n.jsx(Sc,{onDelete:i,isLoading:a,confirmMessage:"Are you sure you want to delete this production order? This action cannot be undone."})}function _c({order:e,onUpdate:t,className:r}){var y,m,v,N;const[a,s]=W.useState(!1),[i,o]=W.useState(!1),[c,d]=W.useState(!1),h=bg();if(!e)return null;const g=((y=e.tasks)==null?void 0:y.length)>0?Math.max(...e.tasks.map(L=>new Date(L.due_date).getTime())):null,x=!!e.parent_order_id;return n.jsxs("div",{className:bo("bg-white rounded-lg shadow-sm p-6 transition-all duration-200",r),children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:e.po_number}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${e.order_type==="Project Plan"?"bg-purple-100 text-purple-800":e.order_type==="NPD Order"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:e.order_type})]}),n.jsxs("div",{className:"mt-1 space-y-1",children:[n.jsx("div",{className:"text-sm text-gray-600",children:(m=e.product)==null?void 0:m.name}),e.organization&&n.jsx("div",{className:"text-sm text-gray-500",children:e.organization.name}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:["Quantity: ",e.quantity]}),n.jsx("span",{children:"•"}),n.jsxs("span",{children:["Due: ",g?_r(new Date(g)):"No tasks"]})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(r0,{orderId:e.id,isPriority:e.is_priority}),!x&&n.jsx(yg,{onClick:()=>d(!0),isSplit:!1,disabled:!h}),n.jsx("button",{onClick:()=>o(!0),className:"p-2 text-gray-500 hover:text-gray-700",title:"Batch Record",children:n.jsx(Yd,{className:"h-5 w-5"})}),n.jsx("button",{onClick:()=>s(!0),className:"p-2 text-gray-500 hover:text-gray-700",children:n.jsx(jf,{className:"h-5 w-5"})}),n.jsx(N1,{order:e}),n.jsx(Ng,{orderId:e.id,onDelete:t})]})]}),((v=e.tasks)==null?void 0:v.length)>0&&n.jsx("div",{className:"mt-4",children:n.jsx(xg,{tasks:e.tasks})}),((N=e.tasks)==null?void 0:N.length)>0&&n.jsx(a0,{tasks:e.tasks}),a&&n.jsx(l0,{order:e,isOpen:a,onClose:()=>s(!1),onUpdate:t}),i&&n.jsx(pg,{order:e,isOpen:i,onClose:()=>o(!1)}),c&&h&&n.jsx(vg,{order:e,isOpen:c,onClose:()=>d(!1),onUpdate:t})]})}function jg({isFirst:e,isLast:t,isParent:r}){return n.jsxs("div",{className:"relative flex items-center",children:[n.jsx("div",{className:`absolute left-1/2 w-0.5 bg-indigo-100 transform -translate-x-1/2 ${e?"h-1/2 bottom-0":t?"h-1/2 top-0":"h-full"}`}),n.jsx("div",{className:`w-3 h-3 rounded-full z-10 transition-colors duration-200
          ${r?"bg-indigo-400 ring-2 ring-indigo-100":"bg-indigo-200 group-hover:bg-indigo-300"}`}),n.jsx("div",{className:"w-4 h-0.5 bg-indigo-100 ml-1"})]})}function Uu({orders:e,onUpdate:t}){if(!e.length)return null;const r=[...e].sort((a,s)=>!a.parent_order_id&&s.parent_order_id?-1:a.parent_order_id&&!s.parent_order_id?1:a.po_number.localeCompare(s.po_number));return n.jsxs("div",{className:"relative pl-6 space-y-2",children:[r[0]&&!r[0].parent_order_id&&n.jsx("div",{className:"absolute -left-2 top-6 px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded",children:"Parent"}),r.map((a,s)=>n.jsxs("div",{className:"flex gap-4 group",children:[n.jsx(jg,{isFirst:s===0,isLast:s===r.length-1,isParent:!a.parent_order_id}),n.jsx("div",{className:"flex-1 transition-transform duration-200 group-hover:translate-x-1",children:n.jsx(_c,{order:a,onUpdate:t,className:a.parent_order_id?"border-l-4 border-indigo-100":""})}),a.split_reason&&n.jsx("div",{className:"absolute left-full ml-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:n.jsx("div",{className:"bg-gray-800 text-white text-sm rounded px-2 py-1 max-w-xs",children:a.split_reason})})]},a.id))]})}function wo({items:e,limit:t=8,renderItem:r,emptyMessage:a="No items found"}){const[s,i]=W.useState(!1);if(!(e!=null&&e.length))return n.jsx("div",{className:"text-center py-4 text-gray-500",children:a});const o=s?e:e.slice(0,t),c=e.length>t;return n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"space-y-4",children:o.map(r)}),c&&n.jsxs("button",{onClick:()=>i(!s),className:"w-full py-2 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[n.jsx("span",{children:s?"Show Less":"Show More"}),s?n.jsx(mi,{className:"h-4 w-4"}):n.jsx(fi,{className:"h-4 w-4"})]})]})}function dt(){return n.jsx("div",{className:"flex justify-center items-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})}function bt({message:e}){return n.jsx("div",{className:"rounded-md bg-red-50 p-4",children:n.jsx("div",{className:"flex",children:n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),n.jsx("div",{className:"mt-2 text-sm text-red-700",children:n.jsx("p",{children:e})})]})})})}function Sg({icon:e,label:t,onClick:r}){return n.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-colors",children:[n.jsx(e,{className:"h-4 w-4"}),n.jsx("span",{children:t})]})}function kc({title:e,actionIcon:t,actionLabel:r,onAction:a}){return n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold",children:e}),t&&r&&a&&n.jsx(Sg,{icon:t,label:r,onClick:a})]})}function _g(){const[e,t]=W.useState(!1),[r,a]=W.useState(null),{user:s}=yr();return{create:async o=>{if(!s)throw new Error("Not authenticated");t(!0),a(null);try{const c={...o,owner_id:s.id,organization_id:s.role==="brand_user"?s.organization_id:o.organization_id,status:"pending"},{error:d}=await je.from("production_orders").insert(c);if(d)throw d}catch(c){const d=c instanceof Error?c:new Error("Failed to create order");throw a(d),d}finally{t(!1)}},isLoading:e,error:r}}function Bo(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),{user:o}=yr();return W.useEffect(()=>{async function c(){if(o)try{let d=je.from("products").select(`
            *,
            organization:organizations(
              id,
              name
            )
          `).order("name");o.role==="brand_user"&&(d=d.eq("organization_id",o.organization_id));const{data:h,error:g}=await d;if(g)throw g;t(h)}catch(d){i(d instanceof Error?d:new Error("Error loading products"))}finally{a(!1)}}c()},[o]),{data:e,isLoading:r,error:s}}function kg({formData:e,onChange:t,isLoading:r}){const{data:a}=Aa(),{data:s}=Bo(),{user:i}=yr(),o=(i==null?void 0:i.role)==="brand_user",c=s==null?void 0:s.filter(d=>!o||d.organization_id===(i==null?void 0:i.organization_id));return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PO Number"}),n.jsx("input",{type:"text",required:!0,value:e.po_number,onChange:d=>t({po_number:d.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),!o&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),n.jsxs("select",{required:!0,value:e.organization_id,onChange:d=>t({organization_id:d.target.value,product_id:""}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:[n.jsx("option",{value:"",children:"Select Brand"}),a==null?void 0:a.map(d=>n.jsx("option",{value:d.id,children:d.name},d.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product"}),n.jsxs("select",{required:!0,value:e.product_id,onChange:d=>t({product_id:d.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:[n.jsx("option",{value:"",children:"Select Product"}),c==null?void 0:c.map(d=>{var h;return n.jsxs("option",{value:d.id,children:[d.name," (",(h=d.organization)==null?void 0:h.name,")"]},d.id)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),n.jsx("input",{type:"number",required:!0,min:"1",value:e.quantity||"",onChange:d=>t({quantity:parseInt(d.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Type"}),n.jsxs("select",{required:!0,value:e.order_type,onChange:d=>t({order_type:d.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:[n.jsx("option",{value:"Production Order",children:"Production Order"}),n.jsx("option",{value:"Project Plan",children:"Project Plan"}),n.jsx("option",{value:"NPD Order",children:"NPD Order"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Details"}),n.jsx("textarea",{value:e.details||"",onChange:d=>t({details:d.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]})]})}function Hu({isOpen:e,onClose:t,onSuccess:r}){const{create:a,isLoading:s,error:i}=_g(),{user:o}=yr(),[c,d]=W.useState({po_number:"",organization_id:(o==null?void 0:o.role)==="brand_user"?o.organization_id:"",product_id:"",quantity:0,order_type:"Production Order",details:""}),h=async g=>{g.preventDefault();try{await a(c),r==null||r(),t()}catch{}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add New Production Order"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsxs("form",{onSubmit:h,className:"space-y-4",children:[n.jsx(kg,{formData:c,onChange:g=>d({...c,...g}),isLoading:s}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Creating...":"Create Order"})]})]})]})}):null}function Ro(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),{user:o}=yr(),c=async()=>{if(o)try{a(!0);let d=je.from("production_orders").select(`
          id,
          po_number,
          quantity,
          order_type,
          is_priority,
          status,
          due_date,
          details,
          attachments,
          parent_order_id,
          split_reason,
          product:products(
            id,
            name,
            organization:organizations(
              id,
              name
            )
          ),
          organization:organizations(
            id,
            name
          ),
          tasks(
            id,
            details,
            status,
            start_date,
            due_date,
            duration_days,
            owner:users(
              id,
              full_name
            )
          )
        `).order("created_at",{ascending:!1});o.role==="brand_user"&&(d=d.eq("organization_id",o.organization_id));const{data:h,error:g}=await d;if(g)throw g;t(h),i(null)}catch(d){i(d instanceof Error?d:new Error("Error loading orders")),t(null)}finally{a(!1)}};return W.useEffect(()=>{c()},[o]),{data:e,isLoading:r,error:s,refetch:c}}function Lg(){const[e,t]=W.useState(!1),{isLeumasStaff:r}=At(),{data:a,isLoading:s,error:i,refetch:o}=Ro(),{regularOrders:c,splitGroups:d}=ta.useMemo(()=>{if(!a)return{regularOrders:[],splitGroups:[]};const h=new Map,g=[];a.forEach(y=>{y.parent_order_id||(a.some(v=>v.parent_order_id===y.id)?h.set(y.id,[y]):g.push(y))}),a.forEach(y=>{y.parent_order_id&&h.has(y.parent_order_id)&&h.get(y.parent_order_id).push(y)});const x=Array.from(h.values()).map(y=>y.sort((m,v)=>m.po_number.localeCompare(v.po_number)));return{regularOrders:g,splitGroups:x}},[a]);return n.jsxs("div",{className:"bg-gray-100 rounded-lg shadow-sm p-6",children:[n.jsx(kc,{title:"Production Orders",actionIcon:r?Qt:void 0,actionLabel:r?"Add Order":void 0,onAction:r?()=>t(!0):void 0}),n.jsxs("div",{className:"mt-4",children:[s&&n.jsx(dt,{}),i&&n.jsx(bt,{message:i.message}),a&&n.jsxs("div",{className:"space-y-4",children:[n.jsx(wo,{items:c,renderItem:h=>n.jsx(_c,{order:h},h.id),limit:4}),n.jsx(wo,{items:d,renderItem:h=>n.jsx(Uu,{orders:h,onUpdate:o},h[0].id),limit:2})]})]}),e&&n.jsx(Hu,{isOpen:e,onClose:()=>t(!1),onSuccess:o})]})}async function Ag(e){const{data:t,error:r}=await je.from("products").insert(e).select().single();if(r)throw r;if(!t)throw new Error("Failed to create product");return t}function Pg(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{create:async i=>{t(!0),a(null);try{return await Ag(i)}catch(o){throw a(o instanceof Error?o:new Error("Failed to create product")),o}finally{t(!1)}},isLoading:e,error:r}}function Cg({formData:e,onChange:t,isLoading:r}){const{data:a}=Aa();return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product Name"}),n.jsx("input",{type:"text",required:!0,value:e.name,onChange:s=>t({...e,name:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),n.jsxs("select",{required:!0,value:e.organization_id,onChange:s=>t({...e,organization_id:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:[n.jsx("option",{value:"",children:"Select Brand"}),a==null?void 0:a.filter(s=>s.type==="Customer Brand").map(s=>n.jsx("option",{value:s.id,children:s.name},s.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Batch Size"}),n.jsx("input",{type:"number",required:!0,min:"1",value:e.batch_size,onChange:s=>t({...e,batch_size:parseInt(s.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Price (₹)"}),n.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:e.price_inr,onChange:s=>t({...e,price_inr:parseFloat(s.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]})]})}function Wu({isOpen:e,onClose:t,onSuccess:r}){const{create:a,isLoading:s,error:i}=Pg(),[o,c]=W.useState({name:"",batch_size:0,price_inr:0,organization_id:""}),d=async h=>{h.preventDefault();try{await a(o),r==null||r(),t()}catch{}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add New Product"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsx(Cg,{formData:o,onChange:c,isLoading:s}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Creating...":"Create Product"})]})]})]})}):null}function Eg(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),{data:s,isLoading:i,error:o}=Bo(),c=r||a;return i?n.jsx(dt,{}):o?n.jsx(bt,{message:o.message}):n.jsxs("div",{className:"bg-gray-100 rounded-lg shadow-sm p-6",children:[n.jsx(kc,{title:"Products",actionIcon:c?Qt:void 0,actionLabel:c?"Add Product":void 0,onAction:c?()=>t(!0):void 0}),n.jsx(wo,{items:s,renderItem:d=>n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("h3",{className:"font-medium truncate",children:d.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Batch size: ",d.batch_size]})]}),n.jsxs("p",{className:"text-indigo-600 font-medium whitespace-nowrap ml-4",children:["₹",d.price_inr]})]})},d.id),emptyMessage:"No products found",limit:8}),e&&n.jsx(Wu,{isOpen:e,onClose:()=>t(!1)})]})}function Vu(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null),{user:c}=yr();return W.useEffect(()=>{async function d(){if(c)try{s(!0);let h=je.from("tasks").select(`
            *,
            owner:users!owner_id(*),
            production_order:production_orders!inner(
              id,
              po_number,
              quantity,
              organization_id,
              product:products!inner(
                id,
                name
              ),
              organization:organizations!inner(
                id,
                name
              )
            )
          `);e&&(h=h.eq("status",e)),c.role==="brand_user"&&(h=h.eq("production_order.organization_id",c.organization_id));const{data:g,error:x}=await h;if(x)throw x;r(g),o(null)}catch(h){console.error("Failed to load tasks:",h),o(h instanceof Error?h:new Error("Failed to load tasks")),r(null)}finally{s(!1)}}d()},[e,c]),{data:t,isLoading:a,error:i}}function Fg({task:e}){return n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold",children:e.details}),e.production_order&&n.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-500",children:[n.jsxs("span",{children:["PO: ",e.production_order.po_number]}),e.production_order.organization&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsx("span",{children:e.production_order.organization.name})]})]})]})}function Ig(){const[e,t]=W.useState(!1),[r,a]=W.useState(null),{isAdmin:s,isManager:i}=At();return{updateStatus:async(c,d)=>{if(!s&&!i){const h=new Error("Only admins and managers can update task status");throw a(h),h}t(!0),a(null);try{const{error:h}=await je.from("tasks").update({status:d}).eq("id",c);if(h)throw h}catch(h){const g=h instanceof Error?h:new Error("Failed to update task status");throw a(g),g}finally{t(!1)}},isLoading:e,error:r,canUpdateStatus:s||i}}const Bd={completed:{bg:"bg-green-100",text:"text-green-800"},in_progress:{bg:"bg-blue-100",text:"text-blue-800"},pending_from_client:{bg:"bg-orange-100",text:"text-orange-800"},pending:{bg:"bg-yellow-100",text:"text-yellow-800"}};function hc(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):"Unknown"}function fc(e){if(!e||!Bd[e])return"bg-gray-100 text-gray-800";const t=Bd[e];return`${t.bg} ${t.text}`}const Mg=["pending","pending_from_client","in_progress","completed"];function Rd({status:e,onChange:t,disabled:r,readOnly:a}){return a?n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${fc(e)}`,children:hc(e)}):n.jsx("select",{value:e,onChange:s=>t==null?void 0:t(s.target.value),disabled:r,className:`
        w-full px-3 py-2 rounded-lg text-sm border
        ${fc(e)}
        ${r?"opacity-50 cursor-not-allowed":"cursor-pointer"}
        focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500
      `,children:Mg.map(s=>n.jsx("option",{value:s,children:hc(s)},s))})}function Tg({taskId:e,currentStatus:t}){const[r,a]=W.useState(t),{updateStatus:s,isLoading:i,canUpdateStatus:o}=Ig(),c=r!==t,d=async()=>{if(c)try{await s(e,r)}catch(h){console.error("Error updating task status:",h),a(t)}};return o?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),c&&n.jsx(vs,{onClick:d,isLoading:i})]}),n.jsx(Rd,{status:r,onChange:a,disabled:i})]}):n.jsx(Rd,{status:t,readOnly:!0})}async function Og(e,t,r){const{error:a}=await je.from("tasks").update({[t]:r}).eq("id",e);if(a)throw a;await Dg(e,`${t}_update`,`Updated ${t}`)}async function Dg(e,t,r){var s;const{error:a}=await je.from("task_history").insert({task_id:e,action:t,details:r,user_id:(s=(await je.auth.getUser()).data.user)==null?void 0:s.id});if(a)throw a}function Bg(e,t,r){const[a,s]=W.useState(r),[i,o]=W.useState(!1),[c,d]=W.useState(null),h=W.useCallback(async()=>{o(!0),d(null);try{await Og(e,t,a)}catch(g){const x=g instanceof Error?g:new Error(`Failed to save ${t}`);throw d(x),x}finally{o(!1)}},[e,t,a]);return{value:a,setValue:s,save:h,isLoading:i,error:c,hasChanges:a!==r}}function Rg({task:e}){const{isAdmin:t,isManager:r}=At(),{value:a,setValue:s,save:i,isLoading:o,error:c,hasChanges:d}=Bg(e.id,"duration_days",e.duration_days),h=t||r,g=async x=>{x.preventDefault(),await i()};return h?n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duration"}),c&&n.jsx("div",{className:"text-sm text-red-600",children:c.message}),n.jsxs("form",{onSubmit:g,className:"flex items-center gap-2",children:[n.jsx("input",{type:"number",min:"1",value:a,onChange:x=>s(parseInt(x.target.value)),disabled:o,className:"w-20 px-2 py-1 text-sm border rounded focus:ring-indigo-500 focus:border-indigo-500"}),n.jsx("span",{className:"text-sm text-gray-600",children:"days"}),d&&n.jsx("button",{type:"submit",disabled:o,className:"px-2 py-1 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700 disabled:opacity-50",children:o?"Saving...":"Save"})]})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duration"}),n.jsxs("div",{className:"text-sm text-gray-600",children:[a," days"]})]})}function qg(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{a(!0),i(null);const{data:c,error:d}=await je.from("users").select(`
            id,
            full_name,
            email,
            role,
            organization:organizations(
              id,
              name
            )
          `).order("role").order("full_name");if(d)throw d;t(c)}catch(c){console.error("Error fetching owners:",c),i(c instanceof Error?c:new Error("Failed to load available owners"))}finally{a(!1)}}o()},[]),{owners:e,isLoading:r,error:s}}function zg(e){const[t,r]=W.useState(!1),[a,s]=W.useState(null),{isAdmin:i,isManager:o}=At(),c=i||o;return{updateOwner:async h=>{if(!c)throw new Error("Only admins and managers can update task owners");if(e.id){r(!0),s(null);try{const{error:g}=await je.from("tasks").update({owner_id:h,updated_at:new Date().toISOString()}).eq("id",e.id);if(g)throw g}catch(g){const x=g instanceof Error?g:new Error("Failed to update task owner");throw s(x),x}finally{r(!1)}}},isLoading:t,error:a,canUpdateOwner:c}}function Ug({task:e}){const{owners:t,isLoading:r,error:a}=qg(),{updateOwner:s,isLoading:i,error:o,canUpdateOwner:c}=zg(e),[d,h]=W.useState(e.owner_id),g=r||i,x=a||o,y=d!==e.owner_id,m=async()=>{try{await s(d)}catch(v){console.error("Failed to update owner:",v)}};if(r)return n.jsx(dt,{});if(x)return n.jsx("div",{className:"text-sm text-red-600",children:x.message});if(!c){const v=t==null?void 0:t.find(N=>N.id===e.owner_id);return n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(ra,{className:"h-4 w-4 text-gray-400"}),n.jsx("span",{children:(v==null?void 0:v.full_name)||"Unassigned"})]})]})}return n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner"}),y&&n.jsx(vs,{onClick:m,isLoading:g})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ra,{className:"h-4 w-4 text-gray-400"}),n.jsxs("select",{value:d||"",onChange:v=>h(v.target.value||null),disabled:g,className:`
            block w-full rounded-md border-gray-300 shadow-sm 
            focus:border-indigo-500 focus:ring-indigo-500
            ${g?"opacity-50 cursor-not-allowed":""}
          `,children:[n.jsx("option",{value:"",children:"Unassigned"}),t==null?void 0:t.map(v=>n.jsxs("option",{value:v.id,children:[v.full_name," (",v.organization.name,")"]},v.id))]})]})]})}function Hg(e){const[t,r]=W.useState(null),[a,s]=W.useState(!1),i=async()=>{try{s(!0);const{data:h,error:g}=await je.from("task_todos").select("*").eq("task_id",e).order("created_at");if(g)throw g;r(h)}catch(h){console.error("Error fetching todos:",h),r(null)}finally{s(!1)}};return W.useEffect(()=>{i()},[e]),{todos:t,isLoading:a,addTodo:async(h,g=!1)=>{try{s(!0);const{error:x}=await je.from("task_todos").insert({task_id:e,description:h,is_private:g,completed:!1});if(x)throw x;await i()}catch(x){throw console.error("Error adding todo:",x),x}finally{s(!1)}},toggleTodo:async(h,g)=>{try{s(!0);const{error:x}=await je.from("task_todos").update({completed:g}).eq("id",h);if(x)throw x;await i()}catch(x){throw console.error("Error toggling todo:",x),x}finally{s(!1)}},deleteTodo:async h=>{try{s(!0);const{error:g}=await je.from("task_todos").delete().eq("id",h);if(g)throw g;await i()}catch(g){throw console.error("Error deleting todo:",g),g}finally{s(!1)}},refetch:i}}function Wg(e){const[t,r]=W.useState(e.attachments||[]),[a,s]=W.useState(!1),[i,o]=W.useState(null),c=JSON.stringify(t)!==JSON.stringify(e.attachments);return{attachments:t,setAttachments:r,save:async()=>{if(c){s(!0),o(null);try{const{error:h}=await je.from("task_todos").update({attachments:t}).eq("id",e.id);if(h)throw h}catch(h){const g=h instanceof Error?h:new Error("Failed to save attachments");throw o(g),g}finally{s(!1)}}},hasChanges:c,isLoading:a,error:i}}function Vg({todo:e,canManage:t}){var d,h;const{attachments:r,setAttachments:a,save:s,isLoading:i,error:o,hasChanges:c}=Wg(e);return!t&&!((d=e.attachments)!=null&&d.length)?null:t?n.jsxs("div",{className:"pl-8 space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Proof of Work"}),c&&n.jsx(vs,{onClick:s,isLoading:i})]}),o&&n.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:o.message}),n.jsx(Po,{files:r,onChange:a,disabled:i})]}):n.jsxs("div",{className:"pl-8 space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Proof of Work"}),(h=e.attachments)==null?void 0:h.map(g=>n.jsxs("a",{href:g.path,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-indigo-600 hover:text-indigo-800",children:[n.jsx("span",{className:"truncate",children:g.name}),n.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Math.round(g.size/1024),"KB)"]})]},g.path))]})}function Gg(e){const[t,r]=W.useState(e.notes||""),[a,s]=W.useState(!1),[i,o]=W.useState(null),c=t!==e.notes;return{notes:t,setNotes:r,save:async()=>{if(c){s(!0),o(null);try{const{error:h}=await je.from("task_todos").update({notes:t}).eq("id",e.id);if(h)throw h}catch(h){const g=h instanceof Error?h:new Error("Failed to save notes");throw o(g),g}finally{s(!1)}}},hasChanges:c,isLoading:a,error:i}}function Yg({todo:e,canManage:t}){const{notes:r,setNotes:a,save:s,isLoading:i,error:o,hasChanges:c}=Gg(e);return!t&&!e.notes?null:t?n.jsxs("div",{className:"pl-8 space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Notes"}),c&&n.jsx(vs,{onClick:s,isLoading:i})]}),o&&n.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:o.message}),n.jsx("textarea",{value:r,onChange:d=>a(d.target.value),disabled:i,placeholder:"Add notes...",rows:3,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"})]}):n.jsxs("div",{className:"pl-8 space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Notes"}),n.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:e.notes})]})}function $g({todo:e,onToggle:t,onTogglePrivate:r,onDelete:a,canManage:s,isLoading:i}){var g;const[o,c]=ta.useState(!1),[d,h]=ta.useState(!1);return n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[n.jsx("input",{type:"checkbox",checked:e.completed,onChange:x=>t(x.target.checked),disabled:!s||i,className:"h-4 w-4 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500"}),n.jsxs("span",{className:`flex-1 ${e.completed?"line-through text-gray-500":""}`,children:[e.description,e.is_private&&n.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(Private)"})]}),n.jsx("div",{className:"flex items-center gap-2",children:s&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>r(!e.is_private),className:`${e.is_private?"text-gray-400":"text-indigo-600"} hover:text-indigo-700 disabled:opacity-50`,title:e.is_private?"Make public":"Make private",disabled:i,children:e.is_private?n.jsx(gc,{className:"h-4 w-4"}):n.jsx(vf,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>h(!d),className:"text-indigo-600 hover:text-indigo-700 disabled:opacity-50",title:"Add notes",children:n.jsx(Kd,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>c(!o),className:"text-indigo-600 hover:text-indigo-700 disabled:opacity-50",title:"Add proof of work",children:n.jsx(Ff,{className:"h-4 w-4"})}),n.jsx("button",{onClick:a,disabled:i,className:"text-red-600 hover:text-red-700 disabled:opacity-50",children:n.jsx(ys,{className:"h-4 w-4"})})]})})]}),(d||e.notes)&&n.jsx(Yg,{todo:e,canManage:s}),(o||((g=e.attachments)==null?void 0:g.length)>0)&&n.jsx(Vg,{todo:e,canManage:s})]})}function Jg({task:e}){const{isAdmin:t,isManager:r,isStaff:a}=At(),s=t||r||a,[i,o]=W.useState(""),[c,d]=W.useState(!1),{todos:h,addTodo:g,toggleTodo:x,togglePrivate:y,deleteTodo:m,isLoading:v}=Hg(e.id),N=async L=>{if(L.preventDefault(),!(!i.trim()||v))try{await g(i.trim(),c),o(""),d(!1)}catch(w){console.error("Error adding subtask:",w)}};return n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Subtasks"}),s&&n.jsxs("form",{onSubmit:N,className:"space-y-2",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:i,onChange:L=>o(L.target.value),placeholder:"Add new subtask",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:v}),n.jsx("button",{type:"submit",disabled:v||!i.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:n.jsx(Qt,{className:"h-5 w-5"})})]}),n.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx("input",{type:"checkbox",checked:c,onChange:L=>d(L.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(gc,{className:"h-4 w-4"}),"Make private (only visible to Leumas staff)"]})]})]}),n.jsx("div",{className:"space-y-2",children:h==null?void 0:h.map(L=>n.jsx($g,{todo:L,onToggle:w=>x(L.id,w),onTogglePrivate:w=>y(L.id,w),onDelete:()=>m(L.id),canManage:s,isLoading:v},L.id))})]})}function Kg(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null);return W.useEffect(()=>{async function c(){try{s(!0),o(null);const{data:d,error:h}=await je.from("task_history").select(`
            id,
            task_id,
            user_id,
            action,
            details,
            created_at,
            user:users(
              id,
              full_name,
              role
            )
          `).eq("task_id",e).order("created_at",{ascending:!1});if(h)throw h;r(d)}catch(d){console.error("Error loading task history:",d),o(d instanceof Error?d:new Error("Error loading task history"))}finally{s(!1)}}c()},[e]),{data:t,isLoading:a,error:i}}function Xg({task:e}){const{data:t,isLoading:r,error:a}=Kg(e.id);return r?n.jsx(dt,{}):a?n.jsx(bt,{message:a.message}):t!=null&&t.length?n.jsx("div",{className:"space-y-4",children:t.map(s=>{var i;return n.jsxs("div",{className:"flex gap-4 p-4 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center",children:n.jsx(ra,{className:"h-4 w-4 text-indigo-600"})})}),n.jsx("div",{className:"flex-grow",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:((i=s.user)==null?void 0:i.full_name)||"Unknown User"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.details})]}),n.jsx("span",{className:"text-xs text-gray-500",children:_r(s.created_at)})]})})]},s.id)})}):n.jsx("div",{className:"text-center py-4 text-gray-500",children:"No history available"})}function Qg(e,t){W.useEffect(()=>{const r=je.channel(`realtime:${e.table}`).on("postgres_changes",{event:e.event||"*",schema:e.schema||"public",table:e.table,filter:e.filter},()=>t()).subscribe();return()=>{r.unsubscribe()}},[e.table,e.event,e.filter,t])}function Zg(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null),c=async()=>{try{s(!0);const{data:d,error:h}=await je.from("tasks").select(`
          *,
          owner:users!owner_id(*),
          production_order:production_orders!inner (
            id,
            po_number,
            quantity,
            organization:organizations!inner (
              id,
              name
            )
          )
        `).eq("id",e).single();if(h)throw h;r(d),o(null)}catch(d){o(d instanceof Error?d:new Error("Failed to load task")),r(null)}finally{s(!1)}};return W.useEffect(()=>{c()},[e]),Qg({table:"tasks",filter:`id=eq.${e}`},c),{task:t,isLoading:a,error:i}}function ep(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{updateTask:async(i,o)=>{t(!0),a(null);try{const{error:c}=await je.from("tasks").update(o).eq("id",i);if(c)throw c}catch(c){const d=c instanceof Error?c:new Error("Failed to update task");throw a(d),d}finally{t(!1)}},isLoading:e,error:r}}function tp({task:e,isOpen:t,onClose:r}){const{task:a,isLoading:s,error:i}=Zg(e.id),{updateTask:o,isLoading:c}=ep(),{isAdmin:d,isManager:h}=At(),g=d||h,[x,y]=W.useState(e.has_external_dependency),m=a?x!==a.has_external_dependency:!1,v=()=>{y(!x)},N=async()=>{if(!(!a||!g))try{await o(a.id,{has_external_dependency:x})}catch(w){console.error("Failed to toggle dependency:",w),y(a.has_external_dependency)}};if(!t)return null;const L=a||e;return n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[n.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[n.jsx(Fg,{task:L}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 180px)"},children:[i&&n.jsx(bt,{message:i.message}),n.jsxs("div",{className:"space-y-8",children:[g&&n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:x,onChange:v,className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]}),n.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:["External Dependency",n.jsx(mc,{className:"h-4 w-4 text-red-500"})]})]}),m&&n.jsx(vs,{onClick:N,isLoading:c})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsx(Tg,{taskId:L.id,currentStatus:L.status}),n.jsx(Ug,{task:L}),n.jsx(Rg,{task:L})]}),n.jsx(Jg,{task:L}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"History"}),n.jsx(Xg,{task:L})]})]}),s&&n.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-50 flex items-center justify-center",children:n.jsx(dt,{})})]})]})})}function rp({task:e}){return n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h3",{className:"text-lg font-semibold",children:e.details}),e.is_priority&&n.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800",children:"Priority"})]})}function np({task:e}){return e.production_order?n.jsxs("div",{className:"mt-2 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsxs("span",{children:["PO: ",e.production_order.po_number]}),e.production_order.organization&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsx("span",{children:e.production_order.organization.name})]})]}),e.production_order.product&&n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(rr,{className:"h-4 w-4"}),n.jsx("span",{children:e.production_order.product.name})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(wf,{className:"h-4 w-4"}),n.jsxs("span",{children:["Qty: ",e.production_order.quantity]})]})]})]}):null}function ap({status:e}){return n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${fc(e)}`,children:hc(e)})}function sp(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return{deleteTask:async o=>{if(!s)throw new Error("Insufficient permissions");t(!0);try{const{error:c}=await je.from("tasks").delete().eq("id",o);if(c)throw c}catch(c){throw console.error("Error deleting task:",c),c}finally{t(!1)}},isLoading:e,canDelete:s}}function ip({taskId:e,onDelete:t}){const{deleteTask:r,isLoading:a,canDelete:s}=sp();if(!s)return null;const i=async()=>{try{await r(e),t==null||t()}catch(o){console.error("Failed to delete task:",o)}};return n.jsx(Sc,{onDelete:i,isLoading:a,confirmMessage:"Are you sure you want to delete this task? This action cannot be undone."})}function op({hasExternalDependency:e}){return e?n.jsxs("div",{className:"group relative inline-flex items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 rounded-full bg-red-200 animate-ping opacity-75"}),n.jsx("div",{className:"relative z-10 p-1 rounded-full bg-red-100 shadow-lg ring-2 ring-red-400 animate-[bounce_2s_ease-in-out_infinite]",children:n.jsx(mc,{className:"h-4 w-4 text-red-500"})})]}),n.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block w-64 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-xl transition-opacity duration-200 opacity-0 group-hover:opacity-100",children:[n.jsx("div",{className:"font-medium mb-1",children:"External Dependency"}),n.jsx("p",{className:"text-gray-300 text-xs",children:"Involves external vendors/dependencies and hence timelines may vary despite best efforts"}),n.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full -mt-1 border-4 border-transparent border-t-gray-900"})]})]}):null}function Gu({task:e,onUpdate:t}){var i;const[r,a]=W.useState(!1),s=e.has_external_dependency;return n.jsxs(n.Fragment,{children:[n.jsxs("div",{onClick:()=>a(!0),className:bo("bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow cursor-pointer",s&&"bg-red-50"),children:[n.jsxs("div",{className:"flex justify-between items-start mb-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(rp,{task:e}),n.jsx(op,{hasExternalDependency:s})]}),n.jsx(np,{task:e})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ap,{status:e.status}),n.jsx(ip,{taskId:e.id,onDelete:t})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(ra,{className:"h-4 w-4"}),n.jsx("span",{children:((i=e.owner)==null?void 0:i.full_name)||"Unassigned"})]}),n.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xf,{className:"h-4 w-4"}),n.jsxs("span",{children:["Start: ",_r(e.start_date)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),n.jsxs("span",{children:["Due: ",_r(e.due_date)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bf,{className:"h-4 w-4"}),n.jsxs("span",{children:[e.duration_days," days"]})]})]}),n.jsx(Kl,{status:e.status})]})]}),n.jsx(tp,{task:e,isOpen:r,onClose:()=>a(!1)})]})}function lp(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{create:async i=>{var o;if(!i.production_order_id)throw new Error("Production order ID is required");t(!0),a(null);try{const{data:{user:c}}=await je.auth.getUser();if(!c)throw new Error("Not authenticated");const{data:d,error:h}=await je.from("tasks").insert({production_order_id:i.production_order_id,details:i.details||i.name,start_date:i.start_date,duration_days:i.duration_days,owner_id:c.id,status:"pending"}).select().single();if(h)throw h;if(!d)throw new Error("Failed to create task");if((o=i.todos)!=null&&o.length){const{error:g}=await je.from("task_todos").insert(i.todos.map(x=>({task_id:d.id,description:x.description,is_private:x.is_private,completed:!1})));if(g)throw g}return d}catch(c){const d=c instanceof Error?c:new Error("Failed to create task");throw a(d),d}finally{t(!1)}},isLoading:e,error:r}}function cp({formData:e,onChange:t,isLoading:r}){return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Task Name"}),n.jsx("input",{type:"text",required:!0,value:e.name,onChange:a=>t({...e,name:a.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,placeholder:"e.g., Raw Material Inspection"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Details"}),n.jsx("textarea",{value:e.details,onChange:a=>t({...e,details:a.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,placeholder:"Additional task details or instructions..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duration (days)"}),n.jsx("input",{type:"number",required:!0,min:"1",value:e.duration_days,onChange:a=>t({...e,duration_days:parseInt(a.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]})]})}function Lc(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),o=W.useCallback(async()=>{try{const{data:d,error:h}=await je.from("task_templates").select("*").eq("is_active",!0).order("name");if(h)throw h;t(d),i(null)}catch(d){i(d instanceof Error?d:new Error("Error loading templates")),t(null)}finally{a(!1)}},[]),c=W.useCallback(async d=>{try{const{data:h,error:g}=await je.from("task_template_items").select(`
          id,
          template_id,
          name,
          duration_days,
          order_index,
          details_template,
          todos
        `).eq("template_id",d).order("order_index");if(g)throw g;return(h||[]).map(x=>({...x,todos:Array.isArray(x.todos)?x.todos:[]}))}catch(h){throw console.error("Error loading template items:",h),h instanceof Error?h:new Error("Error loading template items")}},[]);return W.useEffect(()=>{o()},[o]),{templates:e,isLoading:r,error:s,getTemplateItems:c,refetch:o}}function dp({items:e}){return n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Template Tasks:"}),n.jsx("ul",{className:"space-y-1 text-sm text-gray-600",children:e.map(t=>n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsxs("span",{children:["• ",t.name]}),n.jsxs("span",{className:"text-gray-400",children:["(",t.duration_days," days)"]}),t.todos&&t.todos.length>0&&n.jsxs("span",{className:"text-indigo-600",children:["(",t.todos.length," subtasks)"]})]},t.id))})]})}function up({productionOrderId:e,startDate:t,onAddTasks:r,disabled:a}){const{templates:s,getTemplateItems:i,isLoading:o}=Lc(),[c,d]=W.useState(""),[h,g]=W.useState(null),[x,y]=W.useState(!1),[m,v]=W.useState(null);W.useEffect(()=>{async function L(){if(!c){g(null);return}try{y(!0),v(null);const w=await i(c);g(w)}catch(w){console.error("Error loading template items:",w),v("Failed to load template items"),g(null)}finally{y(!1)}}L()},[c,i]);const N=()=>{if(!h)return;const L=h.map(w=>({production_order_id:e,name:w.name,details:w.details_template||w.name,start_date:t,duration_days:w.duration_days,fromTemplate:!0,templateItemId:w.id,todos:w.todos||[]}));r(L),d(""),g(null)};return o?n.jsx(dt,{}):n.jsxs("div",{className:"space-y-4",children:[m&&n.jsx(bt,{message:m}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Template"}),n.jsxs("select",{value:c,onChange:L=>d(L.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a||x,children:[n.jsx("option",{value:"",children:"Choose a template"}),s==null?void 0:s.map(L=>n.jsx("option",{value:L.id,children:L.name},L.id))]})]}),x&&n.jsx(dt,{}),h&&!x&&n.jsxs("div",{className:"space-y-4",children:[n.jsx(dp,{items:h}),n.jsx("button",{type:"button",onClick:N,disabled:a,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:"Apply Template Tasks"})]})]})}function hp({tasks:e,onRemove:t}){return n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Tasks to Create"}),n.jsx("div",{className:"space-y-2",children:e.map((r,a)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:r.name}),n.jsxs("div",{className:"text-sm text-gray-500",children:[r.details,r.todos&&r.todos.length>0&&n.jsxs("span",{className:"ml-2 text-indigo-600",children:["(",r.todos.length," subtasks)"]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Duration: ",r.duration_days," days"]})]}),n.jsx("button",{onClick:()=>t(a),className:"text-gray-400 hover:text-red-600",children:n.jsx(Ft,{className:"h-5 w-5"})})]},a))})]})}function Yu({isOpen:e,onClose:t,onSuccess:r}){const{data:a,isLoading:s}=Ro(),{create:i,isLoading:o}=lp(),[c,d]=W.useState(null),[h,g]=W.useState([]),[x,y]=W.useState({production_order_id:"",name:"",details:"",start_date:new Date().toISOString().split("T")[0],duration_days:1}),m=async()=>{if(!h.length){d("Please add at least one task");return}try{d(null);for(const w of h)await i(w);r==null||r(),t()}catch(w){console.error("Error creating tasks:",w),d(w instanceof Error?w.message:"Failed to create tasks")}},v=()=>{if(!x.production_order_id||!x.name){d("Please select an order and provide a task name");return}g([...h,{...x}]),y({...x,name:"",details:"",duration_days:1}),d(null)},N=w=>{if(!x.production_order_id){d("Please select a production order first");return}g([...h,...w])},L=w=>{g(h.filter((j,S)=>S!==w))};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add Tasks"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),c&&n.jsx(bt,{message:c}),n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Production Order"}),n.jsxs("select",{required:!0,value:x.production_order_id,onChange:w=>y({...x,production_order_id:w.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:s||o,children:[n.jsx("option",{value:"",children:"Select Order"}),a==null?void 0:a.map(w=>n.jsxs("option",{value:w.id,children:[w.po_number," - ",w.product.name]},w.id))]})]}),x.production_order_id&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Task Manually"}),n.jsx(cp,{formData:x,onChange:y,isLoading:o}),n.jsx("button",{type:"button",onClick:v,disabled:o||!x.name,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:"Add Task"})]}),n.jsxs("div",{className:"pt-6 border-t",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Or add from template"}),n.jsx(up,{productionOrderId:x.production_order_id,startDate:x.start_date,onAddTasks:N,disabled:o})]})]}),h.length>0&&n.jsxs("div",{className:"pt-6 border-t",children:[n.jsx(hp,{tasks:h,onRemove:L}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsx("button",{type:"button",onClick:m,disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:o?"Creating Tasks...":"Create All Tasks"})})]})]})]})}):null}function fp(){const[e,t]=W.useState(!1),{data:r,isLoading:a,error:s}=Vu("pending"),{isAdmin:i,isManager:o}=At(),c=i||o;return n.jsxs("div",{className:"bg-gray-100 rounded-lg shadow-sm p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold",children:"Production Tasks"}),c&&n.jsxs("button",{onClick:()=>t(!0),className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-4 w-4"}),"Add Task"]})]}),a&&n.jsx(dt,{}),s&&n.jsx(bt,{message:s.message}),n.jsx("div",{className:"space-y-4",children:r!=null&&r.length?r.slice(0,5).map(d=>n.jsx(Gu,{task:d},d.id)):n.jsx("div",{className:"text-center py-4 text-gray-500",children:"No pending tasks found"})}),e&&n.jsx(Yu,{isOpen:e,onClose:()=>t(!1)})]})}function $u(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),{user:o}=yr();return W.useEffect(()=>{async function c(){if(o)try{let d=je.from("tickets").select(`
            *,
            created_by:users!tickets_created_by_fkey(
              id,
              full_name,
              email
            ),
            assigned_to:users!tickets_assigned_to_fkey(
              id,
              full_name,
              email
            ),
            organization:organizations(
              id,
              name
            )
          `).order("created_at",{ascending:!1});o.role==="brand_user"&&(d=d.eq("organization_id",o.organization_id));const{data:h,error:g}=await d;if(g)throw g;t(h)}catch(d){i(d instanceof Error?d:new Error("Error loading tickets"))}finally{a(!1)}}c()},[o]),{data:e,isLoading:r,error:s}}const mp={low:"bg-blue-100 text-blue-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},gp={open:{bg:"bg-yellow-100",text:"text-yellow-800",icon:_o},in_progress:{bg:"bg-blue-100",text:"text-blue-800",icon:mc},resolved:{bg:"bg-green-100",text:"text-green-800",icon:yf}};function Ju({ticket:e,onClick:t}){const r=gp[e.status],a=r.icon;return n.jsxs("div",{onClick:t,className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow cursor-pointer",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h3",{className:"text-lg font-medium",children:e.title}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${mp[e.priority]}`,children:e.priority})]}),n.jsxs("div",{className:"mt-1 space-y-1",children:[n.jsxs("p",{className:"text-sm text-gray-500",children:["Category: ",e.category]}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",_r(e.created_at)]})]})]}),n.jsxs("span",{className:`px-2 py-1 rounded-full text-xs flex items-center gap-1 ${r.bg} ${r.text}`,children:[n.jsx(a,{className:"h-3 w-3"}),e.status]})]}),n.jsx("p",{className:"mt-4 text-sm text-gray-600 line-clamp-2",children:e.description}),n.jsxs("div",{className:"mt-4 flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ra,{className:"h-4 w-4"}),n.jsx("span",{children:e.created_by.full_name})]}),e.assigned_to&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:["Assigned to ",e.assigned_to.full_name]})]})]})]})}function pp(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{create:async i=>{t(!0),a(null);try{const{data:{user:o}}=await je.auth.getUser();if(!o)throw new Error("Not authenticated");const{data:c,error:d}=await je.from("users").select("organization_id").eq("id",o.id).single();if(d)throw d;const{error:h}=await je.from("tickets").insert({...i,created_by:o.id,organization_id:c.organization_id,status:"open"});if(h)throw h}catch(o){const c=o instanceof Error?o:new Error("Failed to create ticket");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}const xp=["Dispatch Request","Formulation","Compliance","Sourcing","Packaging","Documentation","Costing","Others"];function yp(e){switch(e){case"Dispatch Request":return`Please provide:
- Goods to be dispatched
- Date
- Vehicle number
- Manifest Copy (to be attached)`;case"Formulation":return`Please provide:
- Product Brief
- Agenda
- Dates that work for you`;default:return""}}function vp({formData:e,onChange:t,isLoading:r}){const{data:a}=Aa(),{user:s}=yr(),i=(s==null?void 0:s.role)==="brand_user";return n.jsxs("div",{className:"space-y-4 max-h-[calc(100vh-16rem)] overflow-y-auto px-1",children:[!i&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),n.jsxs("select",{required:!0,value:e.organization_id,onChange:o=>t({organization_id:o.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:[n.jsx("option",{value:"",children:"Select Brand"}),a==null?void 0:a.map(o=>n.jsx("option",{value:o.id,children:o.name},o.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),n.jsx("select",{required:!0,value:e.category,onChange:o=>t({category:o.target.value,description:""}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:xp.map(o=>n.jsx("option",{value:o,children:o},o))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),n.jsx("input",{type:"text",required:!0,value:e.title,onChange:o=>t({title:o.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),n.jsx("textarea",{required:!0,value:e.description,onChange:o=>t({description:o.target.value}),rows:4,placeholder:yp(e.category),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),n.jsxs("select",{required:!0,value:e.priority,onChange:o=>t({priority:o.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,children:[n.jsx("option",{value:"low",children:"Low"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"high",children:"High"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),n.jsx(Po,{files:e.attachments||[],onChange:o=>t({attachments:o}),disabled:r})]})]})}function Ku({isOpen:e,onClose:t,onSuccess:r}){const{create:a,isLoading:s,error:i}=pp(),[o,c]=W.useState({title:"",description:"",category:"Others",priority:"medium",organization_id:"",attachments:[]}),d=async h=>{h.preventDefault();try{await a(o),r==null||r(),t()}catch{}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl",children:[n.jsxs("div",{className:"p-6 border-b",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"New Service Request"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mt-4 p-2 bg-red-100 text-red-700 rounded",children:i.message})]}),n.jsxs("form",{onSubmit:d,children:[n.jsx("div",{className:"p-6",children:n.jsx(vp,{formData:o,onChange:h=>c({...o,...h}),isLoading:s})}),n.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-4",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Creating...":"Create Request"})]})]})]})}):null}function bp(){const[e,t]=W.useState(!1),{data:r,isLoading:a,error:s}=$u();return a?n.jsx(dt,{}):s?n.jsx(bt,{message:s.message}):n.jsxs("div",{className:"bg-gray-100 rounded-lg shadow-sm p-6",children:[n.jsx(kc,{title:"Support Tickets",actionIcon:Qt,actionLabel:"Raise Ticket",onAction:()=>t(!0)}),n.jsx(wo,{items:r,renderItem:i=>n.jsx(Ju,{ticket:i},i.id),emptyMessage:"No support tickets found",limit:8}),e&&n.jsx(Ku,{isOpen:e,onClose:()=>t(!1)})]})}function mo({icon:e,label:t,value:r,color:a}){return n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-sm",children:t}),n.jsx("p",{className:"text-2xl font-semibold mt-1",children:r})]}),n.jsx("div",{className:`p-3 rounded-full ${a}`,children:n.jsx(e,{className:"h-6 w-6 text-white"})})]})})}function wp(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),{user:o}=yr();return W.useEffect(()=>{async function c(){if(o)try{a(!0),i(null);const d=o.role==="brand_user"?{organization_id:o.organization_id}:{},[{count:h},{count:g},{count:x},{count:y}]=await Promise.all([je.from("production_orders").select("*",{count:"exact",head:!0}).in("status",["pending","in_progress"]).match(o.role==="brand_user"?d:{}),je.from("tasks").select("*",{count:"exact",head:!0}).eq("status","pending").match(o.role==="brand_user"?{"production_order.organization_id":o.organization_id}:{}),je.from("products").select("*",{count:"exact",head:!0}).match(o.role==="brand_user"?d:{}),je.from("organizations").select("*",{count:"exact",head:!0}).eq("type","Customer Brand")]);t({activeOrders:h||0,pendingTasks:g||0,totalProducts:x||0,activeBrands:o.role==="brand_user"?1:y||0})}catch(d){i(d instanceof Error?d:new Error("Failed to fetch stats"))}finally{a(!1)}}c()},[o]),{data:e,isLoading:r,error:s}}function Np(){const{data:e,isLoading:t,error:r}=wp();return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx(mo,{icon:So,label:"Active Orders",value:e.activeOrders,color:"bg-blue-500"}),n.jsx(mo,{icon:_o,label:"Pending Tasks",value:e.pendingTasks,color:"bg-yellow-500"}),n.jsx(mo,{icon:rr,label:"Total Products",value:e.totalProducts,color:"bg-green-500"}),n.jsx(mo,{icon:hi,label:"Active Brands",value:e.activeBrands,color:"bg-purple-500"})]}):null}function jp(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null);return W.useEffect(()=>{if(!e){r(null),s(!1);return}let c=!0;async function d(){try{s(!0);const{data:h,error:g}=await je.from("organizations").select("*").eq("id",e).single();if(g)throw g;c&&r(h)}catch(h){console.error("Failed to load organization:",h),c&&o(h instanceof Error?h:new Error("Failed to load organization"))}finally{c&&s(!1)}}return d(),()=>{c=!1}},[e]),{organization:t,isLoading:a,error:i}}function Sp(){const{user:e}=yr(),{organization:t,isLoading:r}=jp(e==null?void 0:e.organization_id);return!(e!=null&&e.organization_id)||!(t!=null&&t.welcome_message)||r?null:n.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:n.jsx("div",{className:"prose prose-sm max-w-none text-gray-600",dangerouslySetInnerHTML:{__html:t.welcome_message}})})}function _p(){const{user:e}=yr(),t=(e==null?void 0:e.role)==="brand_user";return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[t&&n.jsx(Sp,{}),n.jsx(Np,{}),n.jsx(Lg,{}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsx(fp,{}),n.jsx(Eg,{})]}),n.jsx(bp,{})]})})}function kp(){const[e,t]=W.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Production Orders"}),n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Add Order"]})]}),e&&n.jsx(Hu,{isOpen:e,onClose:()=>t(!1)})]})}function Xu({value:e,onChange:t,className:r=""}){const{data:a,isLoading:s}=Aa(),{isLeumasStaff:i}=At();return i?s?n.jsx(dt,{}):a!=null&&a.length?n.jsxs("div",{className:r,children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand"}),n.jsxs("select",{value:e,onChange:o=>t(o.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Brands"}),a.map(o=>n.jsx("option",{value:o.name,children:o.name},o.id))]})]}):null:null}function Lp({selectedBrand:e,selectedStatus:t,selectedOrderType:r,showPriorityOnly:a,dueDate:s,poNumber:i,onBrandChange:o,onStatusChange:c,onOrderTypeChange:d,onPriorityFilterChange:h,onDueDateChange:g,onPoNumberChange:x}){return n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Number"}),n.jsx("input",{type:"text",placeholder:"Search PO number",value:i,onChange:y=>x(y.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsx(Xu,{value:e,onChange:o}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{value:t,onChange:y=>c(y.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Statuses"}),n.jsx("option",{value:"pending",children:"Pending"}),n.jsx("option",{value:"in_progress",children:"In Progress"}),n.jsx("option",{value:"completed",children:"Completed"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Type"}),n.jsxs("select",{value:r,onChange:y=>d(y.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Types"}),n.jsx("option",{value:"Project Plan",children:"Project Plan"}),n.jsx("option",{value:"Production Order",children:"Production Order"}),n.jsx("option",{value:"NPD Order",children:"NPD Order"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),n.jsx("input",{type:"date",value:s,onChange:y=>g(y.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsx("div",{className:"flex items-end",children:n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:a,onChange:y=>h(y.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"Priority Orders Only"]})})]})})}function Yl(){return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 animate-pulse",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"space-y-3 flex-1",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"h-5 w-32 bg-gray-200 rounded"}),n.jsx("div",{className:"h-5 w-48 bg-gray-200 rounded"})]}),n.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full"}),n.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full"})]})]}),n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsx("div",{className:"h-2 bg-gray-200 rounded"}),n.jsx("div",{className:"h-2 bg-gray-200 rounded w-3/4"})]})]})}function Ap({orders:e,isLoading:t,error:r,hasMore:a,loadMore:s}){const{regularOrders:i,splitGroups:o}=W.useMemo(()=>{if(!e)return{regularOrders:[],splitGroups:[]};const c=new Map,d=[];e.forEach(g=>{g.parent_order_id||(e.some(y=>y.parent_order_id===g.id)?c.set(g.id,[g]):d.push(g))}),e.forEach(g=>{g.parent_order_id&&c.has(g.parent_order_id)&&c.get(g.parent_order_id).push(g)});const h=Array.from(c.values()).map(g=>g.sort((x,y)=>x.po_number.localeCompare(y.po_number)));return{regularOrders:d,splitGroups:h}},[e]);return r?n.jsx(bt,{message:r.message}):!(e!=null&&e.length)&&!t?n.jsx("div",{className:"text-center py-12 text-gray-500",children:"No orders found matching your filters"}):n.jsxs("div",{className:"space-y-6",children:[i.map(c=>n.jsx(_c,{order:c},c.id)),o.map(c=>n.jsx(Uu,{orders:c},c[0].id)),t&&n.jsxs("div",{className:"space-y-6",children:[n.jsx(Yl,{}),n.jsx(Yl,{}),n.jsx(Yl,{})]}),a&&s&&n.jsx("div",{className:"text-center pt-4",children:n.jsx("button",{onClick:s,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 bg-white rounded-lg border border-gray-300 hover:border-gray-400 transition-colors",children:"Load More Orders"})})]})}function Pp(){const[e,t]=W.useState(""),[r,a]=W.useState(""),[s,i]=W.useState(""),[o,c]=W.useState(!1),[d,h]=W.useState(""),[g,x]=W.useState(""),{data:y,isLoading:m,error:v,hasMore:N,loadMore:L}=Ro(),w=y==null?void 0:y.filter(j=>{var S;return!(!j||e&&((S=j.organization)==null?void 0:S.name)!==e||r&&j.status!==r.toLowerCase()||s&&j.order_type!==s||o&&!j.is_priority||d&&j.due_date!==d||g&&!j.po_number.toLowerCase().includes(g.toLowerCase()))});return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx(kp,{}),n.jsx(Lp,{selectedBrand:e,selectedStatus:r,selectedOrderType:s,showPriorityOnly:o,dueDate:d,poNumber:g,onBrandChange:t,onStatusChange:a,onOrderTypeChange:i,onPriorityFilterChange:c,onDueDateChange:h,onPoNumberChange:x}),n.jsx(Ap,{orders:w,isLoading:m,error:v,hasMore:N,loadMore:L})]})})}function Cp(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Tasks"}),s&&n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Add Task"]})]}),e&&n.jsx(Yu,{isOpen:e,onClose:()=>t(!1)})]})}async function Ep(e){try{const{data:t,error:r}=await je.from("users").select(`
        id,
        full_name,
        email,
        role,
        organization:organizations(
          id,
          name
        )
      `).eq("organization.name","Leumas").in("role",["admin","manager","staff"]).order("role",{ascending:!0}).order("full_name");if(r)throw r;let a=[];return[...t||[],...a]}catch(t){throw console.error("Error fetching available owners:",t),new Error("Failed to load available owners")}}function Fp(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null);return W.useEffect(()=>{async function c(){try{s(!0),o(null);const d=await Ep(e||null);r(d)}catch(d){console.error("Error loading users:",d),o(d instanceof Error?d:new Error("Failed to load users"))}finally{s(!1)}}c()},[e]),{users:t,isLoading:a,error:i}}function Ip({filters:e,onFilterChange:t}){const{users:r,isLoading:a}=Fp();return yr(),a?n.jsx(dt,{}):n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[n.jsx("div",{className:"flex flex-wrap gap-4 items-center mb-4",children:n.jsx("button",{onClick:()=>t("showMyTasks",!e.showMyTasks),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${e.showMyTasks?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"My Tasks"})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Number"}),n.jsx("input",{type:"text",placeholder:"Search PO number",value:e.poNumber,onChange:s=>t("poNumber",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{value:e.status,onChange:s=>t("status",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Statuses"}),n.jsx("option",{value:"pending",children:"Pending"}),n.jsx("option",{value:"pending_from_client",children:"Pending from Client"}),n.jsx("option",{value:"in_progress",children:"In Progress"}),n.jsx("option",{value:"completed",children:"Completed"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),n.jsx("input",{type:"date",value:e.dueDate,onChange:s=>t("dueDate",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),n.jsxs("select",{value:e.priority,onChange:s=>t("priority",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All"}),n.jsx("option",{value:"priority",children:"Priority Only"})]})]}),!e.showMyTasks&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner"}),n.jsxs("select",{value:e.owner,onChange:s=>t("owner",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Owners"}),n.jsx("option",{value:"unassigned",children:"Unassigned"}),r==null?void 0:r.map(s=>n.jsx("option",{value:s.id,children:s.full_name},s.id))]})]})]})]})}function Mp({tasks:e,isLoading:t,error:r}){return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e!=null&&e.length?n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.map(a=>n.jsx(Gu,{task:a},a.id))}):n.jsx(Tp,{})}function Tp(){return n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:"No tasks found matching your filters"})})}function Op(e){const{data:t,isLoading:r,error:a}=Vu();return{tasks:W.useMemo(()=>t?t.filter(i=>{var o;return!(e.poNumber&&!((o=i.production_order)!=null&&o.po_number.toLowerCase().includes(e.poNumber.toLowerCase()))||e.status&&i.status!==e.status.toLowerCase()||e.priority==="priority"&&!i.is_priority||e.dueDate&&i.due_date!==e.dueDate||e.owner&&(e.owner==="unassigned"&&i.owner_id!==null||e.owner!=="unassigned"&&i.owner_id!==e.owner))}):null,[t,e]),isLoading:r,error:a}}function Dp(){const{user:e}=yr(),[t,r]=W.useState({poNumber:"",dueDate:"",status:"",priority:"",owner:"",showMyTasks:!1}),{tasks:a,isLoading:s,error:i}=Op(t),o=(c,d)=>{r(c==="showMyTasks"?h=>({...h,showMyTasks:d,owner:d&&(e==null?void 0:e.id)||""}):h=>({...h,[c]:d}))};return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx(Cp,{}),n.jsx(Ip,{filters:t,onFilterChange:o}),n.jsx(Mp,{tasks:a,isLoading:s,error:i})]})})}function Bp(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return{deleteProduct:async o=>{if(!s)throw new Error("Insufficient permissions");t(!0);try{const{error:c}=await je.from("products").delete().eq("id",o);if(c)throw c}catch(c){throw console.error("Error deleting product:",c),c}finally{t(!1)}},isLoading:e,canDelete:s}}function Rp({productId:e,onDelete:t}){const{deleteProduct:r,isLoading:a,canDelete:s}=Bp();if(!s)return null;const i=async()=>{try{await r(e),t==null||t()}catch(o){console.error("Failed to delete product:",o)}};return n.jsx(Sc,{onDelete:i,isLoading:a,confirmMessage:"Are you sure you want to delete this product? This action cannot be undone."})}function qp({product:e,onUpdate:t}){var r;return n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("h3",{className:"font-medium truncate",children:e.name}),n.jsxs("div",{className:"mt-1 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[n.jsx(hi,{className:"h-4 w-4"}),n.jsx("span",{children:(r=e.organization)==null?void 0:r.name})]}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Batch size: ",e.batch_size]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("p",{className:"text-indigo-600 font-medium whitespace-nowrap ml-4",children:["₹",e.price_inr]}),n.jsx(Rp,{productId:e.id,onDelete:t})]})]})})}function zp({products:e,isLoading:t,error:r}){return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e!=null&&e.length?n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(a=>n.jsx(qp,{product:a},a.id))}):n.jsx(Up,{})}function Up(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(rr,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No products"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new product."})]})}function Hp({selectedBrand:e,onBrandChange:t}){return n.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:n.jsx(Xu,{value:e,onChange:t,className:"w-full md:w-64"})})}function Wp(e){const{data:t,isLoading:r,error:a}=Bo();return{products:W.useMemo(()=>t?e?t.filter(i=>{var o;return((o=i.organization)==null?void 0:o.name)===e}):t:null,[t,e]),isLoading:r,error:a}}function Vp(){const[e,t]=W.useState(!1),[r,a]=W.useState(""),{isLeumasStaff:s}=At(),{products:i,isLoading:o,error:c}=Wp(r);return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Products"}),s&&n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Add Product"]})]}),n.jsx(Hp,{selectedBrand:r,onBrandChange:a}),n.jsx(zp,{products:i,isLoading:o,error:c}),e&&n.jsx(Wu,{isOpen:e,onClose:()=>t(!1)})]})})}function Ac(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null),o=async()=>{try{a(!0),i(null);const{data:c,error:d}=await je.from("users").select(`
          id,
          email,
          full_name,
          role,
          organization:organizations(
            id,
            name
          )
        `).order("role").order("full_name");if(d)throw d;t(c)}catch(c){console.error("Failed to load users:",c),i(c instanceof Error?c:new Error("Failed to load users"))}finally{a(!1)}};return W.useEffect(()=>{o()},[]),{data:e,isLoading:r,error:s,refetch:o}}function Gp(){const[e,t]=W.useState(!1);return{deleteUser:async a=>{t(!0);try{await Hf(a)}finally{t(!1)}},isLoading:e}}const Yp={admin:"bg-red-100 text-red-800",manager:"bg-blue-100 text-blue-800",staff:"bg-green-100 text-green-800",brand_user:"bg-purple-100 text-purple-800"};function $p({user:e,onDelete:t}){var i;const{deleteUser:r,isLoading:a}=Gp(),s=async()=>{if(window.confirm("Are you sure you want to delete this user?"))try{await r(e.id),t==null||t()}catch(o){console.error("Error deleting user:",o)}};return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.full_name})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-500",children:e.email})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Yp[e.role]}`,children:e.role.replace("_"," ")})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(i=e.organization)==null?void 0:i.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{className:"text-indigo-600 hover:text-indigo-900",title:"Edit user",children:n.jsx(xs,{className:"h-4 w-4"})}),n.jsx("button",{onClick:s,disabled:a,className:"text-red-600 hover:text-red-900 disabled:opacity-50",title:"Delete user",children:n.jsx(ys,{className:"h-4 w-4"})})]})})]})}function Jp(){const{data:e,isLoading:t,error:r,refetch:a}=Ac();return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e!=null&&e.length?n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organization"}),n.jsx("th",{scope:"col",className:"relative px-6 py-3",children:n.jsx("span",{className:"sr-only",children:"Actions"})})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(s=>n.jsx($p,{user:s,onDelete:a},s.id))})]})})}):n.jsx("div",{className:"text-center py-12 text-gray-500",children:"No users found"})}function Kp({formData:e,onChange:t,organizations:r,isLoading:a}){return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),n.jsx("input",{type:"text",required:!0,value:e.full_name,onChange:s=>t({full_name:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),n.jsx("input",{type:"email",required:!0,value:e.email,onChange:s=>t({email:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),n.jsx("input",{type:"password",required:!0,minLength:6,value:e.password,onChange:s=>t({password:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),n.jsxs("select",{required:!0,value:e.role,onChange:s=>t({role:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a,children:[n.jsx("option",{value:"staff",children:"Staff"}),n.jsx("option",{value:"manager",children:"Manager"}),n.jsx("option",{value:"brand_user",children:"Brand User"}),n.jsx("option",{value:"admin",children:"Admin"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization"}),n.jsxs("select",{required:!0,value:e.organization_id,onChange:s=>t({organization_id:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a,children:[n.jsx("option",{value:"",children:"Select Organization"}),r==null?void 0:r.map(s=>n.jsx("option",{value:s.id,children:s.name},s.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department"}),n.jsx("input",{type:"text",value:e.department||"",onChange:s=>t({department:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:a})]})]})}function Xp({isOpen:e,onClose:t,onSuccess:r}){const{data:a,isLoading:s}=Aa(),{create:i,isLoading:o,error:c}=Xd(),[d,h]=W.useState({email:"",password:"",full_name:"",role:"staff",organization_id:"",department:""}),g=async x=>{x.preventDefault();try{await i(d),r==null||r(),t()}catch{}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add New User"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),c&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:c.message}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsx(Kp,{formData:d,onChange:x=>h({...d,...x}),organizations:a,isLoading:o||s}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:o?"Creating...":"Create User"})]})]})]})}):null}function Qp(){const[e,t]=W.useState(!1);return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Users"}),n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Df,{className:"h-5 w-5"}),"Add User"]})]}),n.jsx(Jp,{}),e&&n.jsx(Xp,{isOpen:e,onClose:()=>t(!1)})]})})}function Zp(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{const{data:c,error:d}=await je.from("organizations").select("*").eq("type","Customer Brand").order("name");if(d)throw d;t(c)}catch(c){i(c instanceof Error?c:new Error("Error loading brands"))}finally{a(!1)}}o()},[]),{data:e,isLoading:r,error:s}}async function e2(e){const{data:t,error:r}=await je.from("organizations").insert(e).select().single();if(r)throw r;if(!t)throw new Error("Failed to create brand");return t}async function t2(e,t){const{data:r,error:a}=await je.from("organizations").update(t).eq("id",e).select().single();if(a)throw a;if(!r)throw new Error("Failed to update brand");return r}function r2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{update:async(i,o)=>{t(!0),a(null);try{return await t2(i,o)}catch(c){throw a(c instanceof Error?c:new Error("Failed to update brand")),c}finally{t(!1)}},isLoading:e,error:r}}function n2({content:e,onChange:t,disabled:r}){const a=qd({extensions:[Ud],content:e,editable:!r,onUpdate:({editor:s})=>{t(s.getHTML())},editorProps:{attributes:{class:"prose max-w-none min-h-[200px] focus:outline-none p-4"}}});return a?n.jsxs("div",{className:"border rounded-md overflow-hidden bg-white",children:[n.jsxs("div",{className:"bg-gray-50 border-b p-2 flex gap-2",children:[n.jsx("button",{type:"button",onClick:()=>a.chain().focus().toggleBold().run(),disabled:r||!a.can().chain().focus().toggleBold().run(),className:`p-2 rounded transition-colors ${a.isActive("bold")?"bg-gray-200":"hover:bg-gray-100"} ${r?"opacity-50 cursor-not-allowed":""}`,children:n.jsx(Gd,{className:"h-5 w-5"})}),n.jsx("button",{type:"button",onClick:()=>a.chain().focus().toggleItalic().run(),disabled:r||!a.can().chain().focus().toggleItalic().run(),className:`p-2 rounded transition-colors ${a.isActive("italic")?"bg-gray-200":"hover:bg-gray-100"} ${r?"opacity-50 cursor-not-allowed":""}`,children:n.jsx($d,{className:"h-5 w-5"})}),n.jsx("button",{type:"button",onClick:()=>a.chain().focus().toggleBulletList().run(),disabled:r||!a.can().chain().focus().toggleBulletList().run(),className:`p-2 rounded transition-colors ${a.isActive("bulletList")?"bg-gray-200":"hover:bg-gray-100"} ${r?"opacity-50 cursor-not-allowed":""}`,children:n.jsx(Jd,{className:"h-5 w-5"})})]}),n.jsx(zd,{editor:a})]}):null}function a2({brand:e,isOpen:t,onClose:r,onUpdate:a}){const{update:s,isLoading:i,error:o}=r2(),[c,d]=W.useState({name:e.name,contact_person:e.contact_person||"",email:e.email||"",phone:e.phone||"",address:e.address||"",notes:e.notes||"",welcome_message:e.welcome_message||""}),h=async g=>{g.preventDefault();try{await s(e.id,c),a==null||a(),r()}catch{}};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Brand Details"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),o&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:o.message}),n.jsxs("form",{onSubmit:h,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand Name"}),n.jsx("input",{type:"text",required:!0,value:c.name,onChange:g=>d({...c,name:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Person"}),n.jsx("input",{type:"text",value:c.contact_person,onChange:g=>d({...c,contact_person:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),n.jsx("input",{type:"email",value:c.email,onChange:g=>d({...c,email:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),n.jsx("input",{type:"tel",value:c.phone,onChange:g=>d({...c,phone:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),n.jsx("textarea",{rows:3,value:c.address,onChange:g=>d({...c,address:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),n.jsx(n2,{content:c.welcome_message||"",onChange:g=>d({...c,welcome_message:g}),disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),n.jsx("textarea",{rows:3,value:c.notes,onChange:g=>d({...c,notes:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:i?"Saving...":"Save Changes"})]})]})]})}):null}function s2({brand:e,onUpdate:t}){const[r,a]=W.useState(!1),{isAdmin:s,isManager:i}=At(),o=s||i;return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:n.jsx(hi,{className:"h-6 w-6 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Added ",_r(e.created_at)]})]})]}),o&&n.jsx("button",{onClick:()=>a(!0),className:"p-2 text-gray-400 hover:text-gray-600",children:n.jsx(xs,{className:"h-5 w-5"})})]}),n.jsxs("div",{className:"mt-4 space-y-2",children:[e.contact_person&&n.jsxs("p",{className:"text-sm text-gray-600",children:["Contact: ",e.contact_person]}),e.welcome_message&&n.jsxs("div",{className:"mt-3 flex items-start gap-2",children:[n.jsx(Kd,{className:"h-5 w-5 text-indigo-500 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-gray-700",children:[n.jsx("div",{className:"font-medium mb-1",children:"Welcome Message:"}),n.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.welcome_message}})]})]})]})]}),r&&n.jsx(a2,{brand:e,isOpen:r,onClose:()=>a(!1),onUpdate:t})]})}function i2(){const{data:e,isLoading:t,error:r,refetch:a}=Zp();return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e!=null&&e.length?n.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.map(s=>n.jsx(s2,{brand:s,onUpdate:a},s.id))}):n.jsx(o2,{})}function o2(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(hi,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No brands"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No customer brands found."})]})}function l2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{create:async i=>{t(!0),a(null);try{return await e2(i)}catch(o){throw a(o instanceof Error?o:new Error("Failed to create brand")),o}finally{t(!1)}},isLoading:e,error:r}}function c2({isOpen:e,onClose:t,onSuccess:r}){const{create:a,isLoading:s,error:i}=l2(),[o,c]=W.useState({name:"",type:"Customer Brand"}),d=async h=>{h.preventDefault();try{await a(o),r==null||r(),t()}catch{}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add New Brand"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand Name"}),n.jsx("input",{type:"text",required:!0,value:o.name,onChange:h=>c({...o,name:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:s})]}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Creating...":"Create Brand"})]})]})]})}):null}function d2(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Customer Brands"}),s&&n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Add Brand"]})]}),n.jsx(i2,{}),e&&n.jsx(c2,{isOpen:e,onClose:()=>t(!1)})]})})}function u2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{deleteTemplate:async i=>{t(!0),a(null);try{const{error:o}=await je.from("task_templates").delete().eq("id",i);if(o)throw o}catch(o){const c=o instanceof Error?o:new Error("Failed to delete template");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}function h2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{update:async(i,o)=>{t(!0),a(null);try{const{error:c}=await je.from("task_templates").update({name:o.name,description:o.description}).eq("id",i);if(c)throw c;const{error:d}=await je.from("task_template_items").delete().eq("template_id",i);if(d)throw d;const{error:h}=await je.from("task_template_items").insert(o.items.map((g,x)=>({template_id:i,name:g.name,duration_days:g.duration_days,details_template:g.details_template,order_index:x+1,todos:g.todos||[]})));if(h)throw h}catch(c){const d=c instanceof Error?c:new Error("Failed to update template");throw a(d),d}finally{t(!1)}},isLoading:e,error:r}}function f2({todo:e,onUpdate:t,onRemove:r,disabled:a}){return n.jsxs("div",{className:"flex gap-2 items-start bg-gray-50 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsx("input",{type:"text",value:e.description,onChange:s=>t({description:s.target.value}),placeholder:"Subtask description",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",disabled:a}),n.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx("input",{type:"checkbox",checked:e.is_private,onChange:s=>t({is_private:s.target.checked}),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",disabled:a}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(gc,{className:"h-3 w-3"}),"Private (only visible to Leumas staff)"]})]})]}),n.jsx("button",{type:"button",onClick:r,disabled:a,className:"text-red-600 hover:text-red-700 disabled:opacity-50 p-1",title:"Remove subtask",children:n.jsx(ko,{className:"h-5 w-5"})})]})}function m2(e,t){const[r,a]=W.useState(e.todos||[]),s=W.useCallback(()=>{const c={description:"",is_private:!1},d=[...r,c];a(d),t({todos:d})},[r,t]),i=W.useCallback(c=>{const d=r.filter((h,g)=>g!==c);a(d),t({todos:d})},[r,t]),o=W.useCallback((c,d)=>{const h=r.map((g,x)=>x===c?{...g,...d}:g);a(h),t({todos:h})},[r,t]);return{todos:r,addTodo:s,removeTodo:i,updateTodo:o}}function g2({item:e,onChange:t,disabled:r}){const{todos:a,addTodo:s,removeTodo:i,updateTodo:o}=m2(e,t);return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subtasks"}),n.jsx("button",{type:"button",onClick:s,disabled:r,className:"text-indigo-600 hover:text-indigo-700 disabled:opacity-50 p-1",title:"Add subtask",children:n.jsx(Qt,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"space-y-2",children:a.map((c,d)=>n.jsx(f2,{todo:c,onUpdate:h=>o(d,h),onRemove:()=>i(d),disabled:r},d))})]})}function Qu({item:e,onChange:t,disabled:r}){return n.jsxs("div",{className:"flex-1 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Task Name"}),n.jsx("input",{type:"text",required:!0,value:e.name,onChange:a=>t({name:a.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duration (days)"}),n.jsx("input",{type:"number",required:!0,min:"1",value:e.duration_days,onChange:a=>t({duration_days:Math.max(1,parseInt(a.target.value)||1)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Details Template"}),n.jsx("textarea",{value:e.details_template||"",onChange:a=>t({details_template:a.target.value}),rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:r,placeholder:"Optional template for task details"})]}),n.jsx(g2,{item:e,onChange:t,disabled:r})]})}function p2({template:e,isOpen:t,onClose:r,onSuccess:a}){const{getTemplateItems:s}=Lc(),{update:i,isLoading:o,error:c}=h2(),[d,h]=W.useState({name:e.name,description:e.description||"",items:[]});W.useEffect(()=>{s(e.id).then(v=>h(N=>({...N,items:v}))).catch(console.error)},[e.id,s]);const g=()=>{h(v=>({...v,items:[...v.items,{id:`new-${v.items.length}`,template_id:e.id,name:"",duration_days:1,order_index:v.items.length+1,details_template:"",created_at:new Date().toISOString()}]}))},x=v=>{h(N=>({...N,items:N.items.filter((L,w)=>w!==v)}))},y=(v,N)=>{h(L=>({...L,items:L.items.map((w,j)=>j===v?{...w,...N}:w)}))},m=async v=>{v.preventDefault();try{await i(e.id,d),a==null||a(),r()}catch{}};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Edit Task Template"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),c&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:c.message}),n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Template Name"}),n.jsx("input",{type:"text",required:!0,value:d.name,onChange:v=>h({...d,name:v.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:o})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),n.jsx("textarea",{value:d.description,onChange:v=>h({...d,description:v.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:o})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Template Tasks"}),n.jsx("button",{type:"button",onClick:g,disabled:o,className:"text-indigo-600 hover:text-indigo-700 disabled:opacity-50",children:n.jsx(Qt,{className:"h-5 w-5"})})]}),d.items.map((v,N)=>n.jsxs("div",{className:"flex gap-4 items-start",children:[n.jsx(Qu,{item:v,onChange:L=>y(N,L),disabled:o}),d.items.length>1&&n.jsx("button",{type:"button",onClick:()=>x(N),disabled:o,className:"mt-8 text-red-600 hover:text-red-700 disabled:opacity-50",children:n.jsx(ko,{className:"h-5 w-5"})})]},v.id))]}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:o?"Saving...":"Save Changes"})]})]})]})}):null}function x2({template:e,items:t,onDelete:r}){const[a,s]=W.useState(!1),[i,o]=W.useState(!1),{isAdmin:c,isManager:d}=At(),{data:h}=Ac(),{deleteTemplate:g,isLoading:x}=u2(),y=c||d,m=async()=>{if(window.confirm("Are you sure you want to delete this template?"))try{await g(e.id),r==null||r()}catch(N){console.error("Error deleting template:",N)}},v=N=>{var L;return N?((L=h==null?void 0:h.find(w=>w.id===N))==null?void 0:L.full_name)||"Unknown":"Unassigned"};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),e.description&&n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:e.description})]}),y&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>s(!0),className:"text-gray-400 hover:text-gray-600",disabled:x,children:n.jsx(xs,{className:"h-5 w-5"})}),n.jsx("button",{onClick:m,disabled:x,className:"text-gray-400 hover:text-red-600 disabled:opacity-50",children:n.jsx(ys,{className:"h-5 w-5"})})]})]}),n.jsxs("button",{onClick:()=>o(!i),className:"mt-4 flex items-center gap-2 text-sm text-gray-500 hover:text-gray-700",children:[i?n.jsx(mi,{className:"h-4 w-4"}):n.jsx(fi,{className:"h-4 w-4"}),(t==null?void 0:t.length)||0," tasks"]}),i&&t&&n.jsx("div",{className:"mt-4 space-y-3",children:t.map((N,L)=>n.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-gray-50 rounded",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-gray-400",children:[L+1,"."]}),n.jsx("span",{className:"font-medium",children:N.name}),n.jsxs("span",{className:"text-gray-500",children:["(",N.duration_days," days)"]})]}),n.jsx("span",{className:"text-gray-500",children:v(N.owner_id)})]},N.id))})]}),a&&n.jsx(p2,{template:e,isOpen:a,onClose:()=>s(!1),onSuccess:r})]})}function y2(){const{templates:e,getTemplateItems:t,isLoading:r,error:a,refetch:s}=Lc(),[i,o]=ta.useState({});return ta.useEffect(()=>{e&&e.forEach(c=>{t(c.id).then(d=>{o(h=>({...h,[c.id]:d||[]}))}).catch(console.error)})},[e,t]),r?n.jsx(dt,{}):a?n.jsx(bt,{message:a.message}):e!=null&&e.length?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(c=>n.jsx(x2,{template:c,items:i[c.id]||[],onDelete:s},c.id))}):n.jsx(v2,{})}function v2(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(So,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No templates"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new template."})]})}function b2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{create:async i=>{t(!0),a(null);try{const{data:o,error:c}=await je.from("task_templates").insert({name:i.name,description:i.description}).select().single();if(c)throw c;if(!o)throw new Error("Failed to create template");const{error:d}=await je.from("task_template_items").insert(i.items.map((h,g)=>({template_id:o.id,name:h.name,duration_days:h.duration_days,details_template:h.details_template,order_index:g+1,todos:h.todos||[]})));if(d)throw d}catch(o){const c=o instanceof Error?o:new Error("Failed to create template");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}function w2({isOpen:e,onClose:t,onSuccess:r}){const{create:a,isLoading:s,error:i}=b2(),[o,c]=W.useState({name:"",description:"",items:[{id:"new-0",template_id:"",name:"",duration_days:1,order_index:1,todos:[],created_at:new Date().toISOString()}]}),d=()=>{c(y=>({...y,items:[...y.items,{id:`new-${y.items.length}`,template_id:"",name:"",duration_days:1,order_index:y.items.length+1,todos:[],created_at:new Date().toISOString()}]}))},h=y=>{c(m=>({...m,items:m.items.filter((v,N)=>N!==y)}))},g=(y,m)=>{c(v=>({...v,items:v.items.map((N,L)=>L===y?{...N,...m}:N)}))},x=async y=>{y.preventDefault();try{await a(o),r==null||r(),t()}catch{}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add Task Template"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Template Name"}),n.jsx("input",{type:"text",required:!0,value:o.name,onChange:y=>c({...o,name:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:s})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),n.jsx("textarea",{value:o.description,onChange:y=>c({...o,description:y.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:s})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Template Tasks"}),n.jsx("button",{type:"button",onClick:d,disabled:s,className:"text-indigo-600 hover:text-indigo-700 disabled:opacity-50",children:n.jsx(Qt,{className:"h-5 w-5"})})]}),o.items.map((y,m)=>n.jsxs("div",{className:"flex gap-4 items-start",children:[n.jsx(Qu,{item:y,onChange:v=>g(m,v),disabled:s}),o.items.length>1&&n.jsx("button",{type:"button",onClick:()=>h(m),disabled:s,className:"mt-8 text-red-600 hover:text-red-700 disabled:opacity-50",children:n.jsx(ko,{className:"h-5 w-5"})})]},y.id))]}),n.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Creating...":"Create Template"})]})]})]})}):null}function N2(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Task Templates"}),s&&n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Add Template"]})]}),n.jsx(y2,{}),e&&n.jsx(w2,{isOpen:e,onClose:()=>t(!1)})]})})}function j2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{updateStatus:async(o,c)=>{t(!0),a(null);try{const{error:d}=await je.from("tickets").update({status:c,updated_at:new Date().toISOString()}).eq("id",o);if(d)throw d}catch(d){const h=d instanceof Error?d:new Error("Failed to update ticket status");throw a(h),h}finally{t(!1)}},updateAssignment:async(o,c)=>{t(!0),a(null);try{const{error:d}=await je.from("tickets").update({assigned_to:c,updated_at:new Date().toISOString()}).eq("id",o);if(d)throw d}catch(d){const h=d instanceof Error?d:new Error("Failed to update ticket assignment");throw a(h),h}finally{t(!1)}},isLoading:e,error:r}}function S2(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null);W.useEffect(()=>{c()},[e]);const c=async()=>{try{const{data:h,error:g}=await je.from("ticket_comments").select(`
          *,
          user:users(id, full_name, email)
        `).eq("ticket_id",e).order("created_at",{ascending:!0});if(g)throw g;r(h)}catch(h){o(h instanceof Error?h:new Error("Error loading comments"))}finally{s(!1)}};return{comments:t,isLoading:a,error:i,addComment:async(h,g=[])=>{var x;try{const{error:y}=await je.from("ticket_comments").insert({ticket_id:e,content:h,attachments:g,user_id:(x=(await je.auth.getUser()).data.user)==null?void 0:x.id});if(y)throw y;await c()}catch(y){throw y instanceof Error?y:new Error("Failed to add comment")}},refresh:c}}function _2({comments:e,isLoading:t}){return t?n.jsx("div",{className:"text-center py-4",children:"Loading comments..."}):e!=null&&e.length?n.jsx("div",{className:"space-y-4",children:e.map(r=>{var a;return n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center",children:n.jsx(ra,{className:"h-4 w-4 text-indigo-600"})})}),n.jsxs("div",{className:"flex-1 space-y-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-medium",children:r.user.full_name}),n.jsx("span",{className:"text-xs text-gray-500",children:_r(r.created_at)})]}),n.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:r.content}),((a=r.attachments)==null?void 0:a.length)>0&&n.jsx("div",{className:"mt-2 space-y-1",children:r.attachments.map(s=>n.jsx("a",{href:s.path,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:s.name},s.path))})]})]},r.id)})}):n.jsx("div",{className:"text-center py-4 text-gray-500",children:"No comments yet"})}function k2({ticket:e,isOpen:t,onClose:r,onUpdate:a}){var M,G;const{updateStatus:s,updateAssignment:i,isLoading:o}=j2(),{data:c}=Ac(),[d,h]=W.useState(""),[g,x]=W.useState([]),{comments:y,addComment:m,isLoading:v}=S2(e.id),[N,L]=W.useState(e.status),[w,j]=W.useState(((M=e.assigned_to)==null?void 0:M.id)||""),S=N!==e.status,I=w!==(((G=e.assigned_to)==null?void 0:G.id)||""),R=async()=>{try{await s(e.id,N),a==null||a()}catch(J){console.error("Error updating ticket status:",J),L(e.status)}},K=async()=>{var J;try{await i(e.id,w||null),a==null||a()}catch(A){console.error("Error assigning ticket:",A),j(((J=e.assigned_to)==null?void 0:J.id)||"")}},O=async J=>{if(J.preventDefault(),!!d.trim())try{await m(d,g),h(""),x([])}catch(A){console.error("Error adding comment:",A)}};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:e.title}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("select",{value:N,onChange:J=>L(J.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"open",children:"Open"}),n.jsx("option",{value:"in_progress",children:"In Progress"}),n.jsx("option",{value:"resolved",children:"Resolved"}),n.jsx("option",{value:"closed",children:"Closed"})]}),S&&n.jsx("button",{onClick:R,disabled:o,className:"px-3 py-1 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700 disabled:opacity-50",children:"Save"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("select",{value:w,onChange:J=>j(J.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"Unassigned"}),c==null?void 0:c.filter(J=>["admin","manager","staff"].includes(J.role)).map(J=>n.jsx("option",{value:J.id,children:J.full_name},J.id))]}),I&&n.jsx("button",{onClick:K,disabled:o,className:"px-3 py-1 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700 disabled:opacity-50",children:"Save"})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),n.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:e.description})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-4",children:"Comments"}),n.jsx(_2,{comments:y,isLoading:v}),n.jsxs("form",{onSubmit:O,className:"mt-4 space-y-4",children:[n.jsx("textarea",{value:d,onChange:J=>h(J.target.value),placeholder:"Add a comment...",rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),n.jsx(Po,{files:g,onChange:x,disabled:o}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:!d.trim()||o,className:"px-4 py-2 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700 disabled:opacity-50",children:"Add Comment"})})]})]})]})]})}):null}function L2({filters:e,onChange:t}){const{data:r}=Aa(),{isAdmin:a,isManager:s,isStaff:i}=At(),o=a||s||i;return n.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 space-y-4",children:n.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-${o?"4":"3"} gap-4`,children:[o&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Brand"}),n.jsxs("select",{value:e.organization,onChange:c=>t("organization",c.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Brands"}),r==null?void 0:r.map(c=>n.jsx("option",{value:c.id,children:c.name},c.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{value:e.status,onChange:c=>t("status",c.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Statuses"}),n.jsx("option",{value:"open",children:"Open"}),n.jsx("option",{value:"in_progress",children:"In Progress"}),n.jsx("option",{value:"resolved",children:"Resolved"}),n.jsx("option",{value:"closed",children:"Closed"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),n.jsx("input",{type:"date",value:e.dateFrom,onChange:c=>t("dateFrom",c.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),n.jsx("input",{type:"date",value:e.dateTo,onChange:c=>t("dateTo",c.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]})})}function A2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null),{data:s,isLoading:i,error:o,refetch:c}=$u(),[d,h]=W.useState({organization:"",status:"",dateFrom:"",dateTo:""}),g=(y,m)=>{h(v=>({...v,[y]:m}))},x=s==null?void 0:s.filter(y=>{if(d.organization&&y.organization_id!==d.organization||d.status&&y.status!==d.status)return!1;const m=new Date(y.created_at);if(d.dateFrom){const v=new Date(d.dateFrom);if(m<v)return!1}if(d.dateTo){const v=new Date(d.dateTo);if(v.setHours(23,59,59),m>v)return!1}return!0});return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Service Requests"}),n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Raise Request"]})]}),n.jsx(L2,{filters:d,onChange:g}),o&&n.jsx(bt,{message:o.message}),i&&n.jsx(dt,{}),x&&n.jsx("div",{className:"grid grid-cols-1 gap-6",children:x.length>0?x.map(y=>n.jsx(Ju,{ticket:y,onClick:()=>a(y)},y.id)):n.jsx("div",{className:"text-center py-12 text-gray-500",children:"No service requests found matching your filters"})}),e&&n.jsx(Ku,{isOpen:e,onClose:()=>t(!1),onSuccess:c}),r&&n.jsx(k2,{ticket:r,isOpen:!0,onClose:()=>a(null),onUpdate:c})]})})}function P2(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{const c=new Date;c.setHours(0,0,0,0);const{count:d}=await je.from("materials").select("*",{count:"exact",head:!0}),{count:h}=await je.from("inventory_movements").select("*",{count:"exact",head:!0}).gte("moved_at",c.toISOString()),{count:g}=await je.from("material_orders").select("*",{count:"exact",head:!0}).in("status",["pending","ordered"]),{count:x}=await je.from("materials").select("*",{count:"exact",head:!0});t({totalMaterials:d||0,todayMovements:h||0,pendingOrders:g||0,lowStockItems:x||0})}catch(c){i(c instanceof Error?c:new Error("Error loading inventory stats"))}finally{a(!1)}}o()},[]),{data:e,isLoading:r,error:s}}function go({icon:e,label:t,value:r,color:a}){return n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-sm",children:t}),n.jsx("p",{className:"text-2xl font-semibold mt-1",children:r})]}),n.jsx("div",{className:`p-3 rounded-full ${a}`,children:n.jsx(e,{className:"h-6 w-6 text-white"})})]})})}function C2(){const{data:e,isLoading:t,error:r}=P2();return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx(go,{icon:rr,label:"Total Materials",value:e.totalMaterials,color:"bg-blue-500"}),n.jsx(go,{icon:jo,label:"Today's Movements",value:e.todayMovements,color:"bg-green-500"}),n.jsx(go,{icon:Lo,label:"Pending Orders",value:e.pendingOrders,color:"bg-yellow-500"}),n.jsx(go,{icon:ff,label:"Low Stock Items",value:e.lowStockItems,color:"bg-red-500"})]}):null}function Zu(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{const{data:c,error:d}=await je.from("materials").select("*");if(d)throw d;const h=await Promise.all(c.map(async g=>{const{data:x}=await je.rpc("get_current_inventory",{p_material_id:g.id,p_section:"inward"}),{data:y}=await je.rpc("get_current_inventory",{p_material_id:g.id,p_section:"brand"}),{data:m}=await je.rpc("get_current_inventory",{p_material_id:g.id,p_section:"production"});return{material_id:g.id,material:g,inward:x||0,brand:y||0,production:m||0,total:(x||0)+(y||0)+(m||0)}}));t(h)}catch(c){i(c instanceof Error?c:new Error("Error loading inventory"))}finally{a(!1)}}o()},[]),{data:e,isLoading:r,error:s}}const Xt={gram:"Gram",kilogram:"Kilogram",unit:"Unit",millilitre:"Millilitre",litre:"Litre"},Ca={RM:"Raw Material",PM:"Packaging Material",FG:"Finished Goods"},La={inward:"Inward Store",brand:"Customer Brand Section",production:"Production Floor",fg_store:"FG Store"},Pc={pending:"Pending",ordered:"Ordered",dispatched:"Dispatched",received:"Received"};function E2(){const{data:e,isLoading:t,error:r}=Zu();return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):e!=null&&e.length?n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Inventory Levels"}),n.jsx("div",{className:"overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),Object.values(La).map(a=>n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a},a)),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(a=>{var s,i;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(rr,{className:"h-5 w-5 text-gray-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:(s=a.material)==null?void 0:s.name}),n.jsx("div",{className:"text-sm text-gray-500",children:Xt[((i=a.material)==null?void 0:i.unit_of_measurement)||"unit"]})]})]})}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:a.inward}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:a.brand}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:a.production}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.total})]},a.material_id)})})]})})]}):n.jsx(F2,{})}function F2(){return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Inventory Levels"}),n.jsxs("div",{className:"text-center py-8",children:[n.jsx(rr,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No inventory data"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start recording inventory movements to see levels."})]})]})}function eh(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{const{data:c,error:d}=await je.from("inventory_movements").select(`
            *,
            material:materials(*),
            moved_by_user:users(*)
          `).order("moved_at",{ascending:!1});if(d)throw d;t(c)}catch(c){i(c instanceof Error?c:new Error("Error loading movements"))}finally{a(!1)}}o()},[]),{data:e,isLoading:r,error:s}}function th({movement:e}){var t,r,a;return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:n.jsx(rr,{className:"h-6 w-6 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900",children:(t=e.material)==null?void 0:t.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[e.quantity," ",Xt[((r=e.material)==null?void 0:r.unit_of_measurement)||"unit"]]})]})]}),n.jsx("div",{className:"text-sm text-gray-500",children:_r(e.moved_at)})]}),n.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"text-gray-500",children:"From"}),n.jsx("p",{className:"font-medium",children:e.from_section?La[e.from_section]:"External"})]}),n.jsx(mf,{className:"h-4 w-4 text-gray-400"}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"text-gray-500",children:"To"}),n.jsx("p",{className:"font-medium",children:La[e.to_section]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(ra,{className:"h-4 w-4"}),n.jsx("span",{children:(a=e.moved_by_user)==null?void 0:a.full_name})]})]}),e.notes&&n.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[n.jsx("p",{className:"font-medium",children:"Notes:"}),n.jsx("p",{children:e.notes})]}),e.production_order_id&&n.jsxs("div",{className:"mt-4 text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Production Order:"})," ",n.jsxs("span",{className:"font-medium",children:["PO-",e.production_order_id]})]})]})}function I2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{createMovement:async i=>{var o;t(!0),a(null);try{const{error:c}=await je.from("inventory_movements").insert({material_id:i.material_id,quantity:i.quantity,from_section:i.from_section||null,to_section:i.to_section,notes:i.notes,moved_by:(o=(await je.auth.getUser()).data.user)==null?void 0:o.id});if(c)throw c}catch(c){const d=c instanceof Error?c:new Error("Failed to create movement");throw a(d),d}finally{t(!1)}},isLoading:e,error:r}}function qo(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{const{data:c,error:d}=await je.from("materials").select("*").order("name");if(d)throw d;t(c)}catch(c){i(c instanceof Error?c:new Error("Error loading materials"))}finally{a(!1)}}o()},[]),{data:e,isLoading:r,error:s}}function M2({isOpen:e,onClose:t,onSuccess:r}){const{createMovement:a,isLoading:s,error:i}=I2(),{data:o,isLoading:c}=qo(),[d,h]=W.useState({material_id:"",quantity:0,from_section:"",to_section:"",notes:""}),g=async y=>{y.preventDefault();try{await a(d),r==null||r(),t()}catch(m){console.error("Failed to create movement:",m)}};if(!e)return null;const x=o==null?void 0:o.find(y=>y.id===d.material_id);return n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Record Movement"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx(bt,{message:i.message}),c?n.jsx(dt,{}):n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Material"}),n.jsxs("select",{required:!0,value:d.material_id,onChange:y=>h({...d,material_id:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"Select Material"}),o==null?void 0:o.map(y=>n.jsxs("option",{value:y.id,children:[y.name," (",y.leumas_id,")"]},y.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Quantity (",x?Xt[x.unit_of_measurement]:"",")"]}),n.jsx("input",{type:"number",required:!0,min:"0",step:"0.001",value:d.quantity,onChange:y=>h({...d,quantity:parseFloat(y.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"From Section"}),n.jsxs("select",{value:d.from_section,onChange:y=>h({...d,from_section:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"External"}),Object.entries(La).map(([y,m])=>n.jsx("option",{value:y,children:m},y))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"To Section"}),n.jsxs("select",{required:!0,value:d.to_section,onChange:y=>h({...d,to_section:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"Select Section"}),Object.entries(La).map(([y,m])=>n.jsx("option",{value:y,children:m},y))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),n.jsx("textarea",{value:d.notes,onChange:y=>h({...d,notes:y.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Optional notes about this movement..."})]}),n.jsxs("div",{className:"flex justify-end gap-4",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Recording...":"Record Movement"})]})]})]})})}function T2(){const[e,t]=ta.useState(!1),{data:r,isLoading:a,error:s}=eh(),{isAdmin:i,isManager:o,isStaff:c}=At(),d=i||o||c,h=r==null?void 0:r.slice(0,5);return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Recent Movements"}),d&&n.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 text-sm text-indigo-600 hover:text-indigo-700",children:[n.jsx(Qt,{className:"h-4 w-4"}),"Record Movement"]})]}),a&&n.jsx(dt,{}),s&&n.jsx(bt,{message:s.message}),h!=null&&h.length?n.jsx("div",{className:"space-y-4",children:h.map(g=>n.jsx(th,{movement:g},g.id))}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(jo,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No recent movements"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Record inventory movements to track material flow."})]}),e&&n.jsx(M2,{isOpen:e,onClose:()=>t(!1)})]})}function rh(){const[e,t]=W.useState(null),[r,a]=W.useState(!0),[s,i]=W.useState(null);return W.useEffect(()=>{async function o(){try{const{data:c,error:d}=await je.from("material_orders").select(`
            *,
            material:materials(*),
            production_order:production_orders!production_order_id(
              id,
              po_number,
              quantity,
              status,
              product:products(
                id,
                name
              )
            )
          `).order("created_at",{ascending:!1});if(d)throw d;t(c)}catch(c){i(c instanceof Error?c:new Error("Error loading orders"))}finally{a(!1)}}o()},[]),{data:e,isLoading:r,error:s}}function O2({productionOrder:e,isUnassigned:t}){var r;return n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t?n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Unassigned Orders"}):n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["PO: ",e==null?void 0:e.po_number]}),n.jsxs("p",{className:"text-sm text-gray-500",children:[(r=e==null?void 0:e.product)==null?void 0:r.name," (",e==null?void 0:e.quantity," units)"]})]}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${(e==null?void 0:e.status)==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e==null?void 0:e.status})]})})}function D2({orders:e}){return n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expected Arrival"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(t=>n.jsx(B2,{order:t},t.id))})]})})}function B2({order:e}){var t,r,a;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(rr,{className:"h-5 w-5 text-gray-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:(t=e.material)==null?void 0:t.name}),n.jsx("div",{className:"text-sm text-gray-500",children:(r=e.material)==null?void 0:r.leumas_id})]})]})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.quantity," ",Xt[((a=e.material)==null?void 0:a.unit_of_measurement)||"unit"]]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${e.status==="received"?"bg-green-100 text-green-800":e.status==="dispatched"?"bg-purple-100 text-purple-800":e.status==="ordered"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:Pc[e.status]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_r(e.order_date)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.dispatch_date?_r(e.dispatch_date):"-"})]})}function R2({orders:e,productionOrderId:t}){var r;return e.length?n.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[n.jsx(O2,{productionOrder:(r=e[0])==null?void 0:r.production_order,isUnassigned:!t}),n.jsx(D2,{orders:e})]}):null}function q2(){const{data:e,isLoading:t,error:r}=rh();if(t)return n.jsx(dt,{});if(r)return n.jsx(bt,{message:r.message});const a=e==null?void 0:e.filter(i=>["pending","ordered"].includes(i.status)),s=a==null?void 0:a.reduce((i,o)=>{const c=o.production_order_id||"unassigned";return i[c]||(i[c]=[]),i[c].push(o),i},{});return!s||Object.keys(s).length===0?n.jsx(z2,{}):n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Pending Orders"}),n.jsx("div",{className:"space-y-4",children:Object.entries(s).map(([i,o])=>o&&n.jsx(R2,{orders:o,productionOrderId:i==="unassigned"?null:i},i))})]})}function z2(){return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Pending Orders"}),n.jsxs("div",{className:"text-center py-8",children:[n.jsx(Lo,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No pending orders"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"All material orders have been fulfilled."})]})]})}function U2(){return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Inventory Dashboard"}),n.jsx(C2,{}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsx(E2,{}),n.jsx(q2,{})]}),n.jsx(T2,{})]})})}function H2({material:e,isOpen:t,onClose:r}){return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:e.name}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Leumas ID"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900",children:e.leumas_id})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900",children:Ca[e.category]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900",children:Xt[e.unit_of_measurement]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cost per unit"}),n.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["₹",e.cost_per_unit]})]})]}),e.make_description&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Make & Description"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:e.make_description})]}),e.vendor_details&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendor Details"}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-sm",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:e.vendor_details.name}),n.jsx("p",{className:"text-gray-600",children:e.vendor_details.contact})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:e.vendor_details.email}),n.jsx("p",{className:"text-gray-600",children:e.vendor_details.phone})]})]}),n.jsx("p",{className:"mt-2 text-gray-600",children:e.vendor_details.address})]})]}),e.acceptance_criteria&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Acceptance Criteria"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:e.acceptance_criteria})]})]})]})}):null}function W2({material:e}){const[t,r]=W.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:n.jsx(rr,{className:"h-6 w-6 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900",children:e.name}),n.jsx("p",{className:"text-sm text-gray-500",children:e.leumas_id})]})]}),n.jsx("button",{onClick:()=>r(!0),className:"p-2 text-gray-400 hover:text-gray-600",children:n.jsx(xs,{className:"h-5 w-5"})})]}),n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Category"}),n.jsx("span",{className:"font-medium",children:Ca[e.category]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Unit"}),n.jsx("span",{className:"font-medium",children:Xt[e.unit_of_measurement]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Cost per unit"}),n.jsxs("span",{className:"font-medium",children:["₹",e.cost_per_unit]})]})]})]}),t&&n.jsx(H2,{material:e,isOpen:t,onClose:()=>r(!1)})]})}function V2(){const{data:e,isLoading:t,error:r}=qo();if(t)return n.jsx(dt,{});if(r)return n.jsx(bt,{message:r.message});if(!(e!=null&&e.length))return n.jsx(G2,{});const a=e.reduce((s,i)=>{const o=i.category;return s[o]||(s[o]=[]),s[o].push(i),s},{});return n.jsx("div",{className:"space-y-8",children:Object.entries(Ca).map(([s,i])=>{var o;return n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:i}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(o=a[s])==null?void 0:o.map(c=>n.jsx(W2,{material:c},c.id))})]},s)})})}function G2(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(rr,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No materials"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding a new material."})]})}function Y2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{createMaterial:async i=>{t(!0),a(null);try{const{error:o}=await je.from("materials").insert(i);if(o)throw o}catch(o){const c=o instanceof Error?o:new Error("Failed to create material");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}function $2({isOpen:e,onClose:t,onSuccess:r}){const{createMaterial:a,isLoading:s,error:i}=Y2(),[o,c]=W.useState({leumas_id:"",name:"",make_description:"",vendor_details:null,unit_of_measurement:"unit",cost_per_unit:0,category:"RM",acceptance_criteria:""}),[d,h]=W.useState({name:"",contact:"",email:"",phone:"",address:""}),g=async x=>{x.preventDefault();try{await a({...o,vendor_details:Object.values(d).some(y=>y)?d:null}),r==null||r(),t()}catch(y){console.error("Failed to create material:",y)}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add New Material"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Leumas ID"}),n.jsx("input",{type:"text",required:!0,value:o.leumas_id,onChange:x=>c({...o,leumas_id:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Material Name"}),n.jsx("input",{type:"text",required:!0,value:o.name,onChange:x=>c({...o,name:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),n.jsx("select",{required:!0,value:o.category,onChange:x=>c({...o,category:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:Object.entries(Ca).map(([x,y])=>n.jsx("option",{value:x,children:y},x))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit of Measurement"}),n.jsx("select",{required:!0,value:o.unit_of_measurement,onChange:x=>c({...o,unit_of_measurement:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:Object.entries(Xt).map(([x,y])=>n.jsx("option",{value:x,children:y},x))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cost per unit (₹)"}),n.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:o.cost_per_unit,onChange:x=>c({...o,cost_per_unit:parseFloat(x.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Make & Description"}),n.jsx("textarea",{value:o.make_description||"",onChange:x=>c({...o,make_description:x.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendor Details"}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Vendor Name"}),n.jsx("input",{type:"text",value:d.name,onChange:x=>h({...d,name:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Person"}),n.jsx("input",{type:"text",value:d.contact,onChange:x=>h({...d,contact:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),n.jsx("input",{type:"email",value:d.email,onChange:x=>h({...d,email:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),n.jsx("input",{type:"tel",value:d.phone,onChange:x=>h({...d,phone:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),n.jsx("textarea",{value:d.address,onChange:x=>h({...d,address:x.target.value}),rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Acceptance Criteria"}),n.jsx("textarea",{value:o.acceptance_criteria||"",onChange:x=>c({...o,acceptance_criteria:x.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Describe the criteria for accepting this material..."})]}),n.jsxs("div",{className:"flex justify-end gap-4",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:s?"Creating...":"Create Material"})]})]})]})}):null}function J2(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Materials"}),s&&n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Add Material"]})]}),n.jsx(V2,{}),e&&n.jsx($2,{isOpen:e,onClose:()=>t(!1)})]})})}function nh(e){const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null);return W.useEffect(()=>{async function c(){if(!e){r(null),s(!1);return}try{const{data:d,error:h}=await je.from("product_formulas").select(`
            *,
            material:materials(*)
          `).eq("product_id",e).order("created_at");if(h)throw h;r(d)}catch(d){o(d instanceof Error?d:new Error("Error loading formulas"))}finally{s(!1)}}c()},[e]),{data:t,isLoading:a,error:i}}function K2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{deleteItem:async i=>{t(!0),a(null);try{const{error:o}=await je.from("product_formulas").delete().eq("id",i);if(o)throw o}catch(o){const c=o instanceof Error?o:new Error("Failed to delete formula item");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}function X2({formulas:e}){const{deleteItem:t,isLoading:r}=K2();return e.length?n.jsx("div",{className:"space-y-2",children:e.map(a=>{var s,i;return n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium",children:(s=a.material)==null?void 0:s.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[a.quantity," ",Xt[((i=a.material)==null?void 0:i.unit_of_measurement)||"unit"]]})]}),n.jsx("button",{onClick:()=>t(a.id),disabled:r,className:"text-red-600 hover:text-red-700 disabled:opacity-50",children:n.jsx(ys,{className:"h-5 w-5"})})]},a.id)})}):n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No materials added to formula yet"})}function Q2(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{createItem:async i=>{t(!0),a(null);try{const{error:o}=await je.from("product_formulas").insert(i);if(o)throw o}catch(o){const c=o instanceof Error?o:new Error("Failed to create formula item");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}function Z2({isOpen:e,onClose:t,productId:r,materials:a}){const{createItem:s,isLoading:i,error:o}=Q2(),[c,d]=W.useState(""),[h,g]=W.useState(""),x=async m=>{if(m.preventDefault(),!(!c||!h))try{await s({product_id:r,material_id:c,quantity:parseFloat(h)}),t()}catch(v){console.error("Failed to add formula item:",v)}};if(!e)return null;const y=a.find(m=>m.id===c);return n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-[60]",children:n.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 flex flex-col max-h-[90vh]",children:[n.jsxs("div",{className:"p-6 border-b flex justify-between items-center flex-shrink-0",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Add Material"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"p-6 overflow-y-auto",children:[o&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:o.message}),n.jsxs("form",{onSubmit:x,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Material"}),n.jsxs("select",{required:!0,value:c,onChange:m=>d(m.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"Select Material"}),a.map(m=>n.jsxs("option",{value:m.id,children:[m.name," (",m.leumas_id,")"]},m.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Quantity (",y?Xt[y.unit_of_measurement]:"",")"]}),n.jsx("input",{type:"number",required:!0,min:"0",step:"0.001",value:h,onChange:m=>g(m.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]})]}),n.jsxs("div",{className:"p-6 border-t flex justify-end gap-4 flex-shrink-0",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:!c||!h||i,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",onClick:x,children:i?"Adding...":"Add Material"})]})]})})}function e5({product:e,isOpen:t,onClose:r,onSuccess:a}){const[s,i]=W.useState(!1),{data:o,isLoading:c,error:d}=nh(e.id),{data:h}=qo();return t?n.jsxs("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:[n.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 flex flex-col max-h-[90vh]",children:[n.jsxs("div",{className:"p-6 border-b flex justify-between items-center flex-shrink-0",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold",children:e.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Batch Size: ",e.batch_size]})]}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"p-6 overflow-y-auto",children:[d&&n.jsx(bt,{message:d.message}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h3",{className:"text-lg font-medium",children:"Formula Components"}),n.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 text-sm text-indigo-600 hover:text-indigo-700",children:[n.jsx(Qt,{className:"h-4 w-4"}),"Add Material"]})]}),c?n.jsx(dt,{}):n.jsx(X2,{formulas:o||[]})]})]})]}),s&&h&&n.jsx(Z2,{isOpen:s,onClose:()=>i(!1),productId:e.id,materials:h.filter(g=>!(o!=null&&o.some(x=>x.material_id===g.id)))})]}):null}function t5({product:e}){var i;const[t,r]=W.useState(!1),{data:a,isLoading:s}=nh(e.id);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:n.jsx(rr,{className:"h-6 w-6 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900",children:e.name}),n.jsx("p",{className:"text-sm text-gray-500",children:(i=e.organization)==null?void 0:i.name})]})]}),n.jsx("button",{onClick:()=>r(!0),className:"p-2 text-gray-400 hover:text-gray-600",children:n.jsx(xs,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"mt-4",children:s?n.jsx(dt,{}):n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Materials"}),n.jsx("span",{className:"font-medium",children:(a==null?void 0:a.length)||0})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Batch Size"}),n.jsx("span",{className:"font-medium",children:e.batch_size})]})]})})]}),t&&n.jsx(e5,{product:e,isOpen:t,onClose:()=>r(!1)})]})}function r5({products:e}){return e!=null&&e.length?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(t=>n.jsx(t5,{product:t},t.id))}):n.jsx(n5,{})}function n5(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(So,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No products"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add products to create formulas."})]})}function a5(){const{data:e,isLoading:t,error:r}=Bo();return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Product Formulas"}),n.jsx(r5,{products:e||[]})]})})}function s5(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{updateOrder:async(i,o)=>{t(!0),a(null);try{const{error:c}=await je.from("material_orders").update({status:o.status,dispatch_date:o.dispatch_date||null,arrival_date:o.arrival_date||null,waybill_details:o.waybill_details}).eq("id",i);if(c)throw c}catch(c){const d=c instanceof Error?c:new Error("Failed to update order");throw a(d),d}finally{t(!1)}},isLoading:e,error:r}}function i5({order:e,isOpen:t,onClose:r,onUpdate:a}){var g,x,y,m,v;const{updateOrder:s,isLoading:i,error:o}=s5(),[c,d]=W.useState({status:e.status,dispatch_date:e.dispatch_date||"",arrival_date:e.arrival_date||"",waybill_details:e.waybill_details||{number:"",carrier:"",tracking_url:"",remarks:""}}),h=async N=>{N.preventDefault();try{await s(e.id,c),a==null||a(),r()}catch(L){console.error("Failed to update order:",L)}};return t?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold",children:(g=e.material)==null?void 0:g.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[e.quantity," ",Xt[((x=e.material)==null?void 0:x.unit_of_measurement)||"unit"]]})]}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),o&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:o.message}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Material Details"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(rr,{className:"h-5 w-5 text-gray-400 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:(y=e.material)==null?void 0:y.name}),n.jsx("p",{className:"text-sm text-gray-500",children:(m=e.material)==null?void 0:m.leumas_id}),((v=e.material)==null?void 0:v.vendor_details)&&n.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[n.jsxs("p",{children:["Vendor: ",e.material.vendor_details.name]}),n.jsxs("p",{children:["Contact: ",e.material.vendor_details.contact]})]})]})]})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),n.jsx("select",{value:c.status,onChange:N=>d({...c,status:N.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i,children:Object.entries(Pc).map(([N,L])=>n.jsx("option",{value:N,children:L},N))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dispatch Date"}),n.jsx("input",{type:"date",value:c.dispatch_date,onChange:N=>d({...c,dispatch_date:N.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Expected Arrival"}),n.jsx("input",{type:"date",value:c.arrival_date,onChange:N=>d({...c,arrival_date:N.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Shipping Details"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Waybill Number"}),n.jsx("input",{type:"text",value:c.waybill_details.number,onChange:N=>d({...c,waybill_details:{...c.waybill_details,number:N.target.value}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Carrier"}),n.jsx("input",{type:"text",value:c.waybill_details.carrier,onChange:N=>d({...c,waybill_details:{...c.waybill_details,carrier:N.target.value}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tracking URL"}),n.jsx("input",{type:"url",value:c.waybill_details.tracking_url,onChange:N=>d({...c,waybill_details:{...c.waybill_details,tracking_url:N.target.value}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),n.jsx("textarea",{value:c.waybill_details.remarks,onChange:N=>d({...c,waybill_details:{...c.waybill_details,remarks:N.target.value}}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:i})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Order Timeline"}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute top-0 left-4 h-full w-0.5 bg-gray-200"}),n.jsxs("div",{className:"space-y-6 relative",children:[n.jsx($l,{title:"Order Placed",date:e.order_date,status:"completed"}),n.jsx($l,{title:"Order Dispatched",date:e.dispatch_date,status:e.dispatch_date?"completed":"pending"}),n.jsx($l,{title:"Order Received",date:e.arrival_date,status:e.arrival_date?"completed":"pending"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-4",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:i?"Saving...":"Save Changes"})]})]})]})}):null}function $l({title:e,date:t,status:r}){return n.jsxs("div",{className:"relative pl-8",children:[n.jsx("div",{className:`absolute left-0 w-8 h-8 rounded-full flex items-center justify-center ${r==="completed"?"bg-green-100":"bg-gray-100"}`,children:n.jsx("div",{className:`w-3 h-3 rounded-full ${r==="completed"?"bg-green-500":"bg-gray-300"}`})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:e}),n.jsx("p",{className:"text-sm text-gray-500",children:t?_r(t):"Pending"})]})]})}function o5({orders:e}){const[t,r]=W.useState(null);return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expected Arrival"}),n.jsx("th",{className:"relative px-6 py-3",children:n.jsx("span",{className:"sr-only",children:"Actions"})})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(a=>{var s,i,o;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(rr,{className:"h-5 w-5 text-gray-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:(s=a.material)==null?void 0:s.name}),n.jsx("div",{className:"text-sm text-gray-500",children:(i=a.material)==null?void 0:i.leumas_id})]})]})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[a.quantity," ",Xt[((o=a.material)==null?void 0:o.unit_of_measurement)||"unit"]]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${a.status==="received"?"bg-green-100 text-green-800":a.status==="dispatched"?"bg-purple-100 text-purple-800":a.status==="ordered"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:Pc[a.status]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_r(a.order_date)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.arrival_date?_r(a.arrival_date):"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx("button",{onClick:()=>r(a),className:"text-indigo-600 hover:text-indigo-900",children:n.jsx(xs,{className:"h-4 w-4"})})})]},a.id)})})]})}),t&&n.jsx(i5,{order:t,isOpen:!0,onClose:()=>r(null)})]})}function l5({orders:e,productionOrderId:t}){var i,o;const[r,a]=W.useState(!1);if(!(e!=null&&e.length))return null;const s=(i=e[0])==null?void 0:i.production_order;return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[n.jsxs("div",{className:"px-6 py-4 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>a(!r),children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(rr,{className:"h-6 w-6 text-gray-400"}),n.jsx("div",{children:t?n.jsxs(n.Fragment,{children:[n.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["PO: ",s==null?void 0:s.po_number]}),n.jsxs("p",{className:"text-sm text-gray-500",children:[(o=s==null?void 0:s.product)==null?void 0:o.name," (",s==null?void 0:s.quantity," units)"]})]}):n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Unassigned Orders"})})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[s&&n.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status}),r?n.jsx(mi,{className:"h-5 w-5 text-gray-400"}):n.jsx(fi,{className:"h-5 w-5 text-gray-400"})]})]}),r&&n.jsx("div",{className:"border-t border-gray-200",children:n.jsx(o5,{orders:e})})]})}function c5(){const{data:e,isLoading:t,error:r}=rh();if(t)return n.jsx(dt,{});if(r)return n.jsx(bt,{message:r.message});if(!(e!=null&&e.length))return n.jsx(d5,{});const a=e.reduce((s,i)=>{const o=i.production_order_id||"unassigned";return s[o]||(s[o]=[]),s[o].push(i),s},{});return n.jsx("div",{className:"space-y-6",children:Object.entries(a).map(([s,i])=>n.jsx(l5,{orders:i,productionOrderId:s==="unassigned"?null:s},s))})}function d5(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Lo,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No material orders"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Material orders will appear here when you create them from production orders."})]})}function u5(){const[e,t]=W.useState(!1),[r,a]=W.useState(null);return{createOrder:async i=>{if(!i.production_order_id)throw new Error("Production order ID is required");t(!0),a(null);try{const{error:o}=await je.from("material_orders").insert({material_id:i.material_id,quantity:i.quantity,order_date:i.order_date,production_order_id:i.production_order_id,status:"pending"});if(o)throw o}catch(o){const c=o instanceof Error?o:new Error("Failed to create order");throw a(c),c}finally{t(!1)}},isLoading:e,error:r}}async function h5(e){if(!e)throw new Error("Product ID is required");try{const{data:t,error:r}=await je.from("product_formulas").select(`
        quantity,
        material:materials!inner(
          id,
          leumas_id,
          name,
          unit_of_measurement,
          category,
          cost_per_unit
        )
      `).eq("product_id",e);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching product formula:",t),t}}async function f5(e){if(!e)throw new Error("Material ID is required");try{const[t,r]=await Promise.all([je.rpc("get_current_inventory",{p_material_id:e,p_section:"inward"}),je.rpc("get_current_inventory",{p_material_id:e,p_section:"brand"})]);if(t.error)throw t.error;if(r.error)throw r.error;return{inward:Number(t.data||0),brand:Number(r.data||0)}}catch(t){throw console.error("Error fetching material inventory:",t),t}}function m5(e,t){return Number((e*t).toFixed(3))}function g5(e,t){return Number(Math.max(0,e-t).toFixed(3))}function p5(e){var c;const[t,r]=W.useState(null),[a,s]=W.useState(!0),[i,o]=W.useState(null);return W.useEffect(()=>{async function d(){var h;if(!((h=e==null?void 0:e.product)!=null&&h.id)||!(e!=null&&e.quantity)){r(null),s(!1);return}try{s(!0),o(null);const g=await h5(e.product.id);if(!(g!=null&&g.length)){r([]);return}const x=await Promise.all(g.map(async y=>{var L;if(!y.material||typeof y.quantity!="number")throw new Error(`Invalid formula data for ${(L=e.product)==null?void 0:L.name}`);const m=await f5(y.material.id),v=m.inward+m.brand,N=m5(y.quantity,e.quantity);return{material:y.material,required_quantity:N,available_quantity:v,shortage_quantity:g5(N,v)}}));r(x)}catch(g){console.error("Error loading material requirements:",g),o(g instanceof Error?g:new Error("Error loading material requirements")),r(null)}finally{s(!1)}}d()},[(c=e==null?void 0:e.product)==null?void 0:c.id,e==null?void 0:e.quantity]),{data:t,isLoading:a,error:i}}function x5({onSubmit:e,isLoading:t=!1}){const[r,a]=W.useState(null),{data:s,isLoading:i,error:o}=Ro(),{data:c,isLoading:d,error:h}=p5(r),g=y=>{if(y.preventDefault(),!c||!(r!=null&&r.id))return;const m=c.filter(v=>v.shortage_quantity>0).map(v=>({material_id:v.material.id,quantity:v.shortage_quantity,production_order_id:r.id}));e(m)};if(i)return n.jsx(dt,{});if(o)return n.jsx(bt,{message:o.message});const x=(s==null?void 0:s.filter(y=>{var m;return y.status==="pending"&&((m=y.product)==null?void 0:m.id)&&y.quantity>0}))||[];return n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Production Order"}),n.jsxs("select",{required:!0,value:(r==null?void 0:r.id)||"",onChange:y=>{const m=s==null?void 0:s.find(v=>v.id===y.target.value);a(m||null)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:t,children:[n.jsx("option",{value:"",children:"Select Production Order"}),x.map(y=>{var m;return n.jsxs("option",{value:y.id,children:[y.po_number," - ",(m=y.product)==null?void 0:m.name," (",y.quantity," units)"]},y.id)})]})]}),r&&n.jsx("div",{className:"mt-4",children:d?n.jsx(dt,{}):h?n.jsx(bt,{message:h.message}):c!=null&&c.length?n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium mb-4",children:"Material Requirements"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Required"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Shortage"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(y=>n.jsxs("tr",{className:y.shortage_quantity>0?"bg-red-50":"",children:[n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.material.name}),n.jsx("div",{className:"text-sm text-gray-500",children:y.material.leumas_id})]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[y.required_quantity," ",Xt[y.material.unit_of_measurement]]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[y.available_quantity," ",Xt[y.material.unit_of_measurement]]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y.shortage_quantity>0?n.jsxs("span",{className:"text-sm text-red-600 font-medium",children:[y.shortage_quantity," ",Xt[y.material.unit_of_measurement]]}):n.jsx("span",{className:"text-sm text-green-600 font-medium",children:"Sufficient"})})]},y.material.id))})]})}),c.some(y=>y.shortage_quantity>0)&&n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsx("button",{type:"submit",disabled:t,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:t?"Creating Orders...":"Place Material Orders"})})]}):n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No materials required for this order"})})]})}function y5({isOpen:e,onClose:t,onSuccess:r}){const{createOrder:a,isLoading:s,error:i}=u5(),o=async c=>{try{await Promise.all(c.map(d=>a({material_id:d.material_id,quantity:d.quantity,production_order_id:d.production_order_id,order_date:new Date().toISOString().split("T")[0]}))),r==null||r(),t()}catch(d){console.error("Failed to create orders:",d)}};return e?n.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Create Material Orders"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:n.jsx(Ft,{className:"h-6 w-6"})})]}),i&&n.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:i.message}),n.jsx(x5,{onSubmit:o,isLoading:s})]})}):null}function v5(){const[e,t]=W.useState(!1),{isAdmin:r,isManager:a}=At(),s=r||a;return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Material Orders"}),s&&n.jsxs("button",{onClick:()=>t(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[n.jsx(Qt,{className:"h-5 w-5"}),"Place Order"]})]}),n.jsx(c5,{}),e&&n.jsx(y5,{isOpen:e,onClose:()=>t(!1)})]})})}function b5(){const{data:e,isLoading:t,error:r}=eh();if(t)return n.jsx(dt,{});if(r)return n.jsx(bt,{message:r.message});if(!(e!=null&&e.length))return n.jsx(w5,{});const a=e.reduce((s,i)=>{const o=new Date(i.moved_at).toLocaleDateString();return s[o]||(s[o]=[]),s[o].push(i),s},{});return n.jsx("div",{className:"space-y-8",children:Object.entries(a).map(([s,i])=>n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:s}),n.jsx("div",{className:"space-y-4",children:i.map(o=>n.jsx(th,{movement:o},o.id))})]},s))})}function w5(){return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(jo,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No movements"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No inventory movements recorded yet."})]})}function N5({filters:e=j5,onChange:t}){const{data:r,isLoading:a}=qo();return a?n.jsx(dt,{}):n.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material"}),n.jsxs("select",{value:e.material,onChange:s=>t==null?void 0:t("material",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Materials"}),r==null?void 0:r.map(s=>n.jsx("option",{value:s.id,children:s.name},s.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),n.jsxs("select",{value:e.category,onChange:s=>t==null?void 0:t("category",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Categories"}),Object.entries(Ca).map(([s,i])=>n.jsx("option",{value:s,children:i},s))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Section"}),n.jsxs("select",{value:e.fromSection,onChange:s=>t==null?void 0:t("fromSection",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Sections"}),n.jsx("option",{value:"external",children:"External"}),Object.entries(La).map(([s,i])=>n.jsx("option",{value:s,children:i},s))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Section"}),n.jsxs("select",{value:e.toSection,onChange:s=>t==null?void 0:t("toSection",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Sections"}),Object.entries(La).map(([s,i])=>n.jsx("option",{value:s,children:i},s))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),n.jsx("input",{type:"date",value:e.dateFrom,onChange:s=>t==null?void 0:t("dateFrom",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),n.jsx("input",{type:"date",value:e.dateTo,onChange:s=>t==null?void 0:t("dateTo",s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]})})}const j5={material:"",category:"",fromSection:"",toSection:"",dateFrom:"",dateTo:""};function S5(){return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Inventory Movements"}),n.jsx(N5,{}),n.jsx(b5,{})]})})}function _5({levels:e}){return e.length?n.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Inward Store"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Brand Section"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Production Floor"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"FG Store"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(t=>{var r,a,s,i,o,c,d,h;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(rr,{className:"h-5 w-5 text-gray-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:(r=t.material)==null?void 0:r.name}),n.jsx("div",{className:"text-sm text-gray-500",children:(a=t.material)==null?void 0:a.leumas_id})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ca[((s=t.material)==null?void 0:s.category)||"RM"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.inward," ",Xt[((i=t.material)==null?void 0:i.unit_of_measurement)||"unit"]]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.brand," ",Xt[((o=t.material)==null?void 0:o.unit_of_measurement)||"unit"]]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.production," ",Xt[((c=t.material)==null?void 0:c.unit_of_measurement)||"unit"]]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.fg_store," ",Xt[((d=t.material)==null?void 0:d.unit_of_measurement)||"unit"]]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[t.total," ",Xt[((h=t.material)==null?void 0:h.unit_of_measurement)||"unit"]]})]},t.material_id)})})]})})}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx(rr,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No inventory data"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start recording inventory movements to see levels."})]})}function k5({selectedCategory:e,onCategoryChange:t,searchQuery:r,onSearchChange:a}){return n.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),n.jsxs("select",{value:e,onChange:s=>t(s.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.jsx("option",{value:"",children:"All Categories"}),Object.entries(Ca).map(([s,i])=>n.jsx("option",{value:s,children:i},s))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Mf,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{type:"text",value:r,onChange:s=>a(s.target.value),placeholder:"Search by name or ID...",className:"block w-full pl-10 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]})]})})}function L5(){const{data:e,isLoading:t,error:r}=Zu(),[a,s]=W.useState(""),[i,o]=W.useState(""),c=e==null?void 0:e.filter(d=>{var h,g,x;if(a&&((h=d.material)==null?void 0:h.category)!==a)return!1;if(i){const y=i.toLowerCase();return((g=d.material)==null?void 0:g.name.toLowerCase().includes(y))||((x=d.material)==null?void 0:x.leumas_id.toLowerCase().includes(y))}return!0});return t?n.jsx(dt,{}):r?n.jsx(bt,{message:r.message}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(k5,{selectedCategory:a,onCategoryChange:s,searchQuery:i,onSearchChange:o}),n.jsx(_5,{levels:c||[]})]})}function A5(){return n.jsx(kr,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Live Inventory Sheet"}),n.jsx(L5,{})]})})}function P5(){const{session:e,loading:t}=lf(),{isFirstUser:r,loading:a}=df();return t||a?null:r?n.jsx(Wf,{}):e?n.jsx(Gh,{children:n.jsxs(Yh,{children:[n.jsx(xr,{path:"/",element:n.jsx(_p,{})}),n.jsx(xr,{path:"/orders",element:n.jsx(Pp,{})}),n.jsx(xr,{path:"/tasks",element:n.jsx(Dp,{})}),n.jsx(xr,{path:"/products",element:n.jsx(Vp,{})}),n.jsx(xr,{path:"/users",element:n.jsx(Qp,{})}),n.jsx(xr,{path:"/customer-brands",element:n.jsx(d2,{})}),n.jsx(xr,{path:"/task-templates",element:n.jsx(N2,{})}),n.jsx(xr,{path:"/tickets",element:n.jsx(A2,{})}),n.jsx(xr,{path:"/inventory",element:n.jsx(U2,{})}),n.jsx(xr,{path:"/inventory/materials",element:n.jsx(J2,{})}),n.jsx(xr,{path:"/inventory/formulas",element:n.jsx(a5,{})}),n.jsx(xr,{path:"/inventory/orders",element:n.jsx(v5,{})}),n.jsx(xr,{path:"/inventory/movements",element:n.jsx(S5,{})}),n.jsx(xr,{path:"/inventory/live",element:n.jsx(A5,{})}),n.jsx(xr,{path:"*",element:n.jsx($h,{to:"/",replace:!0})})]})}):n.jsx(zf,{})}Vd(document.getElementById("root")).render(n.jsx(W.StrictMode,{children:n.jsx(P5,{})}));export{vt as _};
//# sourceMappingURL=index-BRYMo_LB.js.map
